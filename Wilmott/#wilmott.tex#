\documentclass[a4paper]{book}
\usepackage[czech]{babel}
\usepackage[utf8]{inputenc}
\usepackage{pstricks}
\usepackage{amsmath}
\usepackage{graphicx}

\setlength{\unitlength}{1.0mm}

\begin{document}

\title{Matematika finanœô ­ních derivátœô¡¯}
\author{John Wilmott, Sam Howison, Jeff Dewynne}
\date{1995}
\maketitle

\tableofcontents

\part{Základy teorie opcí}

\chapter{Úvod}

\section{Evropská kupní a prodejní opce}

Evropská kupní opce je kontrakt, jehoœô¡¾ vlastník mœô¡¯œô¡¾e v pœô ùedem dohodnutém budoucím œô ­ase (tzv. maturitœô » nebo splatnosti opce) koupit dohodnutné moœô¡¾noství podkladového aktiva (napœô ù. akcii, komoditu nebo dluhopis) za tzv. realizaœô ­ní cenu, která je taktéœô¡¾ pœô ùedem dohodnuta. Druhá strana kontraktu, tzv. vypisovatel opce, musí, je-li k tomu vlastníkem opce vyzván, podkladové aktivum za dohodnutou cenu prodat. Právo rozhodnout, zda-li bude opce uplatnœô »na, je tedy na stranœô » jejího vlastníka. Vypisovatel opce je tak proti majiteli v nevıhodœô », za coœô¡¾ mu náleœô¡¾í finanœô ­ní kompenzace - tzv. prémium. Prémium tak pœô ùedstavuje ocenœô »ní práva majitele opce rozhodnout o jejím pœô ùípadném uplatnœô »ní. Prémium je vypláceno v okamœô¡¾iku uzavœô ùení opce.

Evropská prodejní opce je identická s evropskou kupní opcí s tím rozdílem, œô¡¾e její majitel má právo podkladové aktivum prodat nikoliv nakoupit.

\section{Pákovı efekt}

S opcemi je spojen tzv. pákovı efekt. Ten umoœô¡¾œô èuje investorovi dosáhnout vœô »tœô¡¡í rizikové expozice portfolia, neœô¡¾ kdyby investoval pœô ùímo do podkladového aktiva.

Mœô »jme akcii, jejíœô¡¾ souœô ­asná hodnota je 110 USD a kterou investor koupil pœô ùed rokem za 100 USD. Investor tak dosáhl vınosu 10 USD. Uvaœô¡¾ujme kupní opce na tuto akcii s realizaœô ­ní cenou 100 USD. Jestliœô¡¾e by se tato opce prodávala pœô ùed rokem za prémium 5 USD, mohl investor namísto akcie nakoupit 20 opcí. Dnes by tak realizoval œô ­istı zisk 100 USD. Jestliœô¡¾e by vœô¡¡ak souœô ­asná cena akcie klesla na 90 USD, byla by ztráta v prvním pœô ùípadœô » pouze 10 USD zatímco v druhém pœô ùípadœô » celıch 100 USD.

\section{Spekulativní a zajiœô¡¡œô¡¥ovací obchody}

Díky pákovému efektu jsou opce optimálním nástrojem pro spekulativní obchody - umoœô¡¾œô èují vœô »tœô¡¡í rizikovou expozici neœô¡¾ by bylo moœô¡¾né pœô ùi investování do podkladového aktiva. V pœô ùípadœô », œô¡¾e spekulant správnœô » odhadne budoucí vıvoj na trhu, mœô¡¯œô¡¾e dosáhnout nœô »kolikanásobného zisku v porovnání s vınosem podkladového aktiva.

Jestliœô¡¾e chce investor spekulovat na pokles ceny opce mœô¡¯œô¡¾e si koupit prodejní opci popœô ù. vypsat kupní opci. V prvním pœô ùípadœô » nebude potenciální zisk shora omezen a maximální ztráta bude dána zaplacenım prémiem. V druhém pœô ùípadœô » naopak není omezena potenciální ztráta, avœô¡¡ak potenciální zisk shora omezen obdrœô¡¾enım prémiem. Dalœô¡¡í rozdíl je ten, œô¡¾e nákup opce vyœô¡¾aduje prvnostní investici v podobnœô » uhrazené prémie, kdeœô¡¾to prodej opce naopak pœô ùedstavuje cash-in-flow.

V pœô ùípadœô » spekulace na rœô¡¯st ceny akcie by investor kupoval kupní opci nebo vypisoval prodejní opci.\\

Opce jsou také zajiœô¡¡œô¡¥ovacím nástrojem, tzv. slouœô¡¾í naopak ke sníœô¡¾ení rizikové expozice portfolia. Jestliœô¡¾e napœô ù. investor má nakoupenou akcii, mœô¡¯œô¡¾e potenciální ztrátu z této pozice eliminovat koupí prodejní opce.

\section{Ostatní typy opcí}

Vıœô¡¡e uvaœô¡¾ované opce byly evropské. Takováto opce mœô¡¯œô¡¾e bıt uplatnœô »na pouze v okamœô¡¾iku své splatnosti. Vedle evropské opce existuje také opce americká, která mœô¡¯œô¡¾e bıt uplatnœô »na kdykoliv bœô »hem své œô¡¾ivotnosti. Tato zdánlivœô » drobná odliœô¡¡nost má zásadní vıznam pro ocenœô »ní opce.

Dalœô¡¡í rovinou rozliœô¡¡ení je dœô »lení opcí podle zpœô¡¯sobu stanovení vıplaty. Vedle klasickıch opcí, kdy je vıplata dána rozdílem realizaœô ­ní a aktuální ceny podkladového aktiva, existují tzv. exotické opce. V pœô ùípadœô » exotickıch opcí mœô¡¯œô¡¾e vıplata záviset na vıvoji ceny podkladového aktiva v prœô¡¯bœô »hu œô¡¾ivotnosti opce (napœô ù. asijská opce) nebo mœô¡¯œô¡¾e bıt dána konkrétní œô ­ástkou v závislosti na tom, zda-li cena podkladového aktiva protne urœô ­itou hranici (napœô ù. binární opce).

\section{Forwardové kontrakty a futures}

O opcích se œô ­asto hovoœô ùí jako o derivátech. Derivátem je obecnœô » finanœô ­ní instrument, jehoœô¡¾ cena je odvozena o jiného tzv. podkladového aktiva. Mezi deriváty spadají také tzv. forwardové kontrakty a futures. V obou pœô ùípadech se jedná o obchody, kdy má jedna zúœô ­astnœô »ná strana povinnost prodat a druhá koupit v pœô ùedem smluvenı budoucí œô ­asovı okamœô¡¾ik pœô ùedem dohodnutı objem podkladového aktiva za pœô ùedem dohodnutou cenu.

Forwardové kontrakty jsou tzv. over-the-counter (OTC) obchody. To znamená, œô¡¾e jsou uzavírány pœô ùímo mezi zúœô ­astnœô »nımi subjekty bez úœô ­asti tœô ùetí osoby (klasicky banka a její klient). Vıhodou forwardovıch kontraktœô¡¯ je flexibilita podmínek pœô ùi sjednávání obchodu. Naproti tomu futures jsou standardizované obchody, které jsou provádœô »ny pœô ùes prostœô ùedníka, kterım je burza. Pœô ùedmœô »tem standardizace je podkladové aktivum (obchody je moœô¡¾né sjednávat pouze na vybraná aktiva), minimální objem obchodu a datum splatnosti. Vedle toho musí zúœô ­astnœô »né subjekty u burzy udrœô¡¾ovat hotovost na tzv. marœô¡¾ovıch úœô ­tech. Marœô¡¾e má za cíl pokrıt pœô ùípadné ztráty zúœô ­astnœô »nıch subjektœô¡¯ z titulu nepœô ùíznivého vıvoje cen podkladového aktiva a sniœô¡¾uje tak kreditní riziko protistrany.

Vzhledem k tomu, œô¡¾e obœô » protistrany mají narozdíl od opce rovnocenné postavení, není ani jedna ze zœô¡¯œô ­astnœô »nıch stran pœô ùíjemcem prémia. Vstup do forwardového kontraktu popœô ù. futures by tedy nemœô »l obnáœô¡¡et œô¡¾ádné náklady\footnote{V pœô ùípadœô » forwardovıch kontraktœô¡¯ vœô¡¡ak banka úœô ­tuje klientovi provizi. Ta mœô¡¯œô¡¾e mít podobu pœô ùímé platby nebo, coœô¡¾ je bœô »œô¡¾nœô »jœô¡¡í, formu ménœô » vıhodné forwardové ceny, za kterou je na konci splatnosti podkladové aktivum prodáváno popœô ù. nakupováno.}.

\section{Úrokové sazby a souœô ­asná hodnota}

Poloœô¡¾me si otázku, kolik bych musel nyní vloœô¡¾it na úœô ­et u banky, aby v œô ­ase $T$ byla vıœô¡¡e depozita rovna œô ­ástce $E$. Jestliœô¡¾e budeme uvaœô¡¾ovat kontinuální úroœô ­ení a konstatní úrokovou sazbu $r$, je rœô¡¯st depozita dán diferenciální rovnicí
\begin{equation*}
\frac{dM(t)}{M(t)}=r~dt
\end{equation*}
Tuto diferenciální rovnici lze vyœô ùeœô¡¡it pomocí standardní metody separace promœô »nnıch.
\begin{equation*}
\frac{1}{M(t)}\frac{dM(t)}{dt} = r
\end{equation*}
\begin{equation*}
\int \frac{1}{M(t)}\frac{dM(t)}{dt} dt = \int r dt
\end{equation*}
\begin{equation*}
\int \frac{1}{M(t)}dM(t) = \int r dt
\end{equation*}
\begin{equation*}
\ln(M(t)) = rt + c
\end{equation*}
\begin{equation*}
M(t) = e^c e^{rt}
\end{equation*}
\begin{equation*}
M(t) = C e^{rt}
\end{equation*}
Protoœô¡¾e v œô ­ase $t = 0$ musí platit $M(0) = C$, je vıslednı tvar œô ùeœô¡¡ení
\begin{equation*}
M(t)=M(0)e^{rt}
\end{equation*}
kde $M(0)$ je poœô ­áteœô ­ní vıœô¡¡e depozita. Vzhledem k tomu, œô¡¾e $M(T) = E$ a hledanou veliœô ­inou je $M(0)$, platí
\begin{equation*}
M(0)=Ee^{-rT}
\end{equation*}
Jestliœô¡¾e bychom tedy dnes uloœô¡¾ili do banky œô ­ástku $Ee^{-rT}$, disponovali bychom v œô ­ase $T$ depozitem ve vıœô¡¡i $E$. Souœô ­asná hodnota œô ­ástky $E$, kterou obdrœô¡¾íme v œô ­ase $T$, je tak rovna  $Ee^{-rT}$.

Kdyby úroková míra $r(t)$ byla funkcí œô ­asu, bylo by moœô¡¾né vıœô¡¡e uvedenou rovnici vyjádœô ùit ve tvaru
\begin{equation*}
M(0)=Ee^{-\int_0^Tr(s)ds}
\end{equation*}

\chapter{Náhodná procházka}

\section{Úvod}

Základním kamenem oceœô èování opcí je pœô ùedpoklad, œô¡¾e cena podkladového aktiva sleduje tzv. náhodnou procházku (random walk). V souladu s touto teorií je na cenu podkladového aktiva nahlíœô¡¾eno jako na náhodnou veliœô ­inu. U té sice nejsme schopni urœô ­it její hodnotu k urœô ­itému okamœô¡¾iku v budoucnu, nicménœô » na základœô » historickıch pozorování jsme schopni zkonstruovat její pravdœô »podobnostní rozdœô »lení. Pomocí tohoto rozdœô »lení je pak moœô¡¾né napœô ù. urœô ­it, s jakou pravdœô »podobností cena pœô ùekroœô ­í urœô ­itou úroveœô è.

Teorie náhodné procházky vychází z teorie efektivních trhœô¡¯. Podle této teorie je cena podkladového aktiva formována novımi informacemi, kdy jsou vœô¡¡echny veœô ùejnœô » dostupné informace okamœô¡¾itœô » promítnuty v cenœô » podkladového aktiva. Souœô ­asná cena ani její vıvoj v minulosti tak jiœô¡¾ neobsahují œô¡¾ádnou ``cenotvornou'' informaci a nelze ji tak pouœô¡¾ít pro predikci budoucí ceny. Jak jiœô¡¾ bylo zmínœô »no, neznamená to, œô¡¾e by historická cena podkladového aktiva nemœô »la vœô¡¯bec œô¡¾ádnou vypovídací hodnotu. Historickı vıvoj totiœô¡¾ slouœô¡¾í jako základ pro odhad pravdœô »podobnostního rozdœô »lení ceny podkladového aktiva.

\section{Modelování ceny podkladového aktiva}

Pœô ùedpokládejme, œô¡¾e spotová cena podkladového aktiva je $S$. Uvaœô¡¾ujme œô ­asovı interval $dt$\footnote{V následujícím textu budeme pouœô¡¾ívat oznaœô ­ení $d \cdot$ pro nekoneœô ­nœô » malé zmœô »ny veliœô ­iny $\cdot$.}, bœô »hem kterého se tato cena zmœô »ní z $S$ na $S + dS$.
\begin{center}
	\begin{pspicture}(0,0)(9,6)
		\rput(4.5,0){Diskrétní verze náhodné procházky}

		\psline[arrows=->](1.0,1.0)(8.5,1.0)
		\psline[arrows=->](1.0,1.0)(1.0,5.5)
		\psline[linewidth=0.5mm](1.0,2.5)(2.5,3.0)(4.0,4.0)(5.5,3.5)(7.0,5.5)(8.5,5.7)

                \psline[linestyle=dotted](2.5,0.8)(2.5,3.0)
                \psline[linestyle=dotted](4.0,0.8)(4.0,4.0)

                \psline[linestyle=dotted](0.8,3.0)(2.5,3.0)
                \psline[linestyle=dotted](0.8,4.0)(4.0,4.0)

                \rput(8.5,0.8){\small{t}}
                \rput(0.6,5.5){\small{S(t)}}

                \rput(3.25,0.8){\tiny{dt}}
                \rput(0.70,3.5){\tiny{dS}}
	\end{pspicture}
\end{center}
Nejbœô »œô¡¾nœô »jœô¡¡ím pœô ùístupem k modelování $dS$ je její rozloœô¡¾ení na dvœô » sloœô¡¾ky.

První sloœô¡¾ka je deterministická a její pœô ùíspœô »vek k $dS/S$ je roven
\begin{equation*}
\mu dt
\end{equation*}
kde $\mu$ pœô ùedstavuje prœô¡¯mœô »rnou míru rœô¡¯stu uvaœô¡¾ovaného podkladového aktiva. V jednoduœô¡¡œô¡¡ích modelech je $\mu$ konstantní, ve sloœô¡¾itœô »jœô¡¡ích je pak pak funkcí $S$ a $t$.

Druhá sloœô¡¾ka je stochastická a pœô ùedstavuje zmœô »nu ceny aktiva v závislosti na externích faktorech (napœô ù. pœô ùísun novıch informací). Její pœô ùíspœô »vek k $dS/S$ je dán náhodnım vıbœô »rem z normálního rozdœô »lení s nulovou stœô ùední hodnotou.
\begin{equation*}
\sigma dX
\end{equation*}
Parametr $dX$ pœô ùedstavuje náhodnı vıbœô »r z normálního rozdœô »lení a $\sigma$ smœô »rodatnou odchylku vınosové míry uvaœô¡¾ovaného podkladového aktiva (k tomuto parametru se vrátíme pozdœô »ji).

Jestliœô¡¾e obœô » sloœô¡¾ky spojíme, získáváme stochastickou diferenciální rovnici
\begin{equation}
\frac{dS}{S}=\mu dt + \sigma dX
\end{equation}

V pœô ùípadœô », œô¡¾e by $\sigma$ bylo rovno nule, získali bychom standardní diferenciální rovnici
\begin{equation*}
\frac{dS}{S}=\mu dt
\end{equation*}
jejímœô¡¾ œô ùeœô¡¡ením je
\begin{equation*}
S(t)=S(0)e^{\mu t}
\end{equation*}
kde $S(0)$ je poœô ­áteœô ­ní cena podkladového aktiva. Jestliœô¡¾e je tedy $\sigma$ rovno nule, je cena podkladového aktiva deterministická a jsme schopni urœô ­it její hodnotu v libovolném œô ­asovém okamœô¡¾iku.

\section{Wienerœô¡¯v proces}

Parametr $dX$, kterı pœô ùedstavuje náhodnost ve vıvoji budoucí ceny podkladového aktiva, je tzv. Wienerœô¡¯v proces. Tento proces má následující vlastnosti:
\begin{itemize}
\item $dX$ je náhodnım vıbœô »rem z normálního rozdœô »lení
\item stœô ùední hodnota $dX$ je nulová
\item rozptyl $dX$ je $dt$
\end{itemize}
Parametr $dX$ je tak moœô¡¾né rozepsat ve tvaru
\begin{equation*}
dX = \phi \sqrt{dt}
\end{equation*}
kde $\phi$ je náhodnım vıbœô »rem z normovaného normálního rozdœô »lení. Rovnice (2.1) tak pœô ùejde do tvaru
\begin{equation}
\frac{dS}{S}=\mu dt + \sigma \phi \sqrt{dt}
\end{equation}
Hustota pravdœô »podobnosti náhodné veliœô ­iny $\phi$ je
\begin{equation*}
\frac{1}{\sqrt{2 \pi}}e^{-\frac{1}{2}\phi^2}
\end{equation*}
Nechœô¡¥ $F$ je libovolná spojitá funkce. Definujme oœô ­ekávanou hodnotu funkce $F$ jako
\begin{equation*}
\varepsilon[F(\cdot)]=\frac{1}{\sqrt{2 \pi}}\int_{-\infty}^{\infty}F(\phi)e^{-\frac{1}{2}\phi^2}d\phi
\end{equation*}
Pro $F(\phi) = \phi$ platí 
\begin{equation*}
\varepsilon[\phi]=0
\end{equation*}
\begin{equation*}
\varepsilon[\phi^2]=1
\end{equation*}

Parametr $dX$ je násobkem $\sqrt{dt}$, protoœô¡¾e volba jiného œô ùádu neœô¡¾ $\sqrt{dt}$ by vedla k problémœô¡¯m pro $dt \rightarrow 0$. V tomto pœô ùípadœô », kterı bude klíœô ­ovı pro dalœô¡¡í analızy, by totiœô¡¾ œô ùeœô¡¡ení bylo buœô ¯to nesmyslné nebo triviální.

Rovnice (2.1) má tu vıhodu, œô¡¾e dobœô ùe odpovídá reálnım datœô¡¯m pro akcie a akciové indexy\footnote{V pœô ùípadœô » mœô »novıch párœô¡¯ je vœô¡¡ak tato shoda ponœô »kud horœô¡¡í a to zejména v dlouhodobém horizontu.}. Její aplikace je tedy obhajitelná nejen na teoretickém ale také praktickém základœô ».

Jestliœô¡¾e je cena podkladového aktiva dána rovnicí (2.1), má cena $S$ charakter náhodné veliœô ­iny, kterou lze popsat lognormálním rozdœô »lením. Jestliœô¡¾e je relativní zmœô »na ceny podkladového aktiva vyjádœô ùena pomocí logaritmu jako
\begin{equation*}
\ln \frac{S(t_{i+1})}{S(t_i)}
\end{equation*}
sleduje tato zmœô »na normální rozdœô »lení. To lze dokázat následujícím zpœô¡¯sobem. Jestliœô¡¾e náhodná veliœô ­ina $x$ sleduje lognormální rozdœô »lení, vyplıvá z definice tohoto rozdœô »lení, œô¡¾e náhodná veliœô ­ina $\ln x$ sleduje normální rozdœô »lení. Vzhledem k tomu, œô¡¾e
\begin{equation*}
\ln \frac{S(t_{i+1})}{S(t_i)} = \ln S(t_{i+1}) - \ln S(t_{i})
\end{equation*}
a skuteœô ­nosti, œô¡¾e lineární kombinací dvou náhodnıch veliœô ­in sledujících normální rozdœô »lení získáme náhodnou veliœô ­inu, která opœô »t sleduje normální rozdœô »lení, je vıœô¡¡e uvedené tvrzení pravdivé.

\section{Modelování ceny podkladového aktiva}

Pomocí rovnice (2.1) resp. (2.2) je také moœô¡¾né modelovat vıvoj ceny podkladového aktiva. Z historickıch dat se nejprve vypoœô ­tou odhady parametrœô¡¯ $\mu$ a $\sigma^2$.
\begin{equation*}
\hat{m} = \frac{1}{n dt}\sum^{n-1}_{i=0}\frac{S_{i+1}-S_i}{S_i}
\end{equation*}
\begin{equation*}
\hat{\sigma}^2 = \frac{1}{(n-1) dt}\sum^{n-1}_{i=0}\Big(\frac{S_{i+1}-S_i}{S_i-\hat{m}}\Big)^2
\end{equation*}
V druhém kroce získáme pomocí náhodného vıbœô »ru z normovaného normálního rozdœô »lení hodnotu parametru $\phi$. V tœô ùetím kroce dosazením do (2.2) vypoœô ­teme relativní zmœô »nu podkladového aktiva v œô ­asovém intervalu $dt$. Opakovaním druhého a tœô ùetího kroku je moœô¡¾né modelovat vıvoj ceny podkladového aktiva v œô ­ase.

\section{Markovova vlastnost}

Uvaœô¡¾ujme na vlastnostmi rovnice (2.1). Tato rovnice se neodvolává na historické ceny. Cena podkladového aktiva $S + dS$ v œô ­ase $t + dt$ je vıhradnœô » závislá na spotové cenœô » $S$. Tuto nezávislost na minulém vıvoji nazıváme Markovovou vlastností (Markov property). Dále uvaœô¡¾ujme prœô¡¯mœô »r náhodné veliœô ­iny $dS$. Platí
\begin{equation*}
\varepsilon[dS]=\varepsilon[\mu S dt + \sigma S dX]=\mu S dt
\end{equation*}
protoœô¡¾e $\varepsilon[dX]=0$. V prœô¡¯mœô »ru je tak kaœô¡¾dá následující hodnota vyœô¡¡œô¡¡í neœô¡¾ ta pœô ùedeœô¡¡lá o $\mu S dt$. Rozptyl náhodné veliœô ­iny $dS$ je pak roven
\begin{equation*}
D[dS]=\varepsilon[dS^2]-\varepsilon[dS]^2=\varepsilon[\sigma^2S^2dX^2]=\sigma^2S^2dt
\end{equation*}
Druhá odmocnina rozptylu je smœô »rodatná odchylka, která je tak proporcionální k $\sigma$.

\section{It\^o lemma}

Odvození It\^o lemmy se opírá o mezivısledek
\begin{equation}
 dX^2 = dt
\end{equation}
kterı je platnı pro $dt \rightarrow 0$. Pœô ùipomeœô ème, œô¡¾e $dX$ lze vyjádœô ùit jako
\begin{equation*}
dX = \phi \sqrt{dt}
\end{equation*} 
Pro $dt \rightarrow 0$ je stœô ùední hodnota náhodné veliœô ­iny $dX^2$ rovna
\begin{equation*}
E[dX^2] = E[\phi^2 dt]
\end{equation*}
\begin{equation*}
E[dX^2] = dt E[\phi^2]
\end{equation*}
\begin{equation*}
E[dX^2] = dt
\end{equation*}
a její rozptyl roven
\begin{equation*}
D[dX^2] = E[(\phi^2 dt)^2] - E[\phi^2 dt]^2
\end{equation*}
\begin{equation*}
D[dX^2] = dt^2E[\phi^4] - dt^2E[\phi^2]
\end{equation*}
Vzhledem k tomu, œô¡¾e pro $dt \rightarrow 0$ je $dt^2 \approx 0$, platí 
\begin{equation*}
D[dX^2] = 0
\end{equation*}
Pro $dt \rightarrow 0$ tedy mœô¡¯œô¡¾eme náhodnou veliœô ­inu $dX^2$ povaœô¡¾ovat za deterministickou a rovnu $dt$.

Nyní uvaœô¡¾ujme hladkou funkci $f(S)$ a na okamœô¡¾ik zapomeœô ème, œô¡¾e $S$ je náhodná veliœô ­ina. Je zœô ùejmé, œô¡¾e zmœô »ní-li se $S$ o $dS$, zmœô »ní se také $f(S)$. Tuto zmœô »nu je moœô¡¾né vyjádœô ùit pomocí Taylorova rozvoje jako
\begin{equation*}
f(S + dS) - f(S) = \frac{\partial f(S)}{\partial S}dS + \frac{1}{2}\frac{\partial^2f(S)}{\partial S^2}dS^2 + ...
\end{equation*}
\begin{equation}
df(S) = \frac{\partial f(S)}{\partial S}dS + \frac{1}{2}\frac{\partial^2f(S)}{\partial S^2}dS^2 + ...
\end{equation}
Nyní se vraœô¡¥me zpœô »t k rovnici (2.1). Dle této rovnice platí
\begin{equation*}
dS^2 = (\mu Sdt + \sigma S dX)^2
\end{equation*}
\begin{equation*}
dS^2 = \mu^2S^2dt^2 + 2\mu \sigma S^2dtdX + \sigma^2 S^2 dX^2
\end{equation*}
Jestliœô¡¾e pouœô¡¾ijeme mezivısledek (2.3) a zanedbáme vœô¡¡echny œô ­leny œô ùádu $dt^2$, pœô ùejde pro $dt \rightarrow 0$ vıœô¡¡e uvedená rovnice do tvaru
\begin{equation*}
dS^2 = \sigma^2 S^2 dt
\end{equation*}
Dosazením do (2.4) a opœô »tovnım zanedbáním vœô¡¡ech œô ­lenœô¡¯ vyœô¡¡œô¡¡ího œô ùádu neœô¡¾ $dt$ získáváme
\begin{equation*}
df(S) = \frac{\partial f(S)}{\partial S}(\mu S dt + \sigma S dX) + \frac{1}{2}\frac{\partial^2f(S)}{\partial S^2}\sigma^2 S^2 dt
\end{equation*}
\begin{equation}
df(S) = \Big( \mu S\frac{\partial f(S)}{\partial S} + \frac{1}{2}\frac{\partial^2f(S)}{\partial S^2}\sigma^2 S^2 \Big)dt + \sigma S\frac{\partial f(S)}{\partial S}dX
\end{equation}
Rovnice (2.5) je základní podobnou It\^o lemmy, která se zabıvá zmœô »nou funkce náhodné veliœô ­iny v dœô¡¯sledku infinityzimální zmœô »ny náhodné veliœô ­iny samotné. To, œô¡¾e náhodná veliœô ­ina $dX$ je œô ùádu $dt$ je dœô¡¯leœô¡¾ité pro analızy, které budou následovat. Lze dokázat, œô¡¾e volba jiného œô ùádu by vedla k nerealistickım vlastnostem modelu vıvoje ceny podkladového aktiva pro $dt \rightarrow 0$. Jestliœô¡¾e by $dX \gg \sqrt{dt}$, byla by hodnota náhodné veliœô ­iny $dS$ rovna nule nebo nekoneœô ­nu. Je-li naopak $dX \ll \sqrt{dt}$, stane se z ceny podkladového aktiva deterministická veliœô ­ina namísto stochastické.

Rovnice (2.5) se skládá ze stochatické sloœô¡¾ky, která je násobkem $dX$, a deterministické sloœô¡¾ky, která je násobkem $dt$. Z tohoto pohledu pœô ùipomíná rovnice (2.5) rovnici (2.1). It\^o lemma také umoœô¡¾œô èuje zkoumání chování funkce $f(S)$, která, stejnœô » jako cena podkladového aktiva, sleduje náhodnou procházku.

Rovnici (2.5) je moœô¡¾né dále zobecnit za pœô ùedpokladu, œô¡¾e $f$ je nejen funkcí $S$, ale také funkcí $t$. S pomocí Taylorova rozvoje lze funkci $f(S,t)$ vyjádœô ùit jako
\begin{equation*}
f(S + dS, t + dt) - f(S,t) = \frac{\partial f(S,t)}{\partial S}dS +  \frac{\partial f(S,t)}{\partial t}dt + 
\end{equation*}
\begin{equation*}
+ \frac{1}{2}\frac{\partial^2 f(S,t)}{\partial S^2}dS^2 + \frac{1}{2}\frac{\partial^2 f(S,t)}{\partial S^2}dt^2 + \frac{\partial^2 f(S,t)}{\partial S \partial t}dSdt + ...
\end{equation*}
Jestliœô¡¾e zanedbáme vœô¡¡echny œô ­leny, které mají vyœô¡¡œô¡¡í œô ùád neœô¡¾ $dt$, lze s vyuœô¡¾itím (2.1) a (2.3) pœô ùepsat vıœô¡¡e uvedenou rovnici do tvaru
\begin{equation}
df(S,t) = \Big(\mu S \frac{\partial f(S,t)}{\partial S} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 f(S,t)}{\partial S^2} + \frac{\partial f(S,t)}{\partial t} \Big)dt +
\end{equation}
\begin{equation*}
+ \sigma S \frac{\partial f(S,t)}{\partial S}dX
\end{equation*}

Pro ilustraci It\^o lemmy uvaœô¡¾ujme funkci
\begin{equation*}
f(S) = \ln S
\end{equation*}
Platí
\begin{equation*}
\frac{\partial f(S)}{\partial S} = \frac{1}{S}
\end{equation*}
a
\begin{equation*}
\frac{\partial^2 f(S)}{\partial S^2} = -\frac{1}{S^2}
\end{equation*}
Dosazením do (2.5) získáváme
\begin{equation*}
df(S)=(\mu - \frac{1}{2}\sigma^2)dt + \sigma dX
\end{equation*}

Rovnice $df(S)$ je stochastickou diferenciální rovnicí s konstatními koeficienty, coœô¡¾ znamená, œô¡¾e $df(S)$ má normální rozdœô »lení. Nyní se zamœô »œô ùmœô » na samotnou funkci $f(S)$. Tu lze chápat jako souœô ­et dílœô ­ích zmœô »n $df(S)$\footnote{V limitœô » se tento souœô ­et stane integrálem.}. Vzhledem k tomu, œô¡¾e souœô ­tem náhodnıch promœô »nnıch, které se œô ùídí normálním rozdœô »lením, je opœô »t náhodná promœô »nná s normálním rozdœô »lením, má $f(S(t))-f(S(0))$ normální rozdœô »lení se stœô ùední hodnotou $(\mu - \frac{1}{2}\sigma^2)$ a rozptylem $\sigma^2t$. Hustota pravdœô »podobnosti funkce $f(S)$ je tak rovna
\begin{equation}
\frac{1}{\sigma \sqrt{2 \pi t}}e^{-\frac{(f(S(t))-f(S(0))-(\mu - \frac{1}{2}\sigma^2)t)^2}{2 \sigma^2 t}}
\end{equation}
Jestliœô¡¾e $f(S) = \ln S$, lze snadno dokázat, œô¡¾e náhodnou veliœô ­inu $S$ lze popsat pomocí lognormálního rozdœô »lení s hustotou pravdœô »podobnosti
\begin{equation*}
\frac{1}{\sigma S\sqrt{2 \pi t}}e^{-\frac{(\ln (f(S(t))/f(S(0)))-(\mu - \frac{1}{2}\sigma^2)t)^2}{2 \sigma^2 t}}
\end{equation*}

\section{Odstranœô »ní náhodnosti}

Náhodné sloœô¡¾ky obsaœô¡¾ené v $S$ (rovnice (2.1)) a $f(S,t)$ (rovnice (2.5)) jsou odvozeny od náhodné veliœô ­iny $dX$. Toho je moœô¡¾né vyuœô¡¾ít pro konstrukci veliœô ­iny $g(S,t)$, která bude v infinityzimálním œô ­asové periodœô » $dt$ deterministická. Této vlastnosti bude pozdœô »ji vyuœô¡¾ito pœô ùi oceœô èování opcí. Nechœô¡¥ $\Delta$ je reálné œô ­íslo. Definujme funkci $g(S,t)$ jako
\begin{equation*}
g(S,t) = f(S,t)-\Delta S
\end{equation*}
Platí
\begin{equation*}
dg(S,t) = df(S,t)-\Delta dS
\end{equation*}
\begin{equation*}
dg(S,t) = \Bigg( \mu S \frac{\partial f(S,t)}{\partial S} + \frac{1}{2}\sigma^2S^2 \frac{\partial f(S,t)}{\partial t}\Bigg)dt + \sigma S \frac{\partial f(S,t)}{\partial S}dX -
\end{equation*}
\begin{equation*}
- \Delta(\sigma S dX + \mu S dt)
\end{equation*}
\begin{equation*}
dg(S,t) = \Bigg( \mu S \Big( \frac{\partial f(S,t)}{\partial S} - \Delta \Big) + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 f(S,t)}{\partial S^2} + \frac{\partial f(S,t)}{\partial t} \Bigg)dt +
\end{equation*}
\begin{equation*}
+ \sigma S \Bigg( \frac{\partial f(S,t)}{\partial S}- \Delta \Bigg)dX
\end{equation*}
Jestliœô¡¾e zvolíme $\Delta$ rovno
\begin{equation*}
\Delta = \frac{\partial f(S)}{\partial S}
\end{equation*}
zjednoduœô¡¡í se nám vıœô¡¡e uvedená rovnice do tvaru
\begin{equation*}
dg(S,t) = \Bigg( \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 f(S,t)}{\partial S^2} + \frac{\partial f(S,t)}{\partial t} \Bigg)dt
\end{equation*}
œô ¬len s náhodnou veliœô ­inou $dX$ vypadl a $dg(S,t)$ se tak ze stochastické stala deterministickou veliœô ­inou. Pouze pœô ùipomeœô ème, œô¡¾e vıœô¡¡e uvedené odvození platí pouze v pro nekoneœô ­nœô » malı œô ­asovı interval délky $dt$.

\chapter{Black-Scholes model}

\section{Vnitœô ùní a œô ­asová hodnota opce}

Pœô ùed tím, neœô¡¾ se budeme zabıvat oceœô èováním opcí, uveœô ¯me zkratky, které budeme pouœô¡¾ívat v celém následujícím textu.
\begin{itemize}
\item Hodnotu opce oznaœô ­ujeme jako $V(S,t)$. V pœô ùípadœô », œô¡¾e je tœô ùeba rozliœô¡¡ovat kupní a prodejní opci, budeme pouœô¡¾ívat $C(S,t)$ pro kupní a $P(S,t)$ pro prodejní opci. Hodnota opce je funkcí souœô ­asné ceny podkladového aktiva $S$ a œô ­asu $t$, závisí vœô¡¡ak i na následujících faktorech:
\item $\sigma$ - smœô »rodatná odchylka ceny podkladového aktiva
\item $E$ - realizaœô ­ní cena
\item $T$ - œô ­as do splatnosti
\item $r$ - bezriziková úroková sazba
\end{itemize}
Nejprve uvaœô¡¾ujme situaci v dobœô » splatnosti evropské kupní opce, tj. v œô ­ase kdy $t = T$. Jesliœô¡¾e $S > E$, je logické opci uplatnit - podkladové aktivum nakoupíme za cenu $E$ a obratem jej prodáme za cenu $S$. Majitel opce tak realizuje zisk ve vıœô¡¡i $S-E$. Jestliœô¡¾e je naopak $S < E$, racionální investor tuto opci neuplatní. Hodnota evropské kupní opce v okamœô¡¾iku její splatnosti je tak rovna
\begin{equation}
C(S,T) = \max(S-E,0)
\end{equation}
S tím, jak se blíœô¡¾íme datu splatnosti opce, lze oœô ­ekávat, œô¡¾e se její hodnota bude blíœô¡¾it (3.1). Hodnotu kupní opce dle (3.1) nazıváme vnitœô ùní hodnotou opce. Jedná se tedy o œô ­ástku, kterou bychom získali uplatnœô »ním opce v dobœô » její splatnosti. Rozdíl mezi skuteœô ­nou a vnitœô ùní hodnotou opce pak nazıváme œô ­asovou hodnotou opce.
\begin{center}
	\begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Vnitœô ùní a œô ­asová hodnota evropské kupní opce}
                \rput(4.0,0.0){pœô ùed splatností jako funkce $S$}

		\psline[arrows=->](0.5,1.5)(7.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

                \psline[linewidth=0.5mm](0.5,1.5)(3.0,1.5)(7.5,6.0)
                \pscurve(0.5,1.5)(2.5,1.6)(3.0,1.8)(4.0,2.7)(5.5,4.1)(7.4,6.0)

                \rput(0.5,1.2){\small{0}}
                \rput(3.0,1.2){\small{E}}
                \rput(7.5,1.2){\small{S}}
                \rput(0.2,6.0){\small{C}}
	\end{pspicture}
\end{center}

Analogicky k evropské kupní opce je vnitœô ùní hodnota evropské prodejní opce dána rovnicí
\begin{equation*}
P(S,T) = \max(E-S,0)
\end{equation*}
\begin{center}
	\begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Vnitœô ùní a œô ­asová hodnota evropské prodejní opce}
                \rput(4.0,0.0){pœô ùed splatností jako funkce $S$}

		\psline[arrows=->](0.5,1.5)(7.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

                \psline[linewidth=0.5mm](0.5,5.5)(4.5,1.5)(7.5,1.5)
                \pscurve(0.5,5.2)(4.0,1.9)(4.5,1.7)(5.5,1.5)(7.5,1.5)

                \rput(0.5,1.2){\small{0}}
                \rput(4.5,1.2){\small{E}}
                \rput(7.5,1.2){\small{S}}
                \rput(0.2,6.0){\small{C}}
	\end{pspicture}
\end{center}
Zajímavostí prodejní opce oproti kupní opci je ta, œô¡¾e œô ­asová hodnota opce je pro dostateœô ­nœô » malá $S$ záporná. Hodnota opce je tak niœô¡¾œô¡¡í neœô¡¾ její vnitœô ùní hodnota.

\section{Put-call parita}
Aœô ­koliv je prodejní opce na první pohled zcela odliœô¡¡ná od kupní opce, existuje mezi tœô »mito typy opcí vztah, kterı se nazıvá put-call paritou.

Uvaœô¡¾ujme evropskou kupní a prodejní opci, které mají shodné podkladové aktivum, realizaœô ­ní cenu a zbytkovou splatnost. Dále uvaœô¡¾ujme portfolio, které se skládá z podkladového aktiva, dlouhé pozice v prodejní a krátké pozici v kupní opci. Nechœô¡¥ $\Pi$ je hodnota tohoto portfolia.
\begin{equation*}
\Pi(t) = S + P(S,t) - C(S,t)
\end{equation*}
Vıplata z portfolia v dobœô » splatnosti $T$ obou opcí je
\begin{equation*}
S + \max(E-S,0) - \max(S-E,0)
\end{equation*}
a je rovna $E$ bez ohledu na koneœô ­nou hodnotu podkladového aktiva. Toto portfolio je tedy bezrizikové\footnote{Portfolio je prosté trœô¡¾ních rizik. Investor vœô¡¡ak mœô¡¯œô¡¾e utrpœô »t ztrátu v dœô¡¯sledku realizace kreditního rizika. To vœô¡¡ak momentálnœô » není pœô ùedmœô »tem naœô¡¡eho zájmu.}. Vınos z tohoto portfolia by tak mœô »l bıt roven bezrizikové úrokové sazbœô » $r$. Hodnota portfolia v œô ­ase $t < T$ je rovna
\begin{equation}
S + P(S,t) - C(S,t) = Ee^{-r(T-t)}
\end{equation}
Rovnice (3.2) pœô ùedstavuje put-call paritu.

\section{Analıza Black-Scholes modelu}

Pœô ùed tím, neœô¡¾ zaœô ­neme se samotnım popisem Black-Scholes modelu, uveœô ¯me pœô ùedpoklady, na nichœô¡¾ je tento model zaloœô¡¾en.
\begin{itemize}
\item Cena podkladového aktiva sleduje lognormální rozdœô »lení.
\item Bezriziková úroková sazba $r$ a volatilita podkladového aktiva $\sigma$ jsou známé funkce œô ­asu po dobu œô¡¾ivotnosti opce.
\item Neexistují transakœô ­ní náklady spojené se zajiœô¡¡tœô »ním portfolia.
\item Podkladové aktivum negeneruje po dobu œô¡¾ivotnosti opce œô¡¾ádné cash-flow (napœô ù. dividendy nebo úrokové platby). Od tohoto mœô¡¯œô¡¾eme upustit za pœô ùedpokladu, œô¡¾e vıœô¡¡e cash-flow je dopœô ùedu známa a œô¡¾e je vypláceno k urœô ­itému œô ­asovému okamœô¡¾iku nebo nebo spojitœô » po celou dobu œô¡¾ivotnosti opce.
\item Neexistuje moœô¡¾nost arbitráœô¡¾e. To znamená, œô¡¾e vœô¡¡echna bezriziková portfolia musí generovat vınos odpovídající bezrizikové sazbœô ».
\item S podkladovım aktivem je moœô¡¾né obchodovat nepœô ùetrœô¡¾itœô » v libovolnı œô ­asovı okamœô¡¾ik.
\item Prodej nakrátko je povolen a pokladové aktivum je dokonale dœô »litelné. To znamená, œô¡¾e je moœô¡¾né prodat aktivum, které nevlastníme a œô¡¾e ho mœô¡¯œô¡¾eme nakoupit popœô ù. prodat libovolné mnoœô¡¾ství (napœô ù $\sqrt{2}$ kusœô¡¯ akcií).
\end{itemize}

Uvaœô¡¾ujme opci, jejíœô¡¾ hodnota $V(S,t)$ je závislá pouze na $S$ a $t$. S vyuœô¡¾itím It\^o lemmy lze $V(S,t)$ rozepsat jako
\begin{equation*}
dV = \sigma S \frac{\partial V}{\partial S}dX + \Bigg( \mu S \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2V}{\partial S^2} + \frac{\partial V}{\partial t} \Bigg)dt
\end{equation*}

Nyní uvaœô¡¾ujme portfolio, které se skládá z jedné opce a $-\Delta$ jednotek podkladového aktiva. Hodnota portfolia $\Pi$ je rovna
\begin{equation}
\Pi = V -\Delta S
\end{equation}
a zmœô »na hodnoty portfolia $d \Pi$ v rámci jednoho œô ­asového kroku $dt$ je rovna
\begin{equation*}
d \Pi = dV -\Delta dS
\end{equation*}
S pouœô¡¾itím (2.1) a (2.6) lze vıœô¡¡e uvedenou rovnici pœô ùetransformovat do podoby
\begin{equation*}
d\Pi = \sigma S \Bigg( \frac{\partial V}{\partial S} - \Delta \Bigg)dX + \Bigg( \mu S \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 V}{\partial S^2} + \frac{\partial V}{\partial t} - \mu \Delta S \Bigg)dt
\end{equation*}
Jak jsme jiœô¡¾ ukázali dœô ùíve, náhodnost je moœô¡¾né eliminovat tak, œô¡¾e zvolíme
\begin{equation}
\Delta = \frac{\partial V}{\partial S}
\end{equation}
Poznamenejme, œô¡¾e $\partial V/ \partial S$ je hodnotou $\Pi$ pro zaœô ­átek œô ­asového kroku $dt$. V tomto pœô ùípadœô » se hodnota portfolia stane pro infinitymezální œô ­asovı krok $dt$ deterministická.
\begin{equation*}
d \Pi = \Bigg( \frac{\partial V}{\partial t}  + \frac{1}{2}\sigma^2S^2\frac{\partial^2V}{\partial S^2}\Bigg)dt
\end{equation*}
Vzhledem k tomu, œô¡¾e vıœô¡¡e uvedené portfolio je bezrizikové, musí generovat vınos odpovídající bezrizikové úrokové sazbœô ». Platí tedy
\begin{equation*}
r \Pi dt  = \Bigg( \frac{\partial V}{\partial t}  + \frac{1}{2}\sigma^2S^2\frac{\partial^2V}{\partial S^2}\Bigg)dt
\end{equation*}
Substitucí (3.3) a (3.4) do vıœô¡¡e uvedené rovnice získáváme diferenciální rovnici
\begin{equation}
\frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + rS \frac{\partial V}{\partial S} - rV = 0
\end{equation}
Tato diferenciální rovnice tvoœô ùí jádro Black-Scholes modelu. Pœô ùi splnœô »ní vıœô¡¡e uvedenıch pœô ùedpokladœô¡¯ musí libovolnı finanœô ­ní derivát, jehoœô¡¾ hodnota je závislá pouze na $S$ a $t$, splœô èovat diferenciální rovnici (3.5). Na této rovnici je také zajímavé, œô¡¾e její hodnota není funkcí $\mu$. Jedinım parametrem z vıchozí rovnice (2.1), kterı má vliv na hodnotu opce $V$, je tak volatilita ceny podkladového aktiva $\sigma$.

\section{Black-Scholes rovnice}

Nejœô ­astœô »jœô¡¡ím typem parciální diferenciální rovnice ve finanœô ­ní matematice je tzv. parabolická rovnice. Parabolická rovnice pro funkci $V(S,t)$ definuje vztah mezi mezi $V$ a jeho parciálními derivacemi vzhledem k nezávislım promœô »nnım $S$ a $t$. V nejjednoduœô¡¡œô¡¡ím pœô ùípadœô » je nejvyœô¡¡œô¡¡í parciální derivace vzhledem k $S$ druhého œô ùádu a nejvyœô¡¡œô¡¡í derivace vzhledem k $t$ je prvního œô ùádu. Rovnice (3.5) tedy splœô èuje tuto definici. Jestliœô¡¾e je rovnice navíc lineární a znaménka jednotlivıch derivací jsou po pœô ùevedení na jednu stranu shodná, jedná se o zpœô »tnou parabolickou diferenciální rovnici. V opaœô ­ném pœô ùípadœô » se jedná o dopœô ùednou parabolickou rovnici. Rovnice (3.5) je tedy zpœô »tnou parabolickou diferenciální rovnicí.

K jednoznaœô ­nému urœô ­ení hodnoty opce nestaœô ­í pouze rovnice (3.5), protoœô¡¾e ta sama o sobœô » jednoznaœô ­né œô ùeœô¡¡ení nemá. Proto je tœô ùeba definovat podmínky, které daná opce musí splœô èovat. Tyto podmínky charakterizující hodnotu opce pro vybranou podmnoœô¡¾inu jejího definiœô ­ního oboru. Spolu s diferenciální rovnicí (3.5) jednoznaœô ­nœô » urœô ­ují hodnotu uvaœô¡¾ované opce. Standardnœô » se definují dvœô » tzv. hraniœô ­ní podmínky pro parametr $S$ a jedna tzv. koneœô ­ná podmínka pro parametr $t$. Obecnı zápis podmínek pro $S$ je
\begin{equation*} 
V(S,t)=V_a(t), ~~~ S = a
\end{equation*}
a
\begin{equation*} 
V(S,t)=V_b(t), ~~~ S = b
\end{equation*}
kde $V_a$ a $V_b$ jsou funkcemi promœô »nné $t$. Protoœô¡¾e (3.5) je zpœô »tná parabolická diferenciální rovnice, musíme specifikovat podmínku pro $t = T$. Tato podmínka má tvar
\begin{equation*}
V(S,t)= V_T(S)
\end{equation*}
Rovnici (3.5) tak œô ùeœô¡¡íme ``pozpátku'' smœô »rem k œô ­asu $t = 0$. Jestliœô¡¾e by se jednalo o dopœô ùednou parabolickou diferenciální rovnici, stanovovali bychom tzv. poœô ­áteœô ­ní podmínku pro $t = 0$. Dopœô ùednou parabolickou diferenciální rovnici lze snadno zmœô »nit na zpœô »tnou pouhou zmœô »nou promœô »nnıch $t' = -t$ a naopak. Oba typy jsou tedy z matematického pohledu identické a je bœô »œô¡¾né, œô¡¾e se zpœô »tná parabolická diferenciální rovnice pœô ùed tím, neœô¡¾ se zapoœô ­ne s její analızou, pœô ùetransformuje na dopœô ùednou.

\section{Podmínky pro evropské opce}

\subsection{Evropská kupní opce}

Jak bylo œô ùeœô ­eno v pœô ùedchozí kapitole, aby rovnice (3.5) mœô »la jedineœô ­né œô ùeœô¡¡ení, je tœô ùeba ji doplnit sadou tœô ùí podmínek - jednou pro parametr $t$ a dvœô »mi pro parametr $S$.

Uvaœô¡¾ujme evropskou kupní opci, jejíœô¡¾ hodnotu budeme znaœô ­it $C(S,t)$, realizaœô ­ní hodnotu $E$ a splatnost $T$. Podmínka pro $t$ je dána hodnotou opce v dobœô » její splatnosti $T$.
\begin{equation}
C(S,T) = \max(S-E,0)
\end{equation}
Podmínky pro $S$ definujeme pro krajní hodnoty této promœô »nné, tj. pro $S=0$ a $S \rightarrow \infty$. Je-li $S = 0$, stává se proces popsanı rovnicí (2.1) deterministickım a $S$ je nulové pro libovolnı budoucí œô ­asovı okamœô¡¾ik. Evropská kupní opce je tedy bezcenná.
\begin{equation}
C(0,t) = 0
\end{equation}
Jeslitliœô¡¾e se naopak $S$ blíœô¡¾í nekoneœô ­nu, je prakticky jisté, œô¡¾e opce bude uplatnœô »na. Realizaœô ­ní cena $E$ je navíc v porovnání s $S$ zanedbatelná. Proto platí
\begin{equation}
C(S \rightarrow \infty,t) \sim S
\end{equation}

\subsection{Evropská prodejní opce}

V pœô ùípadœô » evropské prodejní opce jsou podmínky analogické. Podmínka vzhledem k œô ­asu $t$ je opœô »t stanovena k datu splatnosti opce $T$ a má tvar
\begin{equation}
P(S,T) = \max(E-S, 0)
\end{equation}
Stejnœô » jako v pœô ùípadœô » evropské kupní opce jsou podmínky pro $S$ stanoveny pro krajní hodnoty $S=0$ a $S \rightarrow 0$. Vzhledem k charakteru vıplatního profilu opce mají tyto podmínky podobu
\begin{equation}
P(0,t)=Ee^{-r(T-t)}
\end{equation}
a
\begin{equation}
P(S \rightarrow \infty,t) \rightarrow 0
\end{equation}

\section{Rovnice Black-Scholes modelu}

Jestliœô¡¾e jsou $\sigma$ a $r$ konstatní, má œô ùeœô¡¡ení diferenciální rovnice (3.5) za podmínek (3.6), (3.7) a (3.8) pro evropskou kupní opci tvar
\begin{equation*}
C(S,t) = S N(d_1) - Ee^{-r(T-t)}N(d_2)
\end{equation*}
kde $N(\cdot)$ pœô ùedstavuje kumulativní distribuœô ­ní funkci normovaného normálního rozdœô »lení. Parametry $d_1$ a $d_2$ této funkce jsou definovány jako
\begin{equation*}
d_1 = \frac{\ln \frac{S}{E}+(r+\frac{1}{2}\sigma^2)(T-t)}{\sigma \sqrt{T-t}}
\end{equation*}
\begin{equation*}
d_2 = \frac{\ln \frac{S}{E}+(r-\frac{1}{2}\sigma^2)(T-t)}{\sigma \sqrt{T-t}}
\end{equation*}
Pro evropskou prodejní opci a jí odpovídající hraniœô ­ní podmínky (3.9), (3.10) a (3.11) má œô ùeœô¡¡ení rovnice (3.5) tvar
\begin{equation*}
P(S,t)=Ee^{-r(T-t)}N(-d_2) - SN(-d_1)
\end{equation*}
kde $d_1$ a $d_2$ jsou definovány stejnœô » jako v pœô ùedchozím pœô ùípadœô ».

Následující obrázky ukazují, jak se vyvíjí hodnota evropské opce s tím, jak se $t$ blíœô¡¾í $T$.
\begin{center}
	\begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Hodnota evropské kupní opce jako funkce}
                \rput(4.0,0.0){parametru $S$ pro rœô¡¯zná $t$}

		\psline[arrows=->](0.5,1.5)(7.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

                \psline[linewidth=0.5mm](0.5,1.5)(3.0,1.5)(7.5,6.0)
                \pscurve(1.5,1.5)(2.5,1.60)(5.0,3.65)(7.3,5.95)
                \pscurve(1.2,1.5)(2.5,1.75)(5.0,3.80)(7.3,6.15)
                \pscurve(1.0,1.5)(2.5,1.90)(5.0,3.95)(7.3,6.30)


                \rput(0.5,1.2){\small{0}}
                \rput(3.0,1.2){\small{E}}
                \rput(7.5,1.2){\small{S}}
                \rput(0.2,6.0){\small{C}}

                \psline[arrows=->](6.2,5.7)(7.2,5.7)
                \psline[arrows=->](6.2,5.9)(7.2,5.9)
                \psline[arrows=->](6.2,6.1)(7.2,6.1)
                \psline[arrows=->](6.2,6.3)(7.2,6.3)

                \rput(5.3,5.7){\tiny{$T-t = 0.0$}}
                \rput(5.3,5.9){\tiny{$T-t = 0.5$}}
                \rput(5.3,6.1){\tiny{$T-t = 1.0$}}
                \rput(5.3,6.3){\tiny{$T-t = 1.5$}}

	\end{pspicture}
\end{center}
\begin{center}
	\begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Hodnota evropské prodejní opce jako funkce}
                \rput(4.0,0.0){parametru $S$ pro rœô¡¯zná $t$}

		\psline[arrows=->](0.5,1.5)(7.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

                \psline[linewidth=0.5mm](0.5,5.5)(4.5,1.5)(7.5,1.5)
                \pscurve(0.5,5.30)(2.5,3.30)(3.80,2.07)(4.40,1.70)(7.0,1.5)
                \pscurve(0.5,5.15)(2.5,3.10)(3.80,1.95)(4.40,1.70)(7.0,1.5)
                \pscurve(0.5,4.95)(2.5,2.90)(3.80,1.85)(4.40,1.70)(7.0,1.5)

                \rput(0.5,1.2){\small{0}}
                \rput(4.5,1.2){\small{E}}
                \rput(7.5,1.2){\small{S}}
                \rput(0.2,6.0){\small{C}}

                \psline[arrows=->](2.0,4.7)(0.75,4.7)
                \psline[arrows=->](2.0,4.9)(0.70,4.9)
                \psline[arrows=->](2.0,5.1)(0.70,5.1)
                \psline[arrows=->](2.0,5.3)(0.75,5.3)

                \rput(2.8,4.7){\tiny{$T-t = 1.5$}}
                \rput(2.8,4.9){\tiny{$T-t = 1.0$}}
                \rput(2.8,5.1){\tiny{$T-t = 0.5$}}
                \rput(2.8,5.3){\tiny{$T-t = 0.0$}}

	\end{pspicture}
\end{center}
Z vıœô¡¡e uvedenıch obrázkœô¡¯ je zœô ùejmé, œô¡¾e s tím, jak se $t \rightarrow T$, blíœô¡¾í se hodnota opce vnitœô ùní hodnotœô » opce, tj. œô ­asová hodnota opce se blíœô¡¾í nule.

\subsection{Delta opce}

œô øecké písmeno delta vyjadœô ùuje citlivost ceny opce na zmœô »nu ceny podkladového aktiva v œô ­asovém intervalu $dt \rightarrow 0$. Delta evropské kupní opce je definováno jako
\begin{equation*}
\Delta = \frac{\partial C}{\partial S} = N(d_1)
\end{equation*}
a evropské prodejní opce jako
\begin{equation*}
\Delta = \frac{\partial P}{\partial S} = N(d_1)-1
\end{equation*}
Stejnœô » jako pro opce samotné platí také pro jejich delty put-call parita.
\begin{equation*}
S = P(S,t) - C(S,t)
\end{equation*}
\begin{equation*}
\frac{\partial S}{\partial S} = \frac{\partial P(S,t)}{\partial S} - \frac{\partial C(S,t)}{\partial S}
\end{equation*}
\begin{equation*}
1 = 1 - N(d_1) - N(d_1)
\end{equation*}
\begin{equation*}
0 = 0
\end{equation*}
\begin{center}
	\begin{pspicture}(0,0)(7.0,7.0)
		\rput(3.5,0.5){Delta evropské kupní opce jako funkce}
                \rput(3.5,0.0){parametru $S$ pro rœô¡¯zná $t$}

		\psline[arrows=->](0.5,1.5)(6.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

                \psline[linewidth=0.5mm](0.5,1.5)(4.0,1.5)(4.0,5.0)(6.0,5.0)
                \pscurve(2.0,1.5)(2.9,2.00)(4.5,4.5)(5.20,4.85)(6.0,5.0)
                \pscurve(2.5,1.5)(3.1,1.90)(4.5,4.4)(5.20,4.90)(6.0,5.0)
                \pscurve(3.0,1.5)(3.3,1.80)(4.5,4.3)(5.20,4.95)(6.0,5.0)

                \rput(0.5,1.2){\small{0}}
                \rput(4.0,1.2){\small{E}}
                \rput(6.5,1.2){\small{S}}
                \rput(0.2,6.0){\small{C}}

                \psline[arrows=->](3.0,3.0)(4.05,3.0)
                \psline[arrows=->](3.0,3.2)(4.00,3.2)
                \psline[arrows=->](3.0,3.4)(3.95,3.4)
                \psline[arrows=->](3.0,3.6)(3.90,3.6)

                \rput(2.2,3.0){\tiny{$T-t = 0.0$}}
                \rput(2.2,3.2){\tiny{$T-t = 0.5$}}
                \rput(2.2,3.4){\tiny{$T-t = 1.0$}}
                \rput(2.2,3.6){\tiny{$T-t = 1.5$}}
                
	\end{pspicture}
\end{center}
Vıœô¡¡e uvedenı obrázek zachycuje hodnotu delty evropské kupní opce jako funkce parametru $S$ pro rœô¡¯zné hodnoty parametru $t$. Delta vœô¡¾dy nabıvá hodnot z intervalu nula aœô¡¾ jedna. S tím, jak se $t \rightarrow T$, stává se její hodnota stále více citlivá na zmœô »nu $S$. Jesltiœô¡¾e si uvœô »domíme, œô¡¾e delta vyjadœô ùuje zmœô »nu hodnoty opci v závislosti na zmœô »nœô » $S$, není toto zjiœô¡¡tœô »ní pœô ùekvapivé. S tím, jak se zbytková splatnost opce blíœô¡¾í nule, klesá pravdœô »podobnost, œô¡¾e se cena podkladového aktiva v dobœô » splanosti opce bude vıznamnœô »ji odliœô¡¡ovat od spotové ceny.

\subsection{Delta zajiœô¡¡tœô »ní}

Uvaœô¡¾ujme vypisovatele evropské kupní opce, kterı, bude-li k tomu vyzván, musí v dobœô » splatnosti opce dodat podkladové aktivum. Pœô ùedpokládejme, œô¡¾e tento investor vyuœô¡¾ívá tzv. delta zajiœô¡¡tœô »ní. Invetor tedy drœô¡¾í delta jednotek podkladového aktiva, protoœô¡¾e v infinitimezálním œô ­asovém okamœô¡¾iku platí
\begin{equation*}
 C - \Delta S = 0
\end{equation*}
V dobœô » splatnosti bude investor drœô¡¾et správné mnoœô¡¾ství podkladového aktiva. V pœô ùípadœô », œô¡¾e bude opce uplatnœô »na, bude její delta rovna jedné a investor tak bude drœô¡¾et jednu jednotku podkladového aktiva. V opaœô ­ném pœô ùípadœô » bude delta opce rovna nule a investor tak nebude drœô¡¾et œô¡¾ádné podkladové aktivum. V ideálním pœô ùípadœô » by investor pœô ùi vypsání opce nakoupil podkladové aktivum v objemu odpovídající poœô ­áteœô ­ní deltœô » opce a následnœô » tuto pozici postupnœô » navyœô¡¡oval resp. redukoval aœô¡¾ do splatnosti opce s tím, jak se mœô »nila delta opce. Problematická vœô¡¡ak mœô¡¯œô¡¾e bıt napœô ù. situace, kdy by cena podkladového aktiva vzrostla, klesla a opœô »t vzrostla. V tomto pœô ùípadœô » by investor pozici v podkladovém aktivu nejprve navıœô¡¡il, po té zredukovat a následnœô » opœô »t navıœô¡¡il. Navíc pro $t \rightarrow T$ v situaci, kdy by se spotová cena podkladového aktiva $S$ nacházela v  blízkosti realizaœô ­ní ceny $E$, se mœô¡¯œô¡¾e delta opce zmœô »nit z œô ­ísla blízkého nule na œô ­íslo blízké jedné popœô ù. naopak a to i nœô »kolikrát po sobœô ». S ohledem na moœô¡¾né transakœô ­ní náklady se tedy delta zajiœô¡¡tœô »ní pro praxi pœô ùíliœô¡¡ nehodí.

\section{Zajiœô¡¡tœô »ní v praxi}

Zajiœô¡¡tœô »ní spoœô ­ívá ve sníœô¡¾ení senzitivity portfolia na pohyb ceny podkladového aktiva a to tak, œô¡¾e investor zaujme opaœô ­nou pozici v jiném finanœô ­ním instrumentu. Dva extrémní pœô ùíklady jsme si jiœô¡¾ ukázali - v obou byla senzitivita zredukována na nulu. V prvním pœô ùípadœô » jsme vycházeli z put-call parity a v druhém pœô ùípadœô » se jednalo o delta zajiœô¡¡tœô »ní. Existují vœô¡¡ak i jiné zpœô¡¯soby zajiœô¡¡tœô »ní, které kromœô » delty zahrnují také jiná tzv. œô ùecká písmena.

Pouze pœô ùipomeœô ème, œô¡¾e delta portfolia je dána vztahem
\begin{equation*}
\Delta = \frac{\partial \Pi}{\partial S}
\end{equation*}
Portfolio, které se skládá z opce a delta jednotek podkladového aktiva, nazıváme delta neutrální. Senzitivita tohoto portfolia na zmœô »nu ceny podkladového aktiva je v nekoneœô ­nœô » krátkém œô ­asovém okamœô¡¾iku nulová.

Pomocí delta zajiœô¡¡tœô »ní jsme z vœô »tœô¡¡í œô ­ásti eliminovali citlivost hodnoty portfolia na zmœô »nu ceny podkladového aktiva. Nicnémœô » i po delta zajiœô¡¡tœô »ní zœô¡¯stává portfolio marginálnœô » citlivé na zmœô »nu ceny podkladového aktiva. Dœô¡¯vodem je nelinearita delty. K odstranœô »ní této zbytkové citlivosti se pouœô¡¾ívá tzv. gamma zajiœô¡¡tœô »ní.
\begin{equation*}
\Gamma = \frac{\partial^2 \Pi}{\partial S^2}
\end{equation*}
Zmœô »na hodnoty portfolia v œô ­ase je vyjádœô ùena œô ùeckım písmenem $\Theta$.
\begin{equation*}
\Theta = \frac{\partial \Pi}{\partial t}
\end{equation*}
Senzitivita portfolia na volatilitu ceny podkladového aktiva je dána œô ùeckım písmenem vega
\begin{equation*}
\nu = \frac{\partial \Pi}{\partial \sigma}
\end{equation*}
a koneœô ­nœô » pro mœô »œô ùení citlivosti hodnoty portfolia na zmœô »nu bezrizikové úrokové míry se vyuœô¡¾ívá œô ùecké písmeno $\rho$.
\begin{equation*}
\rho = \frac{\partial \Pi}{\partial r}
\end{equation*}
 
\subsection{Imunizace portfolia}

Aby portfolio nebylo citlivé na zmœô »ny vybranıch veliœô ­in\footnote{Mezi takovéto veliœô ­inu mœô¡¯œô¡¾e patœô ùit napœô ù. zmœô »na ceny podkladového aktiva $dS$, œô ­asovı posun $dt$, zmœô »na volatility podkladového aktiva $d \sigma$ nebo zmœô »na bezrizikové úrokové sazby $dr$.}, musí kromœô » podkladového aktiva zahrnovat také finanœô ­ní deriváty odvozené od uvaœô¡¾ovaného podkladového aktiva. Takovéto portfolio oznaœô ­ujeme jako imunizované. Abychom sestavili portfolio imunizované vœô¡¯œô ­i $n$ veliœô ­inám, musí toto portfolio kromœô » podkladového aktiva obsahovat také nejménœô » $n$ finanœô ­ních derivátœô¡¯. Matematickım vyjádœô ùením tohoto problému je pak $n$ rovnic o $n$ neznámıch. Následující pœô ùíklad ilustruje imunizaci portfolia vœô¡¯œô ­i $dS$ a $dt$.

Uvaœô¡¾ujme portfolio, které se skládá ze tœô ùí finanœô ­ních instrumentœô¡¯ - podkladového aktiva a dvou opcí $V_1$ a $V_2$. Oznaœô ­me deltu první resp. druhé opce jako $\Delta_1$ resp. $\Delta_2$, thetu první resp. druhé opce jako $\Theta_1$ resp. $\Theta_2$ a gammu první resp. druhé opce jako $\Gamma_1$ resp. $\Gamma_2$. Hodnotu portfolia definujme jako
\begin{equation*}
\Pi = S + a_1V_1 + a_2V_2
\end{equation*}
Je-li finanœô ­ní derivát funkcí $S$ a $t$, platí pro nœô »j dle It\^o lemmy následující vztah
\begin{equation*}
dV = \Bigg( \mu S \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 V}{\partial S^2}+\frac{\partial S}{\partial t} \Bigg) dt + \sigma S \frac{\partial V}{\partial S}dX
\end{equation*}
S vyuœô¡¾itím œô ùeckıch písmen lze tento vztah pœô ùepsat do tvaru
\begin{equation*}
dV = \Bigg( \mu S \Delta + \frac{1}{2}\sigma^2S^2 \Gamma + \Theta \Bigg) dt + \sigma S \Delta dX
\end{equation*}
Zmœô »na ceny podkladového aktiva je dána rovnicí (2.1).
\begin{equation*}
dS = \mu S dt + \sigma S dX
\end{equation*}
Aby bylo portfolio inumizované, musí platit
\begin{equation*}
dS  + a_1 dV_1 + a_2 dV_2 = 0
\end{equation*}
S vyuœô¡¾itím vıœô¡¡e uvedenıch rovnic lze tento vztah dále upravit do tvaru
\begin{equation*}
\mu dt + \sigma dX + a_1 \Bigg( \bigg(\mu \Delta_1 + \frac{1}{2}\sigma^2 S \Gamma_1 + \Theta_1 \bigg)dt + \sigma \Delta_1 dX \Bigg) + a_2 \Bigg( \bigg(\mu \Delta_2 + \frac{1}{2}\sigma^2 S \Gamma_2 + \Theta_2 \bigg)dt + \sigma \Delta_2 dX \Bigg) = 0
\end{equation*}
Abychom eliminovali náhodnou sloœô¡¾ku, musí platit
\begin{equation*}
\sigma dX + a_1 \sigma \Delta_1 dX + a_2 \sigma \Delta_2 = 0 
\end{equation*}
\begin{equation*}
1 + a_1 \Delta_1 + a_2 \Delta_2 
\end{equation*}
\begin{equation}
a_2 = - \frac{1 + a_1 \Delta_1}{\Delta_2}
\end{equation}
Abychom imunizovali portfolio proti ztrátœô » jeho hodnoty v dœô¡¯sledku prostého plynutí œô ­asu, musí platit
\begin{equation*}
\mu dt + a_1 \bigg( \Delta_1 + \frac{1}{2}\sigma^2S \Gamma_1 + \Theta_1 \bigg) dt + a_2 \bigg( \Delta_2 + \frac{1}{2}\sigma^2S \Gamma_2 + \Theta_2 \bigg) dt = 0
\end{equation*}
\begin{equation}
\mu - 1 + \frac{1}{2}\sigma^2(a_1 \Gamma_1 + a_2 \Gamma_2) + (a_1 \Theta_1 + a_2 \Theta_2) = 0
\end{equation}
Dosazením (3.12) do (3.13) a pœô ùevedením $a_1$ na jednu stranu rovnice získáváme
\begin{equation*}
a_1 = \frac{1 - \mu + \frac{1}{\Delta_2}\bigg( \frac{1}{2} \sigma^2 S + \Theta_2 \bigg)}{\frac{1}{2} \sigma^2 S (\Gamma_1 - \frac{\Delta_1}{\Delta_2}\Gamma_2) + \bigg( \Theta_1 - \frac{\Delta_1}{\Delta_2} \Theta_2 \bigg)}
\end{equation*}
Parametru $a_2$ je pak dána rovnicí (3.12).

Aby byla hodnota portfolia $\Pi$ imunní vœô¡¯œô ­i zmœô »nám $dS$ a $dt$, musí se skládat z jedné jednotky podkladového aktiva, $a_1$ jednotek opce $V_1$ a $a_2$ jednotek opce $V_2$.

\section{Volatilita ceny podkladového aktiva}

Aœô¡¾ dosud jsme pœô ùedpokládáli, œô¡¾e na základœô » historickıch dat odhadneme hodnoty vstupních parametrœô¡¯, které dosadíme do Black-Scholes modelu a následnœô » vypoœô ­teme hodnotu opce.

Nezbytnım vstupním parametrem Black-Scholes modelu je bezriziková úroková sazba. Tato sazba je kotována trhem pro rœô¡¯zné splatnosti. Pro vıbœô »r konkrétní úrokové sazby je rozhodující zbytková splatnost opce. Tento parametr nepœô ùestavuje z praktického hlediska problém.

Problematickım parametrem je vœô¡¡ak volatilita ceny podkladového aktiva. Pœô ùedpoklad, œô¡¾e volatilita je konstatní v œô ­ase, je zavádœô »jící. Volatilita vypoœô ­tená na základœô » historickıch dat je totiœô¡¾ znaœô ­nœô » ovlivnœô »na vıbœô »rem œô ­asové œô ùady, a proto ji nelze pouœô¡¾ít jako odhad souœô ­asné nebo dokonce budoucí volatility. Pœô ùímı vıpoœô ­et volatility v praxi je tak velmi problematickı. Volatilita pro evropské opce je vœô¡¡ak kotována trhem. Trh tuto volatilitu tedy ``zná''. Volatility jsou kotovány pro rozdílnou splatnost a realizaœô ­ní cenu popœô ù. deltu opce\footnote{Realizaœô ­ní cenu lze z delty pœô ùísluœô¡¡né opce pœô ùi znalosti ostatních vstupních parametrœô¡¯ snadno dopoœô ­ítat. Z tohoto pohledu je tedy lhostejno, zda-li je volatilita kotována ve vztahu k realizaœô ­ní cenœô » nebo deltœô » opce.} v rozdœô »lení na kupní a prodejní opce. Pœô ùíklad takovéto kotace je uveden na obrázku \ref{intel_volatility}.

\begin{figure}
  \includegraphics[bb=0 0 350 250]{intel.bmp}
  \caption{Kotace implikované volatility (sloupec IVM) pro akcie spoleœô ­nosti Intel v závisloti na realizaœô ­ní cenœô » resp. deltœô » opce (sloupec DM) a dobœô » do splatnosti opce (zdroj: Bloomberg)}
  \label{intel_volatility}
\end{figure}

Zamœô »œô ùme se na kotovanou volatilitu pro evropskou kupní opci se splatností 22.listopadu 2008. Kotovaná volatilita klesá z 363.36\% pro realizaœô ­ní cenu 9 USD aœô¡¾ na 129.09\% pro 13 USD a pak opœô »t roste na 462.81\% pro realizaœô ­ní cenu 23 USD. Jestliœô¡¾e bychom tedy vynesli tuto volatitu do grafu proti realizaœô ­ní cenœô », získali bychom graf ve tvaru písmene ``U''. Pro tento graf se pouœô¡¾ívá pojem ``volatility smile'', kterı má vyjadœô ùovat typickı vztah mezi realizaœô ­ní cenou a kotovanou volatilitou.

S pomocí kotované volatility a úrokové sazby je moœô¡¾né vypoœô ­íst hodnotu opce. Cena opce tak není kotována pœô ùímo, ale nepœô ùímo skrze kotaci pœô ùísluœô¡¡né volatility. Jestliœô¡¾e bychom namísto volatility mœô »li kotovanou pœô ùímo cenu opce (napœô ù. u OTC obchodœô¡¯), je moœô¡¾né volatilitu zpœô »tnœô » dopoœô ­ítat. Takto vypoœô ­tenou volatilitu pak oznaœô ­ujeme jako implikovanou volatilitu.

Odliœô¡¡né kotace volatilit pro jednotlivé realizaœô ­ní ceny odráœô¡¾í skuteœô ­nost, œô¡¾e cena podkladového aktiva ve skuteœô ­nosti nesleduje lognormální rozdœô »lení. Lognormální rozdœô »lení je pouhou aproximací pravdœô »podobnostního rozdœô »lení, které oœô ­ekává trh.

Vzhledem k tomu, œô¡¾e volatilita je kotována také pro rœô¡¯zné splatnosti, mœô »ní se pravdœô »podobnostní rozdœô »lení oœô ­ekávané trhem také v œô ­ase. V pœô ùípadœô » kotací volatilit v závislosti na realizaœô ­ní cenœô » resp. deltœô » a zbytkové splatnosti hovoœô ùíme o tzv. ``volatility surface''.

\chapter{Parciální diferenciální rovnice}

\section{Difúzní rovnice}

Teplotní nebo také difúzní rovnice
\begin{equation}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2}
\end{equation}
popisuje œô¡¡íœô ùení tepla ve jednorozmœô »rném spojitém médiu, kde $u(u, \tau)$ pœô ùedstavuje teplotu v tyœô ­i z homegenního materiálu jejíœô¡¾ konce jsou dokonale izolovány. Teplota této tyœô ­e je tak pouze funkcí vzdálenosti $x$ od zdroje tepla a œô ­asu $\tau$. Vıœô¡¡e popsaná difúzní rovnice splœô èuje následující podmínky
\begin{itemize}
\item Difúzní rovnice je lineární rovnicí. To znamená, œô¡¾e jsou-li $u_1$ a $u_2$ œô ùeœô¡¡ením, je œô ùeœô¡¡ením také jejich libovolná lineární kombinace $c_1 u_1 + c_2 u_2$.
\item Vzhledem k tomu, œô¡¾e nejvyœô¡¡œô¡¡í derivací je œô ­len $\partial^2 u / \partial x^2$, jedná se diferenciální rovnici druhého œô ùádu.
\item Jedná se o parabolickou rovnici a její charakteristiky jsou dány $\tau = k$, kde $k$ je libovolná konstanta\footnote{Pojem charakteristika bude vysvœô »tlen dále.}.  Informace se tak œô¡¡íœô ùí podél charakteristiky v prostoru $u(x, \tau)$ a kaœô¡¾dá zmœô »na $u$ v urœô ­itém bodœô » se okamœô¡¾itœô » projeví ve vœô¡¡ech ostatních bodech.
\item œô øeœô¡¡ením této rovnice jsou analytické funkce promœô »nné $x$. Pro libovolnou hodnotu $\tau$ vœô »tœô¡¡í neœô¡¾ poœô ­áteœô ­ní œô ­as $t$ existuje pro kaœô¡¾dou funkci $u(x, \tau)$ promœô »nné $x$ konvergentní polynomická œô ùada ve tvaru
\begin{equation}
a_0 + a_1(x - x_0) + a_2(x - x_0)^2 + ...
\end{equation}
Z praktického hlediska tedy mœô¡¯œô¡¾eme pro $\tau > 0$ povaœô¡¾ovat œô ùeœô¡¡ení difúzní rovnice za tak hladkou funkci, jak jen funkce mœô¡¯œô¡¾e bıt\footnote{Jak jiœô¡¾ bylo œô ùeœô ­eno vıœô¡¡e, œô ùeœô¡¡ení této rovnice lze aproximovat analytickou funkcí, která je ``dokonale'' hladkou funkcí.}. Mœô¡¯œô¡¾e vœô¡¡ak existovat nespojitost v œô ­ase jako dœô¡¯sledek existence hraniœô ­ních podmínek. To je dœô¡¯sledek toho, œô¡¾e se informace œô¡¡íœô ùí nekoneœô ­nœô » rychle podél charakteristiky $\tau = k$, kde $k$ je libovolná konstanta.
\end{itemize}

Z fyzikální pohledu je tepelná difúze ``vyhlazovací'' proces - teplo se œô¡¡íœô ùí z horké do chladné œô ­ásti a dochází tak k vyrovnávání teplot v námi uvaœô¡¾ované modelové tyœô ­i. Difúzní rovnice je matematickım modelem tohoto procesu. Lze dokázat, œô¡¾e aœô ­koliv pœô¡¯vodní hodnoty mohou bıt skokové, je pro libovolné $\tau > 0$ œô ùeœô¡¡ení difúzní rovnice (4.1) na oboru hodnot $-\infty < x < \infty$ pro poœô ­áteœô ­ní data $u(x, 0) = u_0(x)$ a $u(x \rightarrow \pm \infty , \tau) \rightarrow 0$ analytické pro vœô¡¡echna $\tau > 0$.

Jako ilustrace vœô¡¡ech tœô »chto vlastností mœô¡¯œô¡¾e poslouœô¡¾it napœô ù. œô ùeœô¡¡ení
\begin{equation}
u(x, \tau) = \frac{1}{2 \sqrt{\pi \tau}}e^{\frac{-x^2}{4 \tau}}
\end{equation}
pro
$-\infty < x < \infty$ a $\tau > 0$. Pro $\tau > 0$ se jedná o hladkou Gausovu kœô ùivku, avœô¡¡ak pro $r = 0$ je (4.2) pœô ùejde v tzv. delta funkci
\begin{equation*}
u_{\delta}(x,0) = \delta(x) 
\end{equation*}
Delta funkce $u_{\delta}(x,0)$ je charakteristická tím, œô¡¾e její hodnota je pro $x \neq 0$ nulová a pro $x = 0$ se blíœô¡¾í nekoneœô ­nu, avœô¡¡ak integrál této funkce je vœô¡¾dy roven jedné. Následující obrázek pœô ùedstavuje $u(x, \tau)$ pro rœô¡¯zné hodnoty $\tau$.
\begin{center}
	\begin{pspicture}(0,0)(10.0,7.0)
		\rput(5.0,0.5){Fundamentální œô ùeœô¡¡ení difúzní rovnice}

		\psline(0.5,1.0)(9.5,1.0)
		\psline(5.0,1.0)(5.0,6.5)

                \pscurve(1.0,1.0)(3.0,1.2)(5.0,2.2)(7.0,1.2)(9.0,1.0)
                \pscurve[curvature=0.7 0.1 0](2.5,1.0)(4.0,1.2)(5.0,4.0)(6.0,1.2)(7.5,1.0)
                \pscurve(3.2,1.0)(3.5,1.0)(4.6,1.1)(4.8,1.5)
                \pscurve(5.2,1.5)(5.4,1.1)(6.5,1.0)(6.8,1.0)
                \pscurve[curvature=0.1 0.1 0](4.8,1.5)(5.0,6.0)(5.2,1.5)

                \rput(4.8,6.5){\small{$u_{\delta}$}}
                
                \psline[arrows=->](4.3,5.0)(4.8,5.0)
                \psline[arrows=->](4.05,3.5)(4.55,3.5)
                \psline[arrows=->](3.0,1.5)(3.5,1.5)

                \rput(3.8,5.0){\tiny{$\tau = 0.2$}}
                \rput(3.5,3.5){\tiny{$\tau = 1.0$}}
                \rput(2.5,1.5){\tiny{$\tau = 5.0$}}

	\end{pspicture}
\end{center}
Poœô ­áteœô ­ní hodnota delta funkce $u_{\delta}(x, 0)$ œô ùíká, œô¡¾e veœô¡¡keré teplo je pro $\tau = 0$ koncentrováno v bodœô » $x = 0$. Delta funkce modeluje pro $\tau > 0$ œô¡¡íœô ùení tepla materiálem a je fundamentálním œô ùeœô¡¡ením difúzní rovnice (4.1). Delta funkce také ilustruje nekoneœô ­nœô » rychlé œô¡¡íœô ùení tepla zmiœô èované vıœô¡¡e. Pro $\tau = 0$ je œô ùeœô¡¡ení (4.2) nulové pro vœô¡¡echna $x \neq 0$, avœô¡¡ak pro libovolné $\tau > 0$ jakkoliv malé a libovolné $x$ jakkoliv velké je $u_{\delta}(x, \tau) > 0$. Teplo, které bylo pœô¡¯vodnœô » koncentrováno do jednoho bodu se tak okamœô¡¾itœô » rozœô¡¡íœô ùilo podél celé délky tyœô ­e.

\subsection{Technická poznámka: Charakteristiky lineární parciální diferenciální rovnice druhého œô ùádu}

Charakteristiky lineární parciální diferenciální rovnice druhého œô ùádu je moœô¡¾né chápat jako kœô ùivky, podél kterıch se mœô¡¯œô¡¾e œô¡¡íœô ùit informace definovaná funkcí $u$, nebo také jako kœô ùivky napœô ùíœô ­ kterımi se mœô¡¯œô¡¾e vyskytovat nespojitost druhé derivace funkce $u$. Pœô ùedpokládejme, œô¡¾e $u(x, \tau)$ splœô èuje obecnou lineární diferenciální rovnici druhého œô ùádu.
\begin{equation*}
a(x, \tau)\frac{\partial^2 u}{\partial x^2} + b(x, \tau)\frac{\partial^2 u}{\partial x \partial \tau} + c(x,\tau)\frac{\partial^2 u}{\partial \tau^2} + d(x, \tau)\frac{\partial u}{\partial x} + 
\end{equation*}
\begin{equation*}
+ e(x, \tau)\frac{\partial u}{\partial \tau} + f(a, \tau)u + g(x, \tau) = 0
\end{equation*}
V pœô ùípadœô », œô¡¾e existuje charakteristika definovaná ve tvaru $x = x(\epsilon)$ a $\tau = \tau(\epsilon)$, je moœô¡¾né vıœô¡¡e uvedenou diferenciální rovnici za pœô ùedpokladu splnœô »ní podmínky
\begin{equation*}
a(x, \tau) \bigg( \frac{d \tau}{d \epsilon} \bigg)^2 - b(x, \tau)\frac{d \tau}{d \epsilon} \frac{d x}{d \epsilon} + c(x, \tau) \bigg( \frac{dx}{d \epsilon} \bigg)^2 = 0
\end{equation*}
 vyjádœô ùit pomocí smœô »rovıch derivací.

Nyní vyvstává otázka, zda-li tato kvadratická rovnice má (a) dva reálné koœô ùeny, (b) jeden reálnı koœô ùen nebo (c) œô¡¾ádnı koœô ùen z mnoœô¡¾iny reálnıch œô ­ísel. Tœô »mto œô ùeœô¡¡ením odpovídají situace, kdy je diskriminant $b^2 - 4ac$ kvadratické rovnice (a) vœô »tœô¡¡í neœô¡¾ nula, (b) roven nule nebo (c) menœô¡¡í neœô¡¾ nula. V prvním pœô ùípadœô » existují dvœô » charakteristiky, které nazıváme hyperbolické - typickım pœô ùíkladem je napœô ù. œô¡¡íœô ùení kapaliny; ve financích se tento typ diferenciální rovnice prakticky nevyskytuje. Je-li diskriminant roven nule, oznaœô ­ujeme charakteristiku jako parabolickou. Tento typ diferenciální rovnice je ve financích nejbœô »œô¡¾nœô »jœô¡¡í a také vœô¡¡echny diferenciální rovnice v této knize jsou parabolické. V posledním tœô ùetím pœô ùípadœô », kdy koœô ùeny nejsou z mnoœô¡¾iny reálnıch œô ­ísel, hovoœô ùíme o eliptické charakteristice. Ve finanœô ­ní matematice je moœô¡¾né se s tímto typem rovnice setkat napœô ù. u doœô¡¾ivotních opcí ve vícefaktorovıch modelech. Tuto oblast vœô¡¡ak naœô¡¡e kniha nepokrıvá.

Vzhledem k tomu, œô¡¾e jsou parametry $a$, $b$ a $c$ funkcí $x$ a $\tau$, mœô¡¯œô¡¾e se typ diferenciální rovnice mœô »nit. Diferenciální rovnice (3.5) Black-Scholes modelu, kterou jsme odvodili v pœô ùedchozí kapitole, je parabolická pro $S > 0$. Tato skuteœô ­nost má zásadní dœô¡¯sledek - $S = 0$ pœô ùedstavuje hranici, kterou nemœô¡¯œô¡¾e informace protnout.

\subsection{Technická poznámka: Delta funkce a stranová funkce}

Delta funkci $\delta(x)$ je vhodné spíœô¡¡e neœô¡¾ jako klasickou funkci chápat jako ``obecnou'' funkci. Delta funkce je formálnœô » definovaná jako lineární mapa, nicménœô » její existence je dána zejména potœô ùebou matematického popisu limity funkce, která, aœô ­koliv je omezována na poœô ùád menœô¡¡í interval, zœô¡¯stává koneœô ­ná.

Pœô ùedpokládejme, œô¡¾e investice generuje v œô ­asovém intervalu $dt$ penœô »œô¡¾ní prostœô ùedky ve vıœô¡¡i $f(t)dt$, kde funkce $f(t)$ je definována následovnœô »
\begin{equation*}
f(t)= \frac{1}{2 \epsilon},~|t| \le \epsilon
\end{equation*} 
\begin{equation*}
f(t)= 0,~|t| > \epsilon
\end{equation*}
Následující graf zobrazuje funkci pro rœô¡¯zné hodnoty $\epsilon$. 
\begin{center}
	\begin{pspicture}(0,0)(10.0,7.0)
		\rput(5.0,0.0){Tœô ùi œô ­leny limitní œô ùady delta funkce}

		\psline(0.5,1.0)(9.5,1.0)
		\psline(5.0,1.0)(5.0,6.5)

                \psline(1.0,1.0)(3.7,1.0)(3.7,2.5)(6.3,2.5)(6.3,1.0)(9.0,1.0)
                \psline(1.0,1.0)(4.2,1.0)(4.2,4.0)(5.8,4.0)(5.8,1.0)(9.0,1.0)
                \psline[linewidth=0.5mm](1.0,1.0)(4.7,1.0)(4.7,6.0)(5.3,6.0)(5.3,1.0)(9.0,1.0)

                \psline[arrows=<->](4.7,0.7)(5.3,0.7)
                \psline[arrows=<->](3.2,1.0)(3.2,6.0)

                \rput(5.0,0.5){\tiny{$2\epsilon$}}
                \rput(2.9,3.5){\tiny{$\frac{1}{2 \epsilon}$}}

                \rput(9.5,0.7){\small{t}}

	\end{pspicture}
\end{center}
S tím, jak klesá $\epsilon$, se funkce stává vyœô¡¡œô¡¡í a uœô¡¾œô¡¡í. Je zœô ùejmé, œô¡¾e celková vıplata generovaná uvaœô¡¾ovanou investicí je
\begin{equation*}
\int^{\infty}_{-\infty}f(t)dt
\end{equation*}
Tento integrál je roven jedné bez ohledu na hodnotu $\epsilon$, avœô¡¡ak pro vœô¡¡echna $t \neq 0$ se $f(t)$ blíœô¡¾í hodnotœô » nula s tím jak $\epsilon \rightarrow 0$. Tímto zpœô¡¯sobem lze neformálnœô » definovat delta funkce $\delta(t)$ - pro $\epsilon \rightarrow 0$ se jedná o ``limitu'' libovolné jednoparametrové ``rodiny'' funkcí $\delta_{\epsilon}(t)$ s následujícími vlastnostmi
\begin{itemize}
\item $\delta_{\epsilon}(t)$ je po œô ­ástech hladká pro libovolné $\epsilon$
\item $\int^{\infty}_{-\infty} \delta_{\epsilon}(t)dt = 1$
\item $\underset{\epsilon \rightarrow 0} {\lim} \delta_{\epsilon}(t) = 0$ pro vœô¡¡echna $t \neq 0$
\end{itemize}
Takováto œô ùada funkcí se nazıvá delta œô ùada. Vıœô¡¡e popsaná funkce $f(t)$ je jednou z nich. Dalœô¡¡í je napœô ù. funkce
\begin{equation*}
\delta_{\epsilon}(x) = \frac{1}{2 \sqrt{\pi \epsilon}}e^{-\frac{x^2}{4 \epsilon}}
\end{equation*}
která namísto nezávislé veliœô ­iny $t$ pouœô¡¾ívá veliœô ­inu $x$. Jesliœô¡¾e nahradíme $\epsilon$ veliœô ­inou $\tau$, dostáváme rovnici (4.2). Lze dokázat, œô¡¾e tato rovnice má integrál roven jedné a œô¡¾e, podobnœô » jako $f(t)$, je rovna nule pro $x \neq 0$ a $\epsilon \rightarrow 0$. Pro $x = 0$ a $\epsilon \rightarrow 0$ roste její hodnota k nekoneœô ­nu.

Je-li $\phi(x)$ hladkou funkcí, platí
\begin{equation*}
\int^{\infty}_{-\infty}\delta(x)\phi(x)dx = \underset{\epsilon \rightarrow 0}\lim \int^{\infty}_{-\infty} \delta_{\epsilon}(x)\phi(x)dx = \phi(0)
\end{equation*}
Vıœô¡¡e uvedenı vztah definuje delta funkci jako spojitou lineární mapu z hladké funkce $\phi(x)$ do mnoœô¡¾iny reálnıch œô ­ísel, konkrétnœô » do hodnoty $\phi(0)$. Je zœô ùejmé, œô¡¾e pro libovolné $a,b > 0$ platí
\begin{equation*}
\int^b_{-a} \delta{x}\phi{x}dx = \phi(0)
\end{equation*}
a pro livolné $x_0$ platí
\begin{equation*}
\int^{\infty}_{-\infty}\delta(x - x_0)\phi(x)dx = \phi(x_0)
\end{equation*}
Násobením $\phi$ œô ­lenem $\delta(x - x_0)$ a následnım integrováním, tak ``vybereme'' hodnotu funkce $\phi$ v bodœô » $x_0$. Dále platí
\begin{equation*}
\int^x_{-\infty}\delta(s)ds = H(x)
\end{equation*}
kde $H(x)$ je tzv. stranová funkce definovaná jako
\begin{equation*}
H(x) = 0,~x < 0
\end{equation*}
\begin{equation*}
H(x) = 1,~x \ge 0
\end{equation*}
Inverznœô » lze delta funkci definovat ze stranové funkce.
\begin{equation*}
H'(x) = \delta(x)
\end{equation*}
Vıœô¡¡e uvedenı vztah také ilustruje, œô¡¾e derivace funkce, která je v urœô ­itém bodœô » z dœô¡¯vodu ``skoku'' nespojitá, je v tomto dobœô » rovna souœô ­inu delty funkce a pœô ùísluœô¡¡ného ``skoku''.

\section{Poœô ­áteœô ­ní podmínky}

\subsection{Poœô ­áteœô ­ní podmínky a koneœô ­nı interval}

Pœô ùepokládejme, œô¡¾e chceme vyœô ùeœô¡¡it diferenciální rovnici
\begin{equation*}
\frac{\partial u}{\partial r} = \frac{\partial^2 u}{\partial x^2}
\end{equation*}
pœô ùedstavující œô¡¡íœô ùení tepla v tyœô ­i o délce $2L$ pro koneœô ­nı interval $-L < x < L$ a $\tau > 0$.

Je zœô ùejmé, œô¡¾e nejprve musíme specifikovat poœô ­áteœô ­ní teplotu $u(x, 0) = u_0(x)$ pro $-L < x < L$. Dále se zdá rozumné pœô ùepodkládat, œô¡¾e pro stanovení hodnoty $u(x, \tau)$ staœô ­í, budeme-li znát (a) teplotu na obou koncích tyœô ­e nebo (b) tepelné toky na tœô »chto koncích. Tomu odpovídá matematickı zápis
\begin{equation*}
u(-L, \tau) = g_-(\tau),~u(L, \tau)=g_+(\tau)
\end{equation*}
resp.
\begin{equation*}
-\frac{\partial u}{\partial x}(-L, \tau) = h_-(\tau),~\frac{\partial u}{\partial x}(L, \tau) = h_+(\tau)
\end{equation*}
V prvním pœô ùípadœô » to tak jsou teploty a v druhém pœô ùípadœô » teplné toky, které jsou definované pro $x = -L$ a $x = L$.

\subsection{Poœô ­áteœô ­ní podmínky a nekoneœô ­nı interval}

Nyní uvaœô¡¾ujme, œô¡¾e se teplo œô¡¡íœô ùí v imaginární nekoneœô ­nœô » dlouhé tyœô ­i. Také v tomto pœô ùípadœô » je dœô¡¯leœô¡¾ité definovat, jak se $u$ chová na ``konci'' tyœô ­e, tj. pro $L \rightarrow \pm \infty$. S nekoneœô ­nœô » dlouhou tyœô ­í jsou spojené jisté technické problémy, nicménœô » zjednoduœô¡¡enœô » œô ùeœô ­eno platí, œô¡¾e neroste-li $u$ pœô ùíliœô¡¡ rychle, existuje jednoznaœô ­né œô ùeœô¡¡ení závislé na poœô ­áteœô ­ní hodnotœô » $u_0(x)$. Diferenciální rovnice
\begin{equation}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2} ~~~ -\infty < x < \infty, ~ \tau > 0
\end{equation}
 je tak pro
\begin{equation*}
u(x,0) = u_0(x)
\end{equation*}
a za podmínek
\begin{center}
$u(x, 0)$ je funkce s koneœô ­nım poœô ­tem skokovıch nespojitostí
\end{center}
\begin{equation}
\underset{|x| \rightarrow \infty} \lim u_0(x)e^{-ax^2} = 0 ~~~ a > 0
\end{equation}
\begin{equation}
\underset{|x| \rightarrow \infty} \lim u(x, \tau)e^{-ax^2} = 0 ~~~ a > 0, \tau > 0
\end{equation}
z matematického pohledu správnœô » formulovanım problémem.

\subsection{Poœô ­áteœô ­ní podmínky a semi-koneœô ­nı interval}

V nœô »kterıch pœô ùípadech je interval pro $x$ z jedné strany ohraniœô ­en reálnım œô ­íslem a z druhé strany nekoneœô ­nem, coœô¡¾ vyœô¡¾aduje kombinaci obou vıœô¡¡e popsanıch postupœô¡¯. Tato situace je typická pro bariérové opce. Jestliœô¡¾e chceme napœô ù. vyœô ùeœô¡¡it diferenciální rovnici (4.3) pro $0 < x < \infty$ a $\tau > 0$, je tœô ùeba definovat dostateœô ­nœô » hladkou funkci $u_0(x)$ pro $0 < x < -\infty$, dostateœô ­nœô » hladkou hladkou hraniœô ­ní podmínku $u(0, \tau) = g_0(\tau)$ pro $x = 0$ a ``rœô¡¯stové'' podmínky (4.4) a (4.5) pro $x \rightarrow \infty$. To zaruœô ­uje, œô¡¾e (4.3) je z matematického hlediska správnœô » definovanım problémem.

\ section{Zpœô »tná a dopœô ùedná diferenciální rovnice}

Aœô¡¾ dosud jsme se zabıvali dopœô ùednou diferenciální rovnicí
\begin{equation*}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2}
\end{equation*}
doplnœô »nou o podmínku pro $\tau = 0$. Uvaœô¡¾ujme zpœô »tnou diferenciální rovnici
\begin{equation}
\frac{\partial u}{\partial \tau} = -\frac{\partial^2 u}{\partial x^2}
\end{equation}
odvozenou od dopœô ùedné diferenciální rovnice pomocí substituce $\tau_0 - \tau$, kde $\tau_0$ pœô ùedstavuje konstantu. Jestliœô¡¾e bychom chtœô »li œô ùeœô¡¡it tuto rovnici na mnoœô¡¾inœô » stejnıch podmínek jako v pœô ùípadœô » dopœô ùedné diferenciální rovnice, zjistili bychom, œô¡¾e není z matematického pohledu správnœô » definovanım problémem. Ve vœô »tœô¡¡inœô » pœô ùípadœô¡¯ by totiœô¡¾ tento problém nemœô »l œô ùeœô¡¡ení a pokud by existovala taková funkce $u$, konvergovala by její hodnota v koneœô ­ném œô ­ase k nekoneœô ­nu. Dobrım pœô ùíkladem je fundamentální œô ùeœô¡¡ení difúzní rovnice (4.2). V œô ­ase $\tau_0$ má œô ùeœô¡¡ení tvar
\begin{equation*}
\frac{1}{2\sqrt{\pi \tau_0}}e^{-\frac{x^2}{4 \tau_0}}
\end{equation*}
Jestliœô¡¾e tuto rovnici pouœô¡¾ijeme jako poœô ­áteœô ­ní podmínku $u_0(x)$ pro rovnici (4.6), má œô ùeœô¡¡ení tvar
\begin{equation*}
\frac{1}{2\sqrt{\pi (\tau_0 - \tau)}}e^{-\frac{x^2}{4 (\tau_0 - \tau)}}
\end{equation*}
Vıœô¡¡e uvedená rovnice se stává singulární pro $\tau = \tau_0$, kdy je rovna delta funkci $\delta(x)$. Navíc tato funkce pœô ùestává bıt reálnou pro $\tau > \tau_0$.

Z fyzikálního pohledu má vıœô¡¡e popsané logicky snadno uchopitelnou interpretaci. Dopœô ùedná difúzní rovnice modeluje œô¡¡íœô ùení tepla z poœô ­áteœô ­ních hodnot. Zpœô »tná difúzní rovnice je naopak o urœô ­ení poœô ­áteœô ­ních hodnot, ze kterıch se vyvinulo koneœô ­né rozdœô »lení tepla a jedná se tedy v porovnání s dopœô ùednou difúzní funkcí o reverzní proces. Dopœô ùedná difúzní rovnice ``vyhlazuje'' pœô¡¯vodní nerovnomœô »rné rozdœô »lení tepla. Naopak zpœô »tná difúzní rovnice odvozuje z pœô¡¯vodnœô » hladkého rozdœô »lení vıchozí nerovnomœô »rné rozdœô »lení tepla v imaginární tyœô ­i. Alternativním pœô ùístupem je chápat dopœô ùednou difúzní rovnici jako proces, v rámci kterého proudí teplo z œô ­ástí s vyœô¡¡œô¡¡í teplotou do œô ­ástí s niœô¡¾œô¡¡í teplotou. Zpœô »tná difúzní rovnice popisuje modelovou situaci, kdy teplo proudí z chladnœô »jœô¡¡ích œô ­ástí imaginární tyœô ­e do teplejœô¡¡ích œô ­ástí tyœô ­e. Studené œô ­ásti imaginární tyœô ­e se tak stávají jeœô¡¡tœô » studenœô »jœô¡¡ími zatímco teplota teplejœô¡¡ích œô ­ástí mœô¡¯œô¡¾e v rámci modelu rœô¡¯st aœô¡¾ k nekoneœô ­nu.

Navzdory vıœô¡¡e œô ùeœô ­enému je moœô¡¾né, aby byl problém (4.6) z matematického hlediska správnœô » definován. Je tak moœô¡¾né œô ùeœô¡¡it (4.6) pro $0 < \tau < \tau_0$ a dané $u(\tau_0)$. Dœô¡¯kaz lze provést pœô ùevedením (4.6) na dopœô ùednou difúzní rovnici pomocí substituce $\tau_0 - \tau$ za $\tau$. 

\chapter{Rovnice Black-Scholes modelu}

\section{Podobnostní œô ùeœô¡¡ení}

œô øeœô¡¡ení $u(x, \tau)$ parciální diferenœô ­ní rovnice mœô¡¯œô¡¾e spoleœô ­nœô » s poœô ­áteœô ­ními a hraniœô ­ními podmínkami záviset na urœô ­ité kombinaci nezávislıch promœô »nnıch $x$ a $\tau$. V tomto pœô ùípadœô » je moœô¡¾né problém vyjádœô ùit jako klasickou diferenciální rovnici, kde jedinou nezávislou promœô »nnou je uvaœô¡¾ovaná kombinace. œô øeœô¡¡ení této klasické diferenciální rovnice pak nazıváme podobnostním œô ùeœô¡¡ením ve vztahu k pœô¡¯vodní parciální diferenœô ­ní rovnici. Matematická argumentace obhajující existenci takovéhoto œô ùeœô¡¡ení pœô ùekraœô ­uje rámec této knihy. Problematika je œô ­ásteœô ­nœô » osvœô »tlena v technické poznámce této kapitoly.\\

\noindent \textbf{Pœô ùíklad:} Pœô ùedpokládejme, œô¡¾e $u(x, \tau)$ splœô èuje pariciální diferenœô ­ní rovnici pro $x > 0$
\begin{equation}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2}, ~~ x > 0, \tau > 0
\end{equation}
pœô ùi poœô ­áteœô ­ní podmínce
\begin{equation}
u(x, 0) = 0
\end{equation}
a hraniœô ­ních podmínkách
\begin{equation}
u(0, \tau) = 1, ~~ x = 0
\end{equation}
\begin{equation}
u(x, \tau) \rightarrow 0, ~~ x \rightarrow 0
\end{equation}
Rovnice (5.1) modeluje œô¡¡íœô ùení tepla v dlouhé tyœô ­i. Poœô ­áteœô ­ní teplota je nulová, pœô ùiœô ­emœô¡¾ následnœô » je teplota na jednom konci tyœô ­e náhle zvıœô¡¡ena na jedna a udrœô¡¾ována na této hodnotœô ». Dle argumentœô¡¯ uvedenıch v technické poznámce hledáme œô ùeœô¡¡ení, pro které je $u(x, \tau)$ závislé na $x$ a $\tau$ skrze kombinaci $\xi = x / \sqrt{\tau}$ a tudíœô¡¾ $u(x, \tau) = U(\xi)$. Derivováním lze dokázat, œô¡¾e platí
\begin{equation*}
\frac{\partial u}{\partial \tau} = \frac{\partial U}{\partial \xi}\frac{\partial \xi}{\partial \tau}
\end{equation*}
\begin{equation*}
\frac{\partial u}{\partial \tau} = -\frac{1}{2 \tau} \xi \frac{\partial U}{\partial \xi}
\end{equation*}
a
\begin{equation*}
\frac{\partial^2 u}{\partial x^2} = \frac{\partial \frac{\partial u}{\partial x}}{\partial x}
\end{equation*}
\begin{equation*}
\frac{\partial^2 u}{\partial x^2} = \frac{\partial \frac{\partial U}{\partial \xi}\frac{\partial \xi}{\partial x}}{\partial \xi}\frac{\partial \xi}{\partial x}
\end{equation*}
\begin{equation*}
\frac{\partial^2 u}{\partial x^2} = \frac{\partial^2 U}{\partial \xi^2}\bigg( \frac{\partial \xi}{\partial x}\bigg)^2
\end{equation*}
\begin{equation*}
\frac{\partial^2 u}{\partial x^2} = \frac{1}{\tau}\frac{\partial^2 U}{\partial \xi^2}
\end{equation*}
Dosazením do pœô¡¯vodní diferenciální rovnice (5.1), tak získáváme
\begin{equation*}
\frac{\partial^2 U}{\partial \xi^2} - \frac{1}{2} \xi \frac{\partial U}{\partial \xi} = 0
\end{equation*}
Podmínky (5.2), (5.3) a (5.4) se pœô ùetransformují do podoby
\begin{equation}
U(0) = 1, ~~ U(\infty) = 0
\end{equation}
pœô ùiœô ­emœô¡¾ druhá z rovnic zahrnuje podmínku (5.2) a (5.4). Pomocí separace promœô »nnıch je moœô¡¾né získat œô ùeœô¡¡ení pro $U'(\xi)$.
\begin{equation*}
U''(\xi) = -\frac{1}{2}\xi U'(\xi)
\end{equation*}
\begin{equation*}
\frac{1}{U'(\xi)} U''(\xi)= -\frac{1}{2}\xi
\end{equation*}
\begin{equation*}
\int \frac{1}{U'(s)} U''(s) ds = -\frac{1}{4}\xi^2 + c
\end{equation*}
\begin{equation*}
\int \frac{1}{U'(s)} d U'(s) = -\frac{1}{4}\xi^2 + c
\end{equation*}
\begin{equation*}
\ln U'(\xi) = -\frac{1}{4}\xi^2 + c
\end{equation*}
\begin{equation*}
U'(\xi) = Ce^{-\frac{1}{4}\xi^2}
\end{equation*}
Následnım integrováním vırazu
\begin{equation*}
U(\xi) = C \int^{\xi}_0 e^{-\frac{s^2}{4}}ds + D
\end{equation*}
s vyuœô¡¾itím vztahu $\int^{\xi}_0 = \int^{\infty}_0 - \int^{\infty}_{\xi}$ a standardní rovnice
\begin{equation*}
\int^{\infty}_0 e^{-\frac{s^2}{4}}ds = \sqrt{\pi}
\end{equation*}
získáme
\begin{equation*}
U(\xi) = C \bigg(\sqrt{\pi}  - \int^{\infty}_{\xi} e^{-\frac{s^2}{4}}ds \bigg) + D
\end{equation*}
S pomocí hraniœô ­ních podmínek (5.5) lze urœô ­it hodnotu konstanty $D$
\begin{equation*}
U(0) = C(\sqrt{\pi} - \sqrt{\pi}) + D = 1
\end{equation*}
\begin{equation*}
D = -1
\end{equation*}
a $C$
\begin{equation*}
U(0) = C(\sqrt{\pi} - 0) - 1 = 0
\end{equation*}
\begin{equation*}
C = \frac{1}{\sqrt{\pi}}
\end{equation*}
Vıslednı tvar $U(\xi)$ je tedy
\begin{equation*}
U(\xi) = \frac{1}{\sqrt{\pi}} \int^{\infty}_{\xi} e^{-\frac{s^2}{4}}ds
\end{equation*}
a tvar $u(x,\tau)$ pak
\begin{equation*}
U(\xi) = \frac{1}{\sqrt{\pi}} \int^{\infty}_{x /\sqrt{\tau}} e^{-\frac{s^2}{4}}ds
\end{equation*}
Lze snadno ovœô »œô ùit, œô¡¾e tato rovnice splœô èuje definici problému (5.1) aœô¡¾ (5.4) a œô¡¾e tím pádem œô ùeœô¡¡ení závisí pouze na $\frac{x}{\sqrt{\tau}}$.\\

\noindent \textbf{Pœô ùíklad:} V tomto pœô ùíkladœô » odvodíme fundamentální œô ùeœô¡¡ení pro $u_{\delta}(x, \tau)$. Nechœô¡¥
\begin{equation*}
u_{\delta}(x, \tau) = \tau^{-\frac{1}{2}}U(\xi)
\end{equation*}
kde opœô »t
\begin{equation*}
\xi = \frac{x}{\sqrt{\tau}}
\end{equation*}
œô ¬len $\tau^{-\frac{1}{2}}$ má zajistit, œô¡¾e $\int^{\infty}_{-\infty}u_{\delta}(x,\tau)dx$ je konstatní pro vœô¡¡echna $\tau$, coœô¡¾ lze dokázat pœô ùímım vıpoœô ­tem. Postupnımi úpravami získáme
\begin{equation*}
\frac{\partial u_{\delta}}{\partial \tau} = \frac{\partial \tau^{\frac{1}{2}U_{\delta}}}{\partial \tau}
\end{equation*}
\begin{equation*}
\frac{\partial u_{\delta}}{\partial \tau} = -\frac{1}{2}\tau^{-\frac{3}{2}}U_{\delta} - \frac{1}{2}\tau^{-\frac{1}{2}} \xi \frac{\partial U_{\delta}}{\partial \xi}\frac{\partial \xi}{\partial \tau}
\end{equation*}
\begin{equation*}
\frac{\partial u_{\delta}}{\partial \tau} = -\frac{1}{2}\tau^{-\frac{3}{2}}U_{\delta} - \frac{1}{2}\tau^{-\frac{3}{2}} \xi \frac{\partial U_{\delta}}{\partial \xi}
\end{equation*}
\begin{equation*}
\frac{\partial u_{\delta}}{\partial \tau} = -\frac{1}{2}\tau^{-\frac{3}{2}} \bigg( U_{\delta} + \xi \frac{\partial U_{\delta}}{\partial \xi} \bigg)
\end{equation*}
\begin{equation*}
\frac{\partial u_{\delta}}{\partial \tau} = -\frac{1}{2}\tau^{-\frac{3}{2}} \frac{\partial \xi U_{\delta}}{\partial \xi}
\end{equation*}
resp.
\begin{equation*}
\frac{\partial^2 u_{\delta}}{\partial x^2} = \tau^{-\frac{1}{2}}\frac{\frac{\partial U_{\delta}}{\partial \xi} \frac{\partial \xi}{\partial x}}{\partial \xi} \frac{\partial \xi}{\partial x}
\end{equation*}
\begin{equation*}
\frac{\partial^2 u_{\delta}}{\partial x^2} = \tau^{-\frac{1}{2}}\frac{\partial^2 U_{\delta}}{\partial \xi^2} \bigg( \frac{\partial \xi}{\partial x} \bigg)^2
\end{equation*}
\begin{equation*}
\frac{\partial^2 u_{\delta}}{\partial x^2} = \tau^{-\frac{3}{2}}\frac{\partial^2 U_{\delta}}{\partial \xi^2}
\end{equation*}
Protoœô¡¾e vıchozí difúzní rovnice má stejnœô » jako v pœô ùedchozím pœô ùíkladœô » tvar
\begin{equation*}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2}, ~~ x > 0, \tau > 0
\end{equation*}
budeme hledat œô ùeœô¡¡ení diferenciální rovnice
\begin{equation}
\frac{\partial^2 U_{\delta}}{\partial \xi^2} + \frac{1}{2}\frac{\partial \xi U_{\delta}}{\partial \xi} = 0
\end{equation}
Integrováním této rovnice pœô ùes $\xi$ sníœô¡¾íme její œô ùád o jeden stupeœô è.
\begin{equation*}
\frac{\partial U_{\delta}}{\partial \xi} + \frac{1}{2} \xi U_{\delta} + d = 0
\end{equation*}
Diferenciální rovnice
\begin{equation*}
\frac{\partial U_{\delta}}{\partial \xi} + \frac{1}{2} \xi U_{\delta} = 0
\end{equation*}
má stejnœô » jako v prvním pœô ùíkladœô » œô ùeœô¡¡ení
\begin{equation*}
U_{\delta} = Ce^{-\frac{1}{4}\xi^2}
\end{equation*}
Vıslednı tvar œô ùeœô¡¡ení rovnice (5.6) má tedy podobu
\begin{equation*}
U_{\delta}(\xi) = Ce^{-\frac{1}{4}\xi^2} + D
\end{equation*}
Zvolíme-li $D=0$ a znormujeme-li œô ùeœô¡¡ení pomocí $C = \frac{1}{2\sqrt{\pi}}$, tak aby platilo
\begin{equation*}
\int^{\infty}_{-\infty}u_{\delta} dx = 1
\end{equation*}
získáme fundamentální œô ùeœô¡¡ení
\begin{equation*}
u_{\delta}(x, \tau) = \frac{1}{2\sqrt{\pi \tau}}e^{-\frac{x^2}{4 \tau}}
\end{equation*}
coœô¡¾ odpovídá rovnici (4.2).

\section{Technická poznámka: Invariance a podobnostní œô ùeœô¡¡ení}

Klíœô ­em k podobnostnímu œô ùeœô¡¡ení je, œô¡¾e jak diferenciální rovnice tak poœô ­áteœô ­ní a hraniœô ­ní podmínky jsou invariantní pro $x \mapsto \lambda x$ a $\tau \mapsto \lambda^2 \tau$, kde $\lambda$ je libovolné reálné œô ­íslo. Tato transformace se nazıvá jednoparametrovou grupovou transformací a její invarianci je moœô¡¾né ovœô »œô ùit pomocí novıch promœô »nnıch $X = \lambda x$ a $T = \lambda^2 \tau$, kde funkce $u$ splœô èuje podmínku
\begin{equation*}
\frac{\partial u}{\partial T} = \frac{\partial^2 u}{\partial X^2}
\end{equation*}
V prvním z pœô ùíkladœô¡¯ uvádœô »nıch v pœô ùedchozí kapitole se podmínky pœô ùestransformují do podoby $u(X,0)=0$ a $u(0,T)=1$ pro libovolné $\lambda$. Navíc $\frac{x}{\sqrt{\tau}} = \frac{X}{\sqrt{T}}$ je jedinou kombinací $X$ a $T$, která není funkcí $\lambda$ a œô ùeœô¡¡ení je tak závislé pouze na $\frac{x}{\sqrt{\tau}}$. Pro pouœô¡¾itelnost metody podobnostního œô ùeœô¡¡ení je nezbytné, aby diferenciální rovnice a poœô ­áteœô ­ní a hraniœô ­ní podmínky byly invariantní pro vıœô¡¡e uvaœô¡¾ovanou transformaci. V druhém z pœô ùíkladœô¡¯ pœô ùedchozí kapitoly funkce promœô »nné $\tau$, v tomto konkrétním pœô ùípadœô » se jednalo o funkci $\tau^{-\frac{1}{2}}$, násobí funkci $U_{\delta}(\xi)$, protoœô¡¾e difúzní rovnice je vzhledem ke své linearitœô » také invariantní pro jednoparametrovou grupu $u \mapsto \mu u$. Dobrım praktickım testem pro nalezení podobnostního œô ùeœô¡¡ení je vyzkouœô¡¡et $u = \tau^{\alpha} f(x/ \tau^{\beta})$ v nadœô »ji, œô¡¾e $x$ a $\tau$ zœô¡¯stanou v rovnicích pouze pro kombinaci $\xi = x/ \tau^{\beta}$. V prvním z pœô ùíkladœô¡¯ pœô ùedchozí kapitoly je vısledkem uplatnœô »ní tohoto postupu $\alpha = 0$ získané z hraniœô ­ní podmínky v $x = 0$ a $\beta = \frac{1}{2}$ získané z difúzní rovnice. V druhém pœô ùíkladœô » vychází $\alpha = -\frac{1}{2}$, protoœô¡¾e chceme, aby byl intergrál funkce $u(x, \tau)$ pœô ùes $x$ nezávislı na $\tau$, a $\beta$ je opœô »t rovno $\frac{1}{2}$.

\section{Problém poœô ­áteœô ­ní podmínky a difúzní rovnice}

Fundamentální œô ùeœô¡¡ení difúzní rovnice je moœô¡¾né pouœô¡¾ít pro odvození explicitního œô ùeœô¡¡ení problému definovaného rovnicemi (4.3) - (4.5). V rámci tohoto problému œô ùeœô¡¡íme difúzní rovnici pro $-\infty < x < \infty$ a $\tau > 0$ za podmínky $u(x, 0) = u_0(x)$ a za podmínky "pœô ùijatelného" rœô¡¯stu pro $x = \pm \infty$. Klíœô ­em k œô ùeœô¡¡ení je skuteœô ­nost, œô¡¾e poœô ­áteœô ­ní data je moœô¡¾né vyjádœô ùit ve tvaru
\begin{equation*}
u_0(x) = \int^{\infty}_{-\infty}u_0(\xi)\delta(\xi - x)d\xi
\end{equation*}
kde $\delta(\cdot)$ je delta funkcí. Pœô ùipomeœô ème, œô¡¾e fundamentální œô ùeœô¡¡ení difúzní rovnice
\begin{equation*}
u_{\delta}(s, \tau) = \frac{1}{2 \sqrt{\pi \tau}}e^{-\frac{s^2}{4 \tau}}
\end{equation*}
má poœô ­áteœô ­ní hodnotu $u_{\delta}(s,0) = \delta(s)$. Protoœô¡¾e $u_{\delta}(s-x,\tau) = u_{\delta}(x-s, \tau)$ je pœô ùi pouœô¡¾ití $x$ popœô ù. $s$ jako nezávislé veliœô ­iny funkce
\begin{equation*}
u_{\delta}(s-x, \tau) = \frac{1}{2 \sqrt{\pi \tau}}e^{-\frac{(s-x)^2}{4 \tau}}
\end{equation*}
œô ùeœô¡¡ením difúzní rovnice s poœô ­áteœô ­ní hodnotou $u_{\delta}(s-x,0) = \delta(s-x)$. Pro libovolnou konstantu $s$ tedy funkce
\begin{equation*}
u_0(s)u_{\delta}(s-x, \tau)
\end{equation*}
promœô »nnıch $x$ a $\tau$ splœô èuje difúzní rovnici $\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2}$ a má poœô ­áteœô ­ní hodnotu $u_0(s)\delta(s-x)$. Vzhledem k tomu, œô¡¾e je difúzní rovnice lineární, je moœô¡¾né jednotlivá œô ùeœô¡¡ení skládat pomocí superpozice. Pokud tak uœô ­iníme integrováním pœô ùes $s$ pro $-\infty < s < \infty$, získáme œô ùeœô¡¡ení difúzní rovnice
\begin{equation}
u(x, \tau) = \frac{1}{2 \sqrt{\pi \tau}} \int^{\infty}_{-\infty} u_0(s)e^{-\frac{(x-\tau)^2}{4 \tau}}
\end{equation}
s poœô ­áteœô ­ní hodnotou
\begin{equation*}
u(x,0) = \int^{\infty}_{-\infty}u_0(s)\delta(s-x)ds = u_0(x).
\end{equation*}
Vıœô¡¡e uvedená rovnice je tedy hledanım explicitním œô ùeœô¡¡ením problému definovaného rovnicemi (4.3) - (4.5). Lze dokázat, œô¡¾e toto œô ùeœô¡¡ení je jedineœô ­né. Vıœô¡¡e uvedenı postup není jedinı, jak lze odvodit toto œô ùeœô¡¡ení - alternativu pœô ùedstavuje Fourierova transformace.

Rovnice (5.7) má následující fyzikální interpretaci. Pœô ùipomeœô ème, œô¡¾e fundamentální œô ùeœô¡¡ení difúzní rovnice popisuje œô¡¡íœô ùení tepla z vıchozího tepelného bodu, kdy v œô ­ase $\tau = 0$ je vœô¡¡echno teplo koncentrováno v poœô ­átku. Matematicky je tento bod vyjádœô ùen pomocí delta funkce. Nyní uvaœô¡¾ujme poœô ­áteœô ­ní tepelné rozdœô »lení $u_0(x)$, které skládá z œô ùady teplenıch bodœô¡¯, pœô ùiœô ­emœô¡¾ tepelnı bod v $x = s$ má hodnotu $u_0(s)ds$. Z kaœô¡¾dého bodu se œô¡¡íœô ùí teplo - vısledné tepelné rozdœô »lení tak odpovídá fundamentálnímu œô ùeœô¡¡ení vynásobenému $u_0(s)$ s $x$ nahrazenım $x-s$. Protoœô¡¾e je difúzní rovnice lineární, lze vısledné tepelné rozdœô »lení získat superpozicí jednotlivıch bodœô¡¯. V limitœô » je pak tento souœô ­et nahrazen integrálem (5.7).

\section{œô øeœô¡¡ení diferenciální rovnice Black-Scholes modelu}

Diferenciální rovnice Black-Scholes modelu a podmínky pro evropskou kupní opci s hodnotou $C(S,t)$, jsou
\begin{equation}
\frac{\partial C}{\partial t} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 C}{\partial S^2} + rS \frac{\partial C}{\partial S} - rC = 0
\end{equation}
\begin{equation*}
C(0,t) = 0, ~~ C(S \rightarrow \infty,t) \sim S
\end{equation*}
\begin{equation*}
C(S,T) = \max(S-E,0)
\end{equation*}
Rovnice (5.8) na první pohled nepœô ùipomíná difúzní rovnici a navíc se jedná zpœô »tnou diferenciální rovnici s ``koneœô ­nou'' podmínkou stanovenou pro $t = T$. Definujme
\begin{equation*}
S = Ee^x, ~~ t = T - \frac{\tau}{\frac{1}{2}\sigma^2}, ~~ C = Ev(x, \tau)
\end{equation*}
Postupnımi úpravami jednotlivıch œô ­lenœô¡¯ rovnice (5.8) získáme
\begin{equation*}
\frac{\partial C(S,t)}{\partial t} = \frac{Ev(x, \tau)}{\partial \tau}\frac{\partial \tau}{\partial t} = E \frac{\partial v(x,\tau)}{\partial \tau} \frac{1}{\frac{\partial t}{\partial \tau}} = -\frac{1}{2}\sigma^2 E \frac{\partial v(x, \tau)}{\partial \tau}
\end{equation*}
\begin{equation*}
\frac{1}{2}\sigma^2 S^2 \frac{\partial^2 C(S,t)}{\partial S^2} = \frac{1}{2}\sigma^2 E^2 ( e^x)^2 \frac{\frac{E v(x, \tau)}{\partial x} \frac{1}{\frac{\partial S}{\partial x}}}{\partial x} \frac{1}{\frac{\partial S}{\partial x}} = \frac{1}{2}\sigma^2E \bigg( \frac{\partial^2 v}{\partial x^2} - \frac{\partial v}{\partial x} \bigg)
\end{equation*}
\begin{equation*}
rS\frac{\partial C(S,t)}{\partial S} = r E e^x \frac{\partial E v(x,\tau)}{\partial x} \frac{1}{\frac{\partial S}{\partial x}} = r E \frac{\partial v(x, \tau)}{\partial x}
\end{equation*}
\begin{equation*}
rC(S,t) = rEv(x, \tau)
\end{equation*}
Vısledná rovnice má tedy po vıœô¡¡e uvedenıch úpravách tvar
\begin{equation}
\frac{\partial v}{\partial \tau} = \frac{\partial^2 v}{\partial x^2} + (k - 1)\frac{\partial v}{\partial x} - kv
\end{equation}
kde $k = \frac{r}{\frac{1}{2}\sigma^2}$. Vzhledem k tomu, œô¡¾e $\tau = 0$ pro $t = T$, pœô ùetransformuje se ``koneœô ­ná'' podmínka do podoby poœô ­áteœô ­ní podmínky
\begin{equation*}
v(x,0) = \max(e^x - 1,0)
\end{equation*}

Rovnice (5.9) obsahuje na první pohled pouze jeden bezrozmœô »rnı parametr $k = \frac{r}{\frac{1}{2}\sigma^2}$, aœô ­koliv v pœô¡¯vodní rovnici figurovaly œô ­tyœô ùi rozmœô »rové veliœô ­iny, tj. $E$, $T$, $\sigma^2$ a $r$. Ve skuteœô ­nosti v (5.9) figuruje jeœô¡¡tœô » bezrozmœô »rnı parametr $\frac{1}{2}\sigma^2T$, kterı pœô ùedstavuje bezrozmœô »rnı œô ­as do splatnosti. Tyto dva bezrozmœô »rné parametry jsou jediné nezávislé parametry problému (4.3) - (4.5). Ostatní parametry byly "zavleœô ­eny" v prœô¡¯bœô »hu transformace pœô¡¯vodního problému, tj. œô ùadou souslednıch aritmetickıch operací.

Rovnice (5.9) nyní mnohem více pœô ùipomíná difúzní rovnici, na kterou je jí pœô ùevést pouhou zmœô »nou veliœô ­iny. Pouœô¡¾ijeme-li substituci
\begin{equation*}
v = e^{\alpha x + \beta \tau}u(x, \tau)
\end{equation*}
získáme derivováním (5.9) vztah
\begin{equation*}
\beta u + \frac{\partial u}{\partial \tau} = \alpha^2 u + 2 \alpha \frac{\partial u}{\partial x} + \frac{\partial^2 u}{\partial x^2} + (k - 1)\bigg( au + \frac{\partial u}{\partial x} \bigg) - ku
\end{equation*}
Funkci $u$ je moœô¡¾né eliminovat, jestliœô¡¾e zvolíme $\beta = \alpha^2 + (k - 1)\alpha - k$. Podobnœô » je moœô¡¾né se zbavit $\frac{\partial u}{\partial x}$, platí-li $2\alpha + (k - 1) = 0$. œô øeœô¡¡ením tœô »chto dvou rovnic získáváme
\begin{equation*}
\alpha = -\frac{1}{2}(k - 1), ~~ \beta = -\frac{1}{4}(k + 1)^2
\end{equation*}
Platí tedy
\begin{equation*}
v = e^{-\frac{1}{2}(k - 1)x - \frac{1}{4}(k + 1)^2 \tau}u(x, \tau)
\end{equation*}
kde
\begin{equation*}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2},~~ -\infty < x < \infty,~ \tau > 0
\end{equation*}
s podmínkou
\begin{equation}
u(x, 0) = u_0(x) = \max \bigg( e^{\frac{1}{2}(k-1)x} - e^{\frac{1}{2}(k+1)x}, 0 \bigg)
\end{equation}
Tímto ponœô »kud zdlouhavım zpœô¡¯sobem jsme se dobrali rovnice pro vıplatu evropské kupní opce. œô øeœô¡¡ením difúzní rovnice je (5.7)
\begin{equation}
u(x, \tau) = \frac{1}{2\sqrt{\pi \tau}} \int^{\infty}_{-\infty} u_0(s)e^{-\frac{(x-\tau)^2}{4 \tau}} ds
\end{equation}
kde $u_0(x)$ je dáno rovnicí (5.10).

Nyní pouze zbıvá upravit intergrál (5.11). Nejprve provedeme substituci
\begin{equation}
x' = \frac{s-x}{\sqrt{2 \tau}}
\end{equation}
která nám vıchozí rovnici (5.11) upraví do podoby
\begin{equation}
u(x, \tau) = \frac{1}{\sqrt{2 \pi}}\int^{\infty}_{-\infty}u_0(x'\sqrt{2 \tau} + x)e^{-\frac{1}{2}{x'}^2} dx'
\end{equation}
Protoœô¡¾e $k \ge 0$\footnote{Pœô ùipomeœô èmœô », œô¡¾e $k = \frac{r}{\frac{1}{2}\sigma^2}$. Parametr $k$ by tak mohl bıt zápornı pouze v pœô ùípadœô » záporné bezrizikové úrokové sazby.}, platí s ohledem na (5.10)
\begin{equation*}
u_0(x) = e^{\frac{1}{2}(k + 1)x} - e^{\frac{1}{2}(k - 1)x}, ~~ x \ge 0
\end{equation*}
\begin{equation*}
u_0(x) = 0, ~~ x < 0
\end{equation*}
Rovnici (5.13) lze tedy dále upravit do tvaru
\begin{equation*}
u(x, \tau) = \frac{1}{\sqrt{2 \pi}}\int^{\infty}_{-x/\sqrt{2 \tau}}e^{\frac{1}{2}(k + 1)(x + x'\sqrt{2 \tau})}e^{-\frac{1}{2}{x'}^2}dx' - \frac{1}{\sqrt{2 \pi}}\int^{\infty}_{-x/\sqrt{2 \tau}}e^{\frac{1}{2}(k - 1)(x + x'\sqrt{2 \tau})}e^{-\frac{1}{2}{x'}^2}dx'
\end{equation*}
\begin{equation*}
u(x, \tau) = I_1 - I_2
\end{equation*}
V dalœô¡¡ím kroce upravme œô ­len $I_1$.
\begin{equation*}
I_1 = \frac{1}{\sqrt{2 \pi}} \int^{\infty}_{-x/\sqrt{2 \tau}}e^{\frac{1}{2}(k+1)(x + x'\sqrt{2 \tau})-\frac{1}{2}x'^2 dx'}
\end{equation*}
\begin{equation*}
I_1 = \frac{e^{\frac{1}{2}(k+1)x}}{\sqrt{2 \pi}} \int^{\infty}_{-x/\sqrt{2 \tau}}e^{\frac{1}{2}(k + 1)\tau}e^{-\frac{1}{2}(x' - \frac{1}{2}(k + 1)\sqrt{2 \tau})^2}dx'
\end{equation*}
Nyní provedeme substituci $\rho = x' - \frac{1}{2}(k + 1)\sqrt{2 \tau}$ a pokraœô ­ujeme v úpravách.
\begin{equation*}
I_1 = \frac{e^{\frac{1}{2}(k + 1)x + \frac{1}{2}(k + 1)^2 \tau}}{\sqrt{2 \pi}} \int^{\infty}_{-x/\sqrt{2 \tau} - \frac{1}{2}(k+1)\sqrt{2 \tau}}e^{-\frac{1}{2}\rho^2}d \rho
\end{equation*}
Protoœô¡¾e je $e^{-\frac{1}{2}x^2}$ sudou funkcí, platí
\begin{equation*}
\int^{\infty}_{-x/\sqrt{2 \tau} - \frac{1}{2}(k+1)\sqrt{2 \tau}}e^{-\frac{1}{2}\rho^2}d \rho = \int^{x/\sqrt{2 \tau}}_{-\infty} e^{-\frac{1}{2}(k+1)\sqrt{2 \tau}}e^{-\frac{1}{2}\rho^2}d \rho
\end{equation*}
a $I_1$ je tak moœô¡¾né vyjádœô ùit ve formœô »
\begin{equation*}
I_1 = e^{\frac{1}{2}(k+1)x + \frac{1}{4}(k + 1)^2 \tau}N(d_1)
\end{equation*}
kde
\begin{equation*}
d_1 = \frac{x}{\sqrt{2 \tau}} + \frac{1}{2}(k + 1)\sqrt{2 \tau}
\end{equation*}
a
\begin{equation*}
N(d_1) = \frac{1}{\sqrt{2 \tau}}\int^{d_1}_{-\infty}e^{-\frac{1}{2}s^2 ds}
\end{equation*}
pœô ùedstavuje kumulativní distribuœô ­ní funkci normálního rozdœô »lení. Úprava $I_2$ je identická s vıjimkou toho, œô¡¾e $(k + 1)$ je nahrazeno $(k - 1)$.
\begin{equation*}
I_1 = e^{\frac{1}{2}(k - 1)x + \frac{1}{4}(k - 1)^2 \tau}N(d_2)
\end{equation*}
\begin{equation*}
d_2 = \frac{x}{\sqrt{2 \tau}} + \frac{1}{2}(k - 1)\sqrt{2 \tau}
\end{equation*}
Pœô ùipomeœô ème si vıœô¡¡e odvozenou rovnici
\begin{equation*}
v(x, \tau) = e^{-\frac{1}{2}(k - 1)x - \frac{1}{4}(k + 1)^2 \tau}u(x, \tau)
\end{equation*}
a substituce $x = \ln \frac{S}{E}$, $\tau = \frac{1}{2}\sigma^2(T - t)$ a $C = Ev(x,\tau)$. S jejich pomocí lze elemetárními aritmetickımi operacemi odvodit vıslednou rovnici pro hodnotu evropské kupní opce jako
\begin{equation*}
C(S,t) = SN(d_1) - Ee^{-r(T - t)}N(d_2)
\end{equation*}
kde
\begin{equation*}
d_1 = \frac{\ln\frac{S}{E} + (r + \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}}
\end{equation*}
\begin{equation*}
d_2 = \frac{\ln\frac{S}{E} + (r - \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}}
\end{equation*}
Odpovídající rovnici pro evropskou prodejní opci lze snadno odvodit pomocí put-call parity
\begin{equation*}
C - P = S - Ee^{-r(T - t)}
\end{equation*}
a vztahu $N(-d) = 1 - N(d)$. Postupnımi elementárními úpravami získáme
\begin{equation*}
P(S,t) = Ee^{-r(T - t)}N(-d_2) - SN(-d_1)
\end{equation*}
Deltu kupní a prodejní opce lze vypoœô ­íst pomocí derivace. V pœô ùípadœô » evropské kupní opce má delta tvar
\begin{equation*}
\Delta = \frac{\partial C}{\partial S}
\end{equation*}
\begin{equation*}
\Delta = N(d_1) + S \frac{\partial N(d_1)}{\partial S} - Ee^{-r(T-t)}\frac{\partial N(d_1)}{\partial S}
\end{equation*}
\begin{equation*}
\Delta = N(d_1) + S \frac{\partial N(d_1)}{\partial d_1}\frac{\partial d_1}{\partial S} - Ee^{-r(T-t)}\frac{\partial N(d_2)}{\partial d_2}\frac{\partial d_2}{\partial S}
\end{equation*}
\begin{equation*}
\Delta = N(d_1) + \frac{S \frac{\partial N(d_1)}{\partial d_1} - Ee^{-r(T-t)}\frac{\partial N(d_2)}{\partial d_2} \frac{\partial d_2}{\partial S}}{S \sigma \sqrt{T - t}}
\end{equation*}
\begin{equation*}
\Delta = N(d_1)
\end{equation*}
Poslední z vıœô¡¡e uvedenıch úprav vychází ze vztahu
\begin{equation*}
S \frac{\partial N(d_1)}{\partial d_1} = Ee^{-r(T-t)}\frac{\partial N(d_2)}{\partial d_2}
\end{equation*}
Prokázání této rovnosti je vœô¡¡ak pomœô »rnœô » sloœô¡¾ité. Deltu prodejní opce lze odvodit pomocí put-call parity jako
\begin{equation*}
\Delta = N(d_1) - 1
\end{equation*}

\section{Technická poznámka: Bezrozmœô »rné veliœô ­iny}

Diferenciální rovnice modelující fyzikální a finanœô ­ní procesy œô ­asto obsahují mnoho parametrœô¡¯ jako jsou pœô ùímœô »si materiálu a jeho teplotní vodivost nebo konstanty podkladového stochastického modelu (napœô ù. vınosová míra a volatilita). První krokem pœô ùi œô ùeœô¡¡ení tœô »chto rovnic je indexace jejich parametrœô¡¯ pomocí tzv. ``typickıch hodnot'' s cílem sesbírat parametry co nejvíce dohromady. V pœô ùedeœô¡¡lé kapitole jsme parametry $S$ a $V$ indexovali pomocí $E$, coœô¡¾ byla jediná a priori ``typická veliœô ­ina''. Aœô ­koliv je moœô¡¾né $S$ mœô »œô ùit v CZK, EUR œô ­i USD, indexovaná veliœô ­ina $x$ nemœô »la œô¡¾ádné mœô »œô ùítko. To je dœô¡¯leœô¡¾ité vzhledem k tomu, œô¡¾e rozvoj $e^S = 1 + S + \frac{1}{2}S^2 + ...$ postrádá smysl, je-li $S$ rozmœô »rnou veliœô ­inou\footnote{Uvœô »domte si, œô¡¾e aœô ­koliv absolutní zmœô »na $dS$ ceny podkladového aktiva je rozmœô »rnou veliœô ­inou, její relativní zmœô »na $\frac{dS}{S}$ je bezrozmœô »rnou veliœô ­inou.}. Podobnœô » jako $x$ také indexovaná veliœô ­ina $v$ byla bezrozmœô »rná.

Po tomto kroku je moœô¡¾né sesbírat zbıvající parametry do tzv. bezrozmœô »rnıch grup, pro které se pouœô¡¾ívá také oznaœô ­ení bezrozmœô »rné parametry. Tímto zjistíme skuteœô ­nı poœô ­et nezávislıch konstant v hledaném œô ùeœô¡¡ení. Jestliœô¡¾e je hodnota jednoho z vıslednıch bezrozmœô »rnıch parametrœô¡¯ pœô ùíliœô¡¡ velká nebo naopak pœô ùíliœô¡¡ malá, je moœô¡¾né tohoto vyuœô¡¾ít pro pœô ùibliœô¡¾né œô ùeœô¡¡ení. Tuto aproximaci nazıváme asymptotickou expanzí a pœô ùísluœô¡¡nou teorii, která se snaœô¡¾í nalézt techniky pro odvození pœô ùibliœô¡¾nıch œô ùeœô¡¡ení, pak asymptotickou analızou.

V Black-Scholes rovnici jsou parametry $r$ a $\sigma^2$ vztaœô¡¾eny k veliœô ­inœô » \textit{œô ­as}$^{-1}$. Parametry $k = \frac{r}{\frac{1}{2}\sigma^2}$ a $\frac{1}{2}\sigma^2 T$ jsou tak bezrozmœô »rné a jedná se o jediné bezrozmœô »rné parametry základního problému evropské kupní a prodejní opce.

\section{Binární opce}

Aœô ­koliv jsme se aœô¡¾ dosud zabıvali pouze plain-vanilla evropskou kupní a prodejní opcí, vıplatní profil opce byl dœô¡¯leœô¡¾itı aœô¡¾ posledních krocích úpravy. Funkce $u_0(s)$ v rovnici (5.11) mœô¡¯œô¡¾e bıt kombinací libovolnıch opcí. Linearita Black-Scholes rovnice totiœô¡¾ umoœô¡¾œô èuje oceœô èovat portfolia opcí pomocí superpozice. Díky tomu je moœô¡¾né oceœô èovat jednotlivé opœô ­ní strategie jako je napœô ù. straddle nebo stangle. Navíc vısledná vıplata nemusí bıt pouze kombinací evropskıch kupních œô ­i prodejních opcí, ale mœô¡¯œô¡¾eme uvaœô¡¾ovat libovolnou funkci $S$.

Uvaœô¡¾ujme vıplatní funkci $\Lambda(S)$ v œô ­ase $T$ a hodnotu opce $V(S,t)$ v œô ­ase $t$. Platí $V(S,T) = \Lambda(S)$. Nejprve odvodíme funkci $u_0(x)$ odpovídající $\Lambda(S)$ po transformaci, kterou jsme pouœô¡¾ili vıœô¡¡e. To znamená, œô¡¾e poloœô¡¾íme $S = Ee^x$ a $V(S,t) = Ee^{\alpha x + \beta \tau}u(x, \tau)$. Z vıplaty vyplıvá $V(S,T) = \Lambda(S) = Ee^{\alpha x}u_0{x}$. S pomocí rovnice (5.11) je $V(S,t)$ moœô¡¾né vyjádœô ùit jako
\begin{equation}
V(S,t) = \frac{e^{-r(T-t)}}{\sigma \sqrt{2 \pi (T - t)}} \int^{\infty}_{0} \Lambda(S')e^{-\frac{1}{2}\big( \frac{\ln(S'/S)-(r - 1/2 \sigma^2)(T-t)}{\sigma \sqrt{T-t}} \big)^2}\frac{dS'}{S'}
\end{equation}
Rovnice (5.14) zahrnuje mimojiné také evropské plain-vanilla kupní a prodejní opce. Deltu lze odvodit derivací (5.14) dle $S$. Pœô ùi odvozování (5.14) jsme pœô ùedpokládali, œô¡¾e $\sigma$ a $r$ jsou konstanty a œô¡¾e podkladové aktivum negeneruje œô¡¾ádné cash-flow.

Uvaœô¡¾ujme kupní binární opci typu cash-or-nothing. V pœô ùípadœô », œô¡¾e je spotová cena v dobœô » maturity vyœô¡¡œô¡¡í neœô¡¾ realizaœô ­ní cena, vyplácí opce œô ­ástku $H$. V opaœô ­ném pœô ùípadœô » je vıplata nulová. Je-li $\Lambda(S)$ vıplatní funkcí v dobœô » splatnosti opce, platí
\begin{equation*}
\Lambda(S) = B H(S - E)
\end{equation*}
S vyuœô¡¾ítím rovnice (5.14) a vlastností stranové funkce $H(x)$ lze odvodit cenu této opce následujícím zpœô¡¯sobem.
\begin{equation*}
V(S,t) = \frac{e^{-r(T-t)}}{\sigma \sqrt{2 \pi (T - t)}} \int^{\infty}_{0} B H(S' - E)e^{-\frac{1}{2}\big( \frac{\ln(S'/S)-(r - 1/2 \sigma^2)(T-t)}{\sigma \sqrt{T-t}} \big)^2}\frac{dS'}{S'}
\end{equation*}
\begin{equation*}
V(S,t) = \frac{B e^{-r(T-t)}}{\sqrt{2 \pi}} \int^{\infty}_{E} \frac{1}{S' \sigma \sqrt{T - t}}e^{-\frac{1}{2}\big( \frac{\ln(S'/S)-(r - 1/2 \sigma^2)(T-t)}{\sigma \sqrt{T-t}} \big)^2} dS'
\end{equation*}
Aplikujme substituci $\rho = \frac{\ln(S'/S)-(r - 1/2 \sigma^2)(T-t)}{\sigma \sqrt{T-t}}$. Je-li $S' = E$, pak $\rho = \frac{\ln(E/S)-(r - 1/2 \sigma^2)(T-t)}{\sigma \sqrt{T-t}}$. Pro derivaci platí $d \rho = \frac{1}{S' \sigma \sqrt{T - t}} d S'$. Vıœô¡¡e uvednou rovnice lze tedy dále upravit do tvaru
\begin{equation*}
V(S,t) = \frac{B e^{-r(T-t)}}{\sqrt{2 \pi}} \int^{\infty}_{\frac{\ln(E/S)-(r - 1/2 \sigma^2)(T-t)}{\sigma \sqrt{T-t}}}e^{-\frac{1}{2}\rho^2} d\rho
\end{equation*}
Protoœô¡¾e je funkce $e^{-\frac{1}{2}\rho^2}$ sudá, platí
\begin{equation*}
V(S,t) = \frac{B e^{-r(T-t)}}{\sqrt{2 \pi}} \int^{\frac{\ln(S/E)+(r - 1/2 \sigma^2)(T-t)}{\sigma \sqrt{T-t}}}_{-\infty} e^{-\frac{1}{2}\rho^2} d\rho
\end{equation*}
\begin{equation*}
V(S,t) = B e^{-r(T-t)}N(d_2)
\end{equation*}
kde
\begin{equation*}
d_2 = \frac{\ln(S/E)+(r - \frac{1}{2} \sigma^2)(T-t)}{\sigma \sqrt{T-t}}
\end{equation*}

Aœô ­koliv je ocenœô »ní binární opce relativnœô » snadné, je pomœô »rnœô » sloœô¡¾ité tuto opci zajistit tœô »snœô » pœô ùed jejich splatností. To je zpœô¡¯sobeno nespojitostí vıplatní funkce. Diferencováním funkce $H(S-E)$ vzhledem k $S$ zjistíme, œô¡¾e s $t \rightarrow T$ se delta této opce blíœô¡¾í $B \delta(S -E)$. Mimo bod $S = E$ je tato funkce rovna nule. Jesliœô¡¾e se tedy $S$ nachází v okolí $E$, je vysoká pravdœô »podobnost, œô¡¾e cena v prœô¡¯bœô »hu zbytkové splatnosti protne realizaœô ­ní cenu a to i nœô »kolikrát. Delta opce se tedy mœô¡¯œô¡¾e v relativnœô » krátké dobœô » zmœô »nit z hodnot blízkıch nule hodnotu blízkou $B$ a naopak. Odvození Black-Scholes modelu pœô ùedpokládá, œô¡¾e opce je kontinuálnœô » zajiœô¡¡tœô »na podkladovım aktivem jehoœô¡¾ mnoœô¡¾ství odpovídá její deltœô ». V pœô ùípadœô » binárních opcí je vœô¡¡ak tento postup znaœô ­nœô » nepraktickı. To vede k otázce, zda-li je pouœô¡¾ití Black-Scholes modelu pro oceœô èování binárních opcí adekvátní.

\section{Rizikovœô » neutrální svœô »t}

Ponœô »kud odliœô¡¡nım pohledem na oceœô èování opcí je aplikace rizikovœô » neutrálního pœô ùístupu. Pœô ùipomeœô ème, œô¡¾e míra rœô¡¯stu $\mu$ se ve vısledné rovnici (3.5) Black-Scholes modelu nevyskytuje. Aœô ­koliv tedy se cena opce odvíjí od volatility ceny podkladového aktiva, je míra jejího rœô¡¯stu irelevantní. Rœô¡¯zní investoœô ùi tak mohou mít diametrálnœô » rozliœô¡¡nou pœô ùedstavu o míœô ùe rœô¡¯stu $\mu$ a pœô ùesto se shodnou na cenœô » opce. Navíc také sklon k riziku jednotlivıch investorœô¡¯ nehraje pœô ùi oceœô èování opcí roli. Dœô¡¯vod je ten, œô¡¾e riziko obsaœô¡¾ené v opci mœô¡¯œô¡¾e bıt (alespoœô è teoreticky) odstranœô »no prostœô ùednictvím zajiœô¡¡tœô »ní. Vınosová míra pœô ùesahující bezrizikovou úrokou míru tedy není opodstatnœô »ná. Základní myœô¡¡lenkou Black-Scholes modelu je, œô¡¾e je moœô¡¾né vytvoœô ùit bezrizikové portfolio skládající se z podkladového aktiva a derivátu, v naœô¡¡em konkrétním pœô ùípadœô » opce. V tomto pœô ùípadœô » je moœô¡¾né derivát oceœô èovat, jako by vœô¡¡echny náhodné procesy byly rizikovœô » neutrální. To znamená, œô¡¾e parametr $\mu$ v rovnici (2.1) mœô¡¯œô¡¾e bıt nahrazen bezrizikovou mírou $r$. Opce je pak oceœô èována souœô ­asnou hodnotou oœô ­ekávané vıplaty v dobœô » splatnosti s vyuœô¡¾itím vıœô¡¡e popsané modifikace náhodné procházky. Schéma postupu je následující.

Nejprve pœô ùipomeœô ème, œô¡¾e souœô ­asná hodnota œô ­ástky $A$ v œô ­ase $T$ je rovna $Ae^{-r(T-t)}$. Pœô ùesuœô ème se do rizikovœô » neutrálního svœô »ta a v rovnici náhodné procházky, která modeluje cenu podkladového aktiva $S$, nahraœô ¯me parametr $\mu$ parametrem $r$. Na základœô » takto modifikované náhodné procházky vypoœô ­teme hustotu pravdœô »podobnosti budoucích hodnot $S$. Ta je dána rovnicí (2.7)\footnote{Je dœô¡¯leœô¡¾ité si uvœô »domit, œô¡¾e tato modifikovaná hustota pravdœô »podobnosti není skuteœô ­nou hustotou pravdœô »podobnosti ceny podkladového aktiva $S$.}. V dalœô¡¡ím kroce vypoœô ­tœô »me s vyuœô¡¾itím modifikované hustoty pravdœô »podobnosti oœô ­ekávané hodnoty vıplatní funkce $\Lambda(S)$ - jednotlivé hodnoty $\Lambda(S)$ vynásobíme rizikovœô » neutrální hustotou pravdœô »podobnosti a tento souœô ­in integrujeme pœô ùes vœô¡¡echny hodnoty, kterıch mœô¡¯œô¡¾e $S$ v œô ­ase $T$ nabıvat, tj. od nuly do nekoneœô ­na. Vıslednı integrál, kterı pœô ùedstavuje oœô ­ekávanou vıplatu opce v œô ­ase $T$, je tœô ùeba diskontovat, abychom získali souœô ­asnou hodnotu v œô ­ase $t$. Vıslednım vzorcem je rovnice (5.14). Derivací je moœô¡¾né dokázat, œô¡¾e tato rovnice splœô èuje (3.5). V pœô ùípadœô », œô¡¾e vıplatní funkce není komplikovaná, je moœô¡¾né z (5.14) odvodit rovnici pro vıpoœô ­et ceny pœô ùísluœô¡¡ného typu opce, tak jak jsme to demonstrovali napœô ù. na binární opci.

Aœô ­koliv je myœô¡¡lenka nahrazení parametru $\mu$ parametrem $r$ velice elegantní, má nœô »koliv vıznamnıch negativ. V první œô ùadœô » vyœô¡¾aduje znalost hustoty pravdœô »podobnosti budoucích hodnot podkladového aktiva (v pœô ùípadœô » rizikovœô » neturálního svœô »ta). Pro náhodnou procházku s konstatními parametry není toto pœô ùíliœô¡¡ komplikované. V pœô ùípadœô » sloœô¡¾itœô »jœô¡¡ích modelœô¡¯ je tœô ùeba nejprve tuto funkci odvodit a teprve po té je moœô¡¾né pœô ùistoupit k integrování s cílem odvodit oœô ­ekávanı vınos. Dalœô¡¡í nevıhodou je to, œô¡¾e riziková neutralita œô ­asto vede k mılkám typu
\begin{itemize}
\item Lze dokázat, œô¡¾e $\mu = r$.
\item Delta opce vyjadœô ùuje pravdœô »podobnost, œô¡¾e tato opce vyexpiruje jako at-the-money.
\end{itemize}
Jestliœô¡¾e by první vœô »ta byla pravdivá, pak by vœô¡¡echna aktiva generovala vınos odpovídající bezrizikové úrokové míœô ùe. Pœô ùi vyœô¡¡œô¡¡í volatilitœô » by pak neexistoval dœô¡¯vod, proœô ­ by investoœô ùi mœô »li preferovat akcie pœô ùed státními dluhopisy. Jestliœô¡¾e by platilo $\mu = r$, byla by druhá vœô »ta pravdivá. Pravdœô »podobnost, œô¡¾e $S > E$ v œô ­ase $t = T$, mœô¡¯œô¡¾e bıt odvozena pomocí vıpoœô ­tu oœô ­ekávané hodnoty vırazu $H(S -E)$. Pro tento vıpoœô ­et je nezbytná znalost parametru $\mu$.

Koncept rizikové neutrality není pœô ùíliœô¡¡ intiutivní, coœô¡¾ je zdrojem vıœô¡¡e uvedenıch mılek. Nicménœô » klíœô ­ové kroky pœô ùi dovození Black-Scholes rovnice, totiœô¡¾ neexistence arbitráœô¡¾e a pœô ùedpoklad, œô¡¾e bezrizikové portfolio generuje vınos odpovídající bezrizikové úrokové míœô ùe, intuitivní jsou. 

\chapter{Modifikace Black-Scholes modelu}

\section{Opce na akcie generující dividendovı vınos}

œô øada aktiv generuje vınos v podobœô » vıplaty dividendy nebo úroku. Pœô ùíkladem takovıchto aktiv je dluhopis nebo akcie. V této kapitole se budeme zabıvat z toho plynoucími modifikacemi Black-Scholes modelu. Modifikace budeme ilustrovat na akcii jako podkladovém aktivu pro evropskou kupní opci.

Je tœô ùeba si uvœô »domit, œô¡¾e vıplata dividend ovlivœô èuje cenu podkladové akcie a tím pádem také hodnotu odpovídající opce. Pœô ùi stanovení dopadu dividendy na hodnotu opce jsou rozhodující dva faktory
\begin{itemize}
\item frekvence vıplaty dividendy
\item vıœô¡¡e dividendy
\end{itemize}
Co se frekvence vıplaty tıœô ­e, zamœô »œô ùíme se dva základní modely a to
\begin{itemize}
\item spojitou vıplatu dividend (jedná se o analogii k spojitému úroœô ­ení)
\item diskrétní vıplatu dividend, kdy jsou dividendy vypláceny vœô¡¾dy k urœô ­itému pœô ùedem známému œô ­asovému okamœô¡¾iku
\end{itemize}
Vıœô¡¡i dividendy je moœô¡¾né chápat jako stochastickou nebo jako deterministickou veliœô ­inu. V následujícím textu se zamœô »œô ùíme pouze na druhou z moœô¡¾ností. Budeme tedy pœô ùedpokládat, œô¡¾e vıœô¡¡e dividendy je vœô¡¾dy dopœô ùedu známa. Vzhledem k tomu, œô¡¾e œô ùada akciovıch spoleœô ­ností udrœô¡¾uje konstatní dividendovou vıplatní politiku, je tento pœô ùedpoklad pœô ùijetelnı také z praktického hlediska.

\subsection{Spojitá vıplata dividend}

Pœô ùedpokládejme, œô¡¾e v œô ­ase $dt$ generuje podkladová akcie dividendu $D_0Sdt$, kde $D_0$ pœô ùedstavuje konstantu. Opomineme-li vazbu skrze $S$, je tato vıplata nezávislá na œô ­ase $t$. Dividendovı vınos je definovanı jako œô ­ást ceny podkladové akcie vyplácené za jednotku œô ­asu. Tento model je vhodnı nejen pro opce na akciové indexy ale také pro krátkodobé mœô »nové opce\footnote{Je znaœô ­nœô » diskutabilní, zda-li (2.1) pœô ùedstavuje pœô ùijatelnı model pro vıvoj mœô »nového kurzu v dlouhém œô ­asovém období.}, kde $D_0 = r_f$ pœô ùedstavuje spojitou úrokovou mírou pro ``zahraniœô ­ní'' mœô »nu po dobu œô¡¾ivotnosti uvaœô¡¾ované opce.

Nejprve uvaœô¡¾ujme efekt vıplaty dividendy na cenu podkladové akcie. Jestliœô¡¾e má bıt vylouœô ­ena moœô¡¾nost arbitráœô¡¾e, musí pœô ùi kaœô¡¾dém œô ­asovém kroku délky $dt$ tato cena klesnout o vıœô¡¡i vyplacené dividendy. Náhodná procházka (2.1) se tak modifikuje do podoby
\begin{equation}
dS = \sigma S dX + (\mu - D_0)S dt
\end{equation}
Aœô ­koliv pœô¡¯vodní Black-Scholes rovnice (3.5) nezahrnuje koeficient parametru $dt$ rovnice (2.1), bude mít $D_0$ vliv na její podobu. Pœô ùipomeœô ème, œô¡¾e rovnice (3.5) vychází z myœô¡¡lenky zajiœô¡¡tœô »ného portfolia. V rámci tohoto bezrizikového portfolia drœô¡¾íme $-\Delta$ jednotek podkladové akcie, z nichœô¡¾ kaœô¡¾dá vyplácí dividendu ve vıœô¡¡i $D_0 S dt$. Hodnota uvaœô¡¾ovaného portfolia se proto zmœô »ní o $-D_0 S \Delta dt$. Celková zmœô »na hodnoty portfolia je tak dána rovnicí
\begin{equation*}
d\Pi = dV - \Delta dS - D_0 S \Delta dt
\end{equation*}
a rovnice (3.5) pœô ùejde do tvaru
\begin{equation}
\frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + (r - D_0)S \frac{\partial V}{\partial S} - rV = 0
\end{equation}
V pœô ùípadœô » evropské kupní opce má koneœô ­ná podmínka stále podobu
\begin{equation*}
C(S,T) = \max(S - E, 0)
\end{equation*}
stejnœô » jako hraniœô ­ní podmínka pro $S = 0$, která má tvar
\begin{equation*}
C(0,t) = 0
\end{equation*}
Jedinou zmœô »nou je hraniœô ­ní podmínka pro $S \rightarrow \infty$, která má novœô » tvar
\begin{equation*}
C(S,t) \sim Se^{-D_0(T - t)}
\end{equation*}
Tato zmœô »na vyjadœô ùuje skuteœô ­nost, œô¡¾e pro $S \rightarrow \infty$ hodnota opce odpovídá hodnotœô » podkladového aktiva bez dividendového vınosu.

Hodnotu kupní opce mœô¡¯œô¡¾eme urœô ­it stejnœô » jako pœô ùedchozí kapitole - tj. zredukovat rovnici (6.2) do podoby difúzní rovnice a tu následnœô » s pomocí poœô ­áteœô ­ní a hraniœô ­ních podmínek œô ùeœô¡¡it. Nicménœô » existuje rychlejœô¡¡í œô ùeœô¡¡ení. Staœô ­í si uvœô »domit, œô¡¾e pomocí substituce
\begin{equation}
C(S,t) = e^{-D_0(T-t)}C_1(S,t)
\end{equation}
lze rovnici
\begin{equation*}
\frac{\partial C}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 C}{\partial S^2} + (r - D_0)S \frac{\partial C}{\partial S} - rC = 0
\end{equation*}
upravit do podoby
\begin{equation*}
D_0e^{-D_0(T-t)}C_1 + e^{-D_0(T-t)}\frac{\partial C_1}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 C_1}{\partial S^2} + (r - D_0)e^{-D_0(T-t)}S\frac{\partial C_1}{\partial S} - r e^{-D_0(T-t)}C_1 = 0
\end{equation*}
\begin{equation*}
\frac{\partial C_1}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 C_1}{\partial S^2} + (r - D_0)S\frac{\partial C_1}{\partial S} - (r - D_0)C_1 = 0
\end{equation*}
Pouœô¡¾ijeme-li $r - D_0$ namísto $r$, splœô èuje derivát $C_1(S,t)$ pœô¡¯vodní Black-Scholes rovnici (3.5), pœô ùiœô ­emœô¡¾ poœô ­áteœô ­ní a hraniœô ­ní podmínky zœô¡¯stanou substitucí (6.3) nedotœô ­eny. Také hodnota derivátu $C_1(S,t)$ v œô ­ase splatnosti $T$ je rovna hodnotœô » pœô¡¯vodní kupní opce $C(S,t)$. Hodnota evropské kupní opce je tak dána rovnicí
\begin{equation*}
C(S,t) = e^{-D_0(T-t)}SN(d_{10})-Ee^{-r(T-t)}N(d_{20})
\end{equation*}
kde
\begin{equation*}
d_{10} = \frac{\ln{\frac{S}{E}}+(r - D_0 + \frac{1}{2}\sigma^2)(T-t)}{\sigma \sqrt{T - t}}
\end{equation*}
\begin{equation*}
d_{20} = d_{10} - \sigma \sqrt{T - t}
\end{equation*}
\begin{center}
	\begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Hodnota evropské kupní opce s nulovım (horní kœô ùivka) a}
        \rput(4.0,0.0){nenulovım (dolní kœô ùivka) dividendovım vınosem}

		\psline[arrows=->](0.5,1.5)(7.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

        \psline(0.5,1.5)(3.0,1.5)(7.5,6.0)
        \pscurve(1.0,1.5)(2.5,1.80)(5.0,3.70)(7.3,5.85)
        \pscurve(1.0,1.5)(2.5,1.95)(5.0,3.82)(7.3,5.95)

        \rput(0.5,1.2){\small{0}}
        \rput(3.0,1.2){\small{E}}
        \rput(7.5,1.2){\small{S}}
        \rput(0.2,6.0){\small{C}}

	\end{pspicture}
\end{center}

\subsection{Diskrétní vıplata dividend}

Pœô ùedpokládejme, œô¡¾e podkladová akcie generuje po dobu œô¡¾ivotnosti opce pouze jednu dividendu. Dále pœô ùedpokládejme, œô¡¾e tato dividenda bude vyplacena v œô ­ase $t_d$ a vıœô¡¡e dividendového vınosu bude $d_y$. Majitel akcie tak v œô ­ase $t_d$ obdrœô¡¾í dividendu ve vıœô¡¡i $d_y S$, kde $S$ pœô ùedstavuje cenu akcie tœô »snœô » pœô ùed její vıplatou.

Nejprve opœô »t uvaœô¡¾ujme dopad vıplaty dividendy na cenu akcie. Její cena v œô ­ase $t_d^-$ tœô »snœô » pœô ùed vıplatou dividendy se nemœô¡¯œô¡¾e rovnat její cenœô » v œô ­ase $t_d^+$ tœô »snœô » po vıplatœô » dividendy. Kdyby tomu tak bylo, mohl by investor nakoupit podkladovou akcii tœô »snœô » pœô ùed vıplatou dividendy, vyinkasovat dividendu a následnœô » akcii prodat. Pomineme-li dalœô¡¡í faktory jako napœô ù. danœô », je zœô ùejmé, œô¡¾e cena akcie musí klesnout o œô ­ástku odpovídající vyplácené dividendœô ». Proto platí
\begin{equation}
S(t_d^+) = S(t_d^-) - d_yS(t_d^-) = S(t_d^-)(1-d_y)
\end{equation}

\subsubsection{Skoková podmínka}

Prokázali jsme, œô¡¾e diskrétní vıplata dividend vede k cenovému skoku podkladové akcie v okamœô¡¾iku vıplaty dividendy. Dalœô¡¡ím krokem bude zjistit, jakı vliv má tento skok na hodnotu opce. Tato otázka nás pœô ùivádí k tzv. skokové podmínce.

O skokové podmínce hovoœô ùíme v souvislosti s nespojitou zmœô »nou v nœô »které z nezávislıch veliœô ­in, které ovlivœô èují hodnotu uvaœô¡¾ovaného finanœô ­ního derivátu. Mimo den, kdy je vyplácena dividenda, se hodnota opce mœô »ní v dœô¡¯sledku náhodnıch zmœô »n ceny podkladového aktiva, které jsou spojité v œô ­ase. V den vıplaty dividendy se vœô¡¡ak tato cena zmœô »ní skokovœô » dle (6.4). Abychom zabránili arbitráœô¡¾i, musí bıt hodnota opce narozdíl od podkladového aktiva spojitou funkcí œô ­asu i pœô ùes datum vıplaty dividendy. Protoœô¡¾e vlastník opce není pœô ùíjemcem dividendy, musí bıt hodnota opce tœô »snœô » pœô ùed a tœô »snœô » po vıplatœô » dividendy stejná. Tato jednoduchá úvaha vede ke skokové podmínce
\begin{equation}
V(S(t_d^-), t_d^-) = V(S(t_d^+), t_d^+)
\end{equation}
Hodnota opce tak musí bıt spojitá v œô ­ase pro libovolnı model vıvoje ceny podkladového aktiva.

V rámci této knihy uvaœô¡¾ujeme model hodnoty opce zaloœô¡¾enı na diferenciální rovnici s $S$ a $t$ jako nezávislımi veliœô ­inami. Protoœô¡¾e potœô ùebujeme brát v potaz vœô¡¡echny moœô¡¾né modely pro vıvoj $S$, nechápeme cenu podkladového aktiva jako funkci $t$ tak, jak je popsaná rovnicí (6.4). Uvaœô¡¾ujme o hodnotœô » opce $V$ jako o funkci veliœô ­iny $S$. Poloœô¡¾me si otázku, jak se zmœô »ní cena opce $S$ pœô ùes den vıplaty dividendy. Odpovœô »dí je, œô¡¾e se hodnota opce s ohledem na $V$ zmœô »ní nespojitœô » dle (6.4) s veliœô ­inami $S(t_d^+)$ a $S(t_d^-)$ ``svázanımi'' podmínkou (6.5). Vısledkem tœô »chto úvah je rovnice
\begin{equation}
V(S,t_d^-) = V(S(1-d_y),t_d^+)
\end{equation}
která vyjadœô ùuje fakt, œô¡¾e hodnota opce tœô »snœô » pœô ùed vyplatou dividendy pro cenu podkladového aktiva $S$ se rovná hodnotœô » opce tœô »snœô » po vıplatœô » dividendy pro cenu podkladového aktiva $S(1 - d_y)$. Kdyby bylo $S$ konstatní, zmœô »nila by se hodnota opce pœô ùes den vıplaty dividendy nespojitœô ». Nicménœô » (6.6) odpovídá pœô ùedpokladu, œô¡¾e hodnota opce je spojitá v œô ­ase pro libovolnı model náhodné procházky podkladového aktiva. Spojitost hodnoty opce v œô ­ase neznamená, œô¡¾e není ovlivnœô »na vıplatou dividendy. Vliv skokové podmínky (6.6) je vœô¡¡ak rozloœô¡¾en do celé œô¡¾ivotnosti opce.

Aœô ­koliv se pœô ùes den vıplaty dividendy nezmœô »ní hodnota opce, zmœô »ní se její delta. V pœô ùípadœô » zajiœô¡¡tœô »ní je tœô ùeba provést provést úpravu struktury portfolia.

\subsection{Kupní opce s jednou dividendovou platbou}

Zkusme ocenit evropskou kupní opci, kde podkladová akcie generuje po dobu œô¡¾ivotnosti opce jednu dividendovou platbu. Protoœô¡¾e je Black-Scholes rovnice zpœô »tnœô » parabolická, postupujeme od okamœô¡¾iku splatnosti opce smœô »rem k œô ­asovému okamœô¡¾iku, ke kterému chceme opci ocenit. V pœô ùípadœô », œô¡¾e je vyplácena dividenda, je postup následující
\begin{itemize}
\item œô ùeœô¡¡íme Black-Scholes rovnici od okamœô¡¾iku splatnosti opce do œô ­asového okamœô¡¾iku tœô »snœô » pœô ùed vıplatou dividendy, tj. do œô ­asu $t_d^+$
\item aplikujeme skokovou podmínku (6.6) pœô ùes œô ­asovı okamœô¡¾ik $t_d$, abychom naœô¡¡li hodnotu opce v $t_d^-$
\item œô ùeœô¡¡íme Black-Scholes rovnici od $t_d^-$ smœô »rem k œô ­asovému okamœô¡¾iku ocenœô »ní opce s vyuœô¡¾itím vıœô¡¡e odvozené hodnoty opce jako vıchozích dat
\end{itemize}
V souladu s tímto postupem tak œô ùeœô¡¡íme Black-Scholes rovnici dvakrát a to pro œô ­asovı interval $T > t > t_d$ a následnœô » pro œô ­asovı interval $t_d > t > 0$, kde 0 pœô ùedstavuje okamœô¡¾ik ocenœô »ní opce, tj. ve vœô »tœô¡¡inœô » pœô ùípadœô¡¯ dneœô¡¡ek. Hodnoty opce v $t_d^{\pm}$ jsou provázány skrze (6.6). Velmi podobnı pœô ùístup je volen pœô ùi oceœô èování nœô »kterıch exotickıch opcí.

Oznaœô ­me námi uvaœô¡¾ovanou kupní opci jako $C_d(S,t)$. Dále pouœô¡¾ijme oznaœô ­ení $C(S, t, E)$ pro hodnotu plain-vanilla evropské kupní opcen s realizaœô ­ní cenou $E$. Po vıplatœô » dividendy je opce $C_d(S,t)$ shodná s opcí $C(S,t,E)$.
\begin{equation*}
C_d(S,t) = C(S,t,E)~~~t_d^+ \le t \le T
\end{equation*}
Nyní pouœô¡¾ijeme vztah (6.6) a získáme
\begin{equation*}
C_d(S, t_d^-) = C_d(S(1-d_y),t_d^+) = C(S(1-d_y),t_d^+,E)
\end{equation*}
V této fázi mœô¡¯œô¡¾eme pouœô¡¾ít standardní rovnici pro vıpoœô ­et hodnoty evropské kupní opce. Zamœô »œô ùme se nyní na $C(S(1 - d_y),t,E)$. V dobœô » splatnosti má tento derivát hodnotu
\begin{equation*}
C(S(1-d_y),T,E) = \max(S(1 - d_y) - E, 0) = (1 - d_y)\max(S - E(1 - d_y)^{-1},0)
\end{equation*}
Proto je moœô¡¾né $C_d(S,t)$ vyjádœô ùit jako
\begin{equation*}
C_d(S,t) = (1 - d_y)C(S, t, E(1 - d_y)^{-1})
\end{equation*}
Vıplata dividendy tak sniœô¡¾uje hodnotu opce. Logická interpretace je taková, œô¡¾e majitel opce dividendu nezíská, avœô¡¡ak hodnota podkladového aktiva se v dœô¡¯sledku její vıplaty sníœô¡¾í.

\subsection{Technická poznámka: Sjednocení spojité a diskrétní vıplaty dividend}

Pœô ùedpokládejme, œô¡¾e vıplata dividendy je obecnou funkcí $S$ a $t$ ve tvaru $D(S,t)$. V pœô ùípadœô » spojité vıplaty dividendy má tato funkce tvar $D(S,t) = D_0S$ zatímco v pœô ùípadœô » diskrétní vıplaty tvar $D(S,t) = D_{\delta}S \delta(t - t_d)$, kde $D_{\delta}$ pœô ùedstavuje konstantu jejíœô¡¾ vazbu na $d_y$ objasníme níœô¡¾e. Náhodná procházka modelující vıvoj ceny podkladového aktiva má tvar
\begin{equation*}
dS = (\mu S - D(S,t))dt + \sigma S dX
\end{equation*}
Je-li vıplata dividend diskrétní, pœô ùejde tato rovnice do tvaru
\begin{equation*}
dS = (\mu S - D_{\delta}S \delta(t - t_d))dt + \sigma S dX
\end{equation*}
Intergrováním pœô ùes œô ­asovı okamœô¡¾ik vıplaty dividendy získáváme
\begin{equation*}
\int_{S(t_d^-)}^{S(t_d^+)} \frac{dS}{S} = \int_{t_d^-}^{t_d^+}\mu dt - D_{\delta}\int_{t_d^-}^{t_d^+} + \int_{t_d^-}^{t_d^+}\sigma dX
\end{equation*}
Protoœô¡¾e $t_d^-$ a $t_d^+$ se liœô¡¡í pouze infinitezimálnœô », je jedinım nenulovım œô ­lenem vıœô¡¡e uvedeného integrálu œô ­len obsahující delta funkci. Integrál tak pœô ùejde to tvaru
\begin{equation*}
\int_{S(t_d^-)}^{S(t_d^+)} \frac{dS}{S} = -D_{\delta} \int_{t_d^-}^{t_d^+}\delta(t - t_d)dt
\end{equation*}
\begin{equation}
\ln \frac{S(t_d^+)}{S(t_d^-)} = -D_{\delta}
\end{equation}
Proto je v pœô ùípadœô » vıplaty dividendy definované jako $D_{\delta}S \delta (t - t_d)$ cena podkladového aktiva diskontována œô ­lenem $e^{D_{\delta}H(t - t_d)}$ pœô ùiœô ­emœô¡¾ $D_{\delta} = -\ln(d_y)$.

Pro libovolnı model vıvoje ceny podkladového aktiva je hodnota opce spojitá, a proto musí bıt opœô »t splnœô »na skoková podmínka
\begin{equation*}
V(S(t_d^+), t_d^+) = V(S(t_d^-), t_d^-)
\end{equation*}
 kde $S(t_d^+)$ a $S(t_d^-)$ jsou propojeny skrze (6.7).

\section{Forwardové a futures kontrakty}

Oceœô èování forwardovıch a futures kontraktœô¡¯ je v porovnání s opcemi mnohem jednoduœô¡¡œô¡¡í. Veœô¡¡keré riziko je totiœô¡¾ moœô¡¾né zajistit jedinou operací na zaœô ­átku kontraktu\footnote{V pœô ùípadœô » opcí je nutné zajiœô¡¡tœô »ní neustále ``korigovat'', coœô¡¾ v pœô ùípadœô » forwardovıch a futures kontraktœô¡¯ není zapotœô ùebí.}. Pro samotné ocenœô »ní pak není rozhodující vıvoj ceny pokladového aktiva - jedinım nutnım pœô ùedpokladem je znalost budoucího vıvoje úrokovıch sazeb. Protoœô¡¾e jsou vœô¡¡ak forwardové a futures kontrakty stejnœô » jako opce finanœô ­ními deriváty, je moœô¡¾né také pro jejich ocenœô »ní pouœô¡¾ít Black-Scholes model. V této kapitole se budeme zabıvat ocenœô »ním forwardovıch kontraktœô¡¯\footnote{Pœô ùimeœô ème, œô¡¾e z hlediska ocenœô »ní není mezi forwardovım a futures kontraktem zásadnœô »jœô¡¡í rozdíl.}.

Uvaœô¡¾ujme forwardovı kontrakt, kterı je uzavœô ùen v œô ­ase $t$ pœô ùi spotové cenœô » podkladového aktiva $S(t)$ a forwardové cenœô » $F$. Naœô¡¡ím úkolem tak bude nalézt vztah mezi $S(t)$ a takovou forwardovou cenou $F$, pro kterou bude hodnota kontraktu v œô ­ase $t$ nulová. V rámci naœô¡¡í analızy budeme pœô ùedpokládat konstantní úrokové sazby po dobu œô¡¾ivotnosti forwardového kontraktu.

Existuje nœô »kolik zpœô¡¯sobœô¡¯, jak ocenit forwardovı kontrakt. Základním pœô ùístupem je ocenœô »ní pomocí pœô ùedpokladu neexistence arbitráœô¡¾e. Uvaœô¡¾ujme investora, kterı je krátkı ve forwardovém kontraktu. Tento investor tedy bude muset v dobœô » splatnosti, tj. v œô ­ase $T$, dodat podkladové aktivum za cenu $F$. Moœô¡¾ností, jak se zajistit proti riziku tohoto typu kontraktu, je nakoupit v œô ­ase $t$ podkladové aktivum za cenu $S(t)$ a toto aktivum drœô¡¾et aœô¡¾ do œô ­asového okamœô¡¾iku $T$. V œô ­ase $T$ získá investor za toto aktivum $F$ penœô »œô¡¾ních jednotek. Souœô ­asná hodnota této œô ­ástky je $Fe^{-r(T-t)}$. ``Spravedlivá'' forwardová cena je tak
\begin{equation*}
F = S(t)e^{r(T-t)}
\end{equation*}

Dalœô¡¡ím zpœô¡¯sobem ocenœô »ní forwardového kontraktu je jeho ``rozloœô¡¾ení'' na dlouhou pozici v evropské kupní opci a krátkou pozici v evropské prodejní opci, kde obœô » opce musí mít shodnou realizaœô ­ní cenu a œô ­as do splatnosti jako pœô¡¯vodní forwardovı kontrakt\footnote{Tato dekompozice forwardového kontraktu na dvojici opcí je reformulací put-call parity.}. Vzhledem k tomu, œô¡¾e hodnota forwardového kontraktu je v okamœô¡¾iku jeho uzavœô ùení nulová, musí pro realizaœô ­ní cenu opcí $E$ platit
\begin{equation*}
S(t) - Ee^{-r(T-t)} = 0
\end{equation*}
Vzhledem k tomu, œô¡¾e $E = F$, získáváme
\begin{equation*}
F = S(t)e^{r(T-t)}
\end{equation*}

Poslední zpœô¡¯sobem ocenœô »ní forwardového kontraktu je pomocí Black-Scholes modelu. Vzhledem k tomu, œô¡¾e forwardovı kontrakt je finanœô ­ním derivátem, musí splœô èovat rovnici (3.5). Vıplata tohoto derivátu v œô ­ase $T$ je rovna $S-F$. Klíœô ­em k ocenœô »ní forwardového kontraktu je pak rovnice (5.14).
\begin{equation}
V(S,t) = \frac{e^{-r(T - t)}}{\sigma \sqrt{2 \pi (T - t)}} \int^{\infty}_0 (S' - F)e^{-\frac{1}{2} \big( \frac{\ln (S'/S) - (r - \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}} \big)^2} \frac{1}{S'}dS'
\end{equation}
Nyní si pœô ùipomeœô ème, œô¡¾e hustota pravdœô »podobnosti ceny podkladového aktiva $S'$ v œô ­ase $T$ je
\begin{equation*}
\frac{1}{\sigma \sqrt{2 \pi (T - t)}} e^{-\frac{1}{2} \big( \frac{\ln (S'/S) - (\mu - \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}} \big)^2}
\end{equation*}
a œô¡¾e se pohybujeme v rizikovœô » neutrálním svœô »tœô », kterı umoœô¡¾œô èuje úplnou eliminaci rizika. Proto mœô¡¯œô¡¾eme v náhodné procházce podkladového aktiva $S$ nahradit $\mu$ bezrizikovou úrokovou sazbou $r$. Hustota pravdœô »podobnosti se tak modifikuje do podoby
\begin{equation*}
\frac{1}{\sigma \sqrt{2 \pi (T - t)}} e^{-\frac{1}{2} \big( \frac{\ln (S'/S) - (r - \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}} \big)^2}
\end{equation*}
Pouze pœô ùipomeœô ème, œô¡¾e se jedná o hustotu pravdœô »podobnosti náhodné veliœô ­iny $S'$ v rizikovœô » neutrálním nikoliv reálném svœô »tœô ». Oœô ­ekávanou hodnotu náhodné veliœô ­iny $S'$ v rizikovœô » neutrálním svœô »tœô » v œô ­ase $T$ je tak dána rovnicí
\begin{equation*}
E[S'] = \frac{1}{\sigma \sqrt{2 \pi (T - t)}}\int^{\infty}_0 e^{-\frac{1}{2} \big( \frac{\ln (S'/S) - (r - \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}} \big)^2}dS'
\end{equation*}
V rizikovœô » neutrálním svœô »tœô » musí platit
\begin{equation*}
E[S'] = S(t)e^{r(T-t)}
\end{equation*}
Rovnici (6.8) tak lze upravit do tvaru
\begin{equation*}
V(S,t) = S(t) - F e^{-r(T - t)}\frac{1}{S ' \sigma \sqrt{(T - t)}}\frac{1}{\sqrt{2 \pi}} \int^{\infty}_0 e^{-\frac{1}{2} \big( \frac{\ln (S'/S) - (r - \frac{1}{2}\sigma^2)(T - t)}{\sigma \sqrt{T - t}} \big)^2} dS'
\end{equation*}
\begin{equation*}
V(S,t) = S(t) - e^{-r(T - t)} F \frac{1}{\sqrt{2 \pi}} \int^{\infty}_{-\infty}e^{-\rho^2}d\rho
\end{equation*}
\begin{equation*}
V(S,t) = S(t) - e^{-r(T - t)} F N(\infty)
\end{equation*}
\begin{equation*}
V(S,t) = S(t) - e^{-r(T - t)} F
\end{equation*}
Protoœô¡¾e pro forwardovı kontrakt platí, œô¡¾e jeho hodnota je v okamœô¡¾iku uzavœô ùení $t$ nulová, získáváme
\begin{equation*}
F = e^{r(T - t)} S(t)
\end{equation*}
Aœô¡¾ dosud jsme pœô ùedpokládali, œô¡¾e podkladové aktivum nevyplácí dividendy. Jestliœô¡¾e podkladové aktivum generuje konstatní dividendovı vınos $D_0$, modifikuje se vıœô¡¡e uvedená rovnice do tvaru
\begin{equation*}
F = e^{(r - D_0)(T - t)} S(t)
\end{equation*}
Parametr $D_0$ mœô¡¯œô¡¾e bıt i zápornı - napœô ù. zlato vyœô¡¾aduje úhradu pojiœô¡¡tœô »ní a nákladœô¡¯ spojenıch s uskladnœô »ním.

\section{Opce na futures}

œô øada opcí má jako podkladové aktivum futures kontrakty. Dœô¡¯vod je ten, œô¡¾e v œô ùadœô » pœô ùípadœô¡¯ jsou futures kontrakty v porovnání s podkladovım aktivem likvidnœô »jœô¡¡í a jsou s nimi spojeny niœô¡¾œô¡¡í transakœô ­ní náklady\footnote{Typickım pœô ùíkladem jsou futures kontrakty na ropu.}. Hodnota opcí na futures kontrakty je funkcí $F$ a $t$, tj. má tvar $V(F,t)$. Protoœô¡¾e
\begin{equation*}
F = Se^{r(T - t)}
\end{equation*}
je moœô¡¾né odvodit parciální diferenciální rovnici pro $V(F,t)$ na základœô » standardní Black-Scholes rovnice a to tak, œô¡¾e $S$ nahradíme $Fe^{-r(T - t)}$. V rovnici (3.5) nahradíme œô ­len
\begin{equation*}
\frac{\partial V}{\partial S}
\end{equation*}
vırazem
\begin{equation*}
\frac{\partial V}{\partial F}\frac{\partial F}{\partial S} = e^r(T - t)\frac{\partial V}{\partial F}
\end{equation*}
œô ­len
\begin{equation*}
\frac{\partial^2 V}{\partial S^2}
\end{equation*}
vırazem
\begin{equation*}
\frac{\frac{\partial V}{\partial S}}{\partial S} = \frac{\frac{\partial V}{\partial F}\frac{\partial F}{\partial S}}{\partial F}\frac{\partial F}{\partial S} = (e^{r(T - t)})^2 \frac{\partial^2 V}{\partial F^2}
\end{equation*}
a koneœô ­nœô » œô ­len
\begin{equation*}
\frac{\partial V}{\partial t}
\end{equation*}
vırazem
\begin{equation*}
\frac{\partial V}{\partial t} + \frac{\partial V}{\partial F}\frac{\partial F}{\partial t} = \frac{\partial V}{\partial t} - rF\frac{\partial V}{\partial F}
\end{equation*}
Rovnice (3.5) se tak zmodifikuje do podoby
\begin{equation}
\frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2\frac{\partial^2 V}{\partial F^2} - rV = 0
\end{equation}

Rovnici (6.9) je moœô¡¾né odvodit také pœô ùímo pomocí It\^o lemmy (2.5). Nejprve uvaœô¡¾ujme nádhodnou procházku pro $F$. Vzhledem k tomu, œô¡¾e $F = Se^{r(T - t)}$, platí
\begin{equation*}
dF = e^{r(T-t)}dS - e^{r(T - t)}rSdt
\end{equation*}
\begin{equation*}
dF = (\sigma S dX + \mu S dt)e^{r(T - t)} - r Fdt
\end{equation*}
\begin{equation}
dF = (\mu - r)F dt + \sigma F dX
\end{equation}
Podle It\^o lemmy platí pro $dV$
\begin{equation}
dV = \sigma F \frac{\partial V}{\partial F}dX + \bigg( (\mu - r) F \frac{\partial V}{\partial F} + \frac{1}{2}\sigma^2 F^2\frac{\partial^2 V}{\partial F^2} + \frac{\partial V}{\partial t} \bigg)dt
\end{equation}
Dále uvaœô¡¾ujme bezrizkové portfolio $\Pi = V - F$. Zmœô »na hodnoty portfolia $d \Pi$ je tak s ohledem na (6.10) a (6.11) rovna
\begin{equation*}
d \Pi = dV - \Delta dF
\end{equation*}
\begin{equation*}
d \Pi = \sigma F \frac{\partial V}{\partial F}dX + \bigg( (\mu - r) F \frac{\partial V}{\partial F} + \frac{1}{2}\sigma^2 F^2\frac{\partial^2 V}{\partial F^2} + \frac{\partial V}{\partial t} \bigg)dt - \Delta(\sigma F dX + (\mu -r)Fdt)
\end{equation*}
Jestliœô¡¾e zvolíme $\Delta = \frac{\partial V}{\partial F}$, zbavíme se náhodné sloœô¡¾ky $dX$. Vıslednı tvar pro $d\Pi$ je tak
\begin{equation*}
d \Pi = \bigg( \frac{1}{2}\sigma^2 F^2\frac{\partial^2 V}{\partial F^2} + \frac{\partial V}{\partial t} \bigg)dt
\end{equation*}
K sestavení portfolia $\Pi$ v œô ­ase $t$ je zapotœô ùebí œô ­ástka $V$. Vzhledem k tomu, œô¡¾e je portfolio $\Pi$ bezrizikové, musí platit
\begin{equation*}
d \Pi = r V dt
\end{equation*}
\begin{equation*}
\bigg( \frac{1}{2}\sigma^2 F^2\frac{\partial^2 V}{\partial F^2} + \frac{\partial V}{\partial t} \bigg)dt - r V dt = 0
\end{equation*}
\begin{equation*}
\frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 F^2\frac{\partial^2 V}{\partial F^2} - r V = 0
\end{equation*}
Tímto zpœô¡¯sobem jsme odvodili rovnici (6.9).

Protoœô¡¾e (6.9) odpovídá Black-Scholes rovnici pro podkladové aktivum generující vınosovou míru $r$, mœô¡¯œô¡¾e vıœô¡¡e odvozenı vısledek vyuœô¡¾ít pro ocenœô »ní opce na futures kontrakt. V pœô ùípadœô » evropské kupní opce je její hodnota dána rovnicí
\begin{equation*}
C(F,t) = e^{-r(T - t)}(FN(d_1) - EN(d_2))
\end{equation*}

\section{Parametry Black-Scholes modelu jako funkce œô ­asu}

Aœô¡¾ dosud jsme pœô ùedpokládali, œô¡¾e bezriziková sazba $r$ a volatilita ceny podkladového aktiva $\sigma^2$ jsou konstanty. V následujícím textu budeme pœô ùedpokládat, œô¡¾e se jedná o funkce œô ­asu, jejichœô¡¾ prœô¡¯bœô »h je znám\footnote{Bezriziková sazba $r$ a volatilita ceny podkladového aktiva $\sigma^2$ jako stochatické veliœô ­iny by vedly z analytického hlediska k pœô ùíliœô¡¡ komplikovanım modelœô¡¯m.}.

Jestliœô¡¾e nahradíme konstanty $r$ a $\sigma^2$ funkcemi $r(t)$ a $\sigma(t)^2$, zœô¡¯stane základní rovnice (3.5) Black-Scholes modelu nezmœô »nœô »na stejnœô » jako ``koneœô ­né'' a hraniœô ­ní podmínky. Vyjímkou je hraniœô ­ní podmínka pro evropskou prodejní opci, která se z
\begin{equation*}
P(0,t) = Ee^{-r(T - t)}
\end{equation*}
zmœô »ní na
\begin{equation*}
P(0,t) = Ee^{-\int_t^T r(\tau) d \tau}
\end{equation*}
Modifikovaná rovnice (3.5) má podobu
\begin{equation}
\frac{\partial V}{\partial t} + \frac{1}{2}\sigma(t)^2 S^2\frac{\partial^2 V}{\partial S^2} + r(t)S \frac{\partial V}{\partial S} - r(t)V = 0
\end{equation}
Proveœô ¯me následující substituce
\begin{equation*}
\bar{S} = Se^{\alpha(t)}
\end{equation*}
\begin{equation*}
\bar{V} = Ve^{\beta(t)}
\end{equation*}
\begin{equation*}
\bar{t} = \gamma (t)
\end{equation*}
kde $\alpha$, $\beta$ a $\gamma$ vybereme tak, abychom v rovnici (6.12) eliminovali vœô¡¡echny koeficienty, které jsou funkcí œô ­asu. S pœô ùihlédnutím k vıœô¡¡e uvedenım substitucím se (6.12) pœô ùetransformuje do tvaru
\begin{equation}
\dot{\gamma}(t)\frac{\partial \bar{V}}{\partial \bar{t}} + \frac{1}{2}\sigma(t)^2 \bar{S}^2 \frac{\partial^2 \bar{V}}{\partial \bar{S}^2} + (r(t) + \dot{\alpha}(t))\bar{S} \frac{\partial \bar{V}}{\partial \bar{S}} - (r(t) + \dot{\beta}(t))\bar{V}
\end{equation}
kde $\cdot = d /dt$. Jak jiœô¡¾ bylo zmínœô »no vıœô¡¡e, lze v rovnici (6.13) eliminovat œô ­leny obsahující $\bar{V}$, $\partial \bar{V} / \partial \bar{S}$ a $\partial^2 \bar{V} / \partial \bar{S}^2$ pomocí vhodné volby parametrœô¡¯ $\alpha$, $\beta$ a $\gamma$. Pouœô¡¾ijeme-li substituce
\begin{equation*}
\alpha(t) = \int_t^Tr(\tau) d \tau
\end{equation*}
\begin{equation*}
\beta(t) = \int_t^Tr(\tau) d \tau
\end{equation*}
\begin{equation*}
\gamma(t) = \int_t^T \sigma(\tau)^2 d \tau
\end{equation*}
zjednoduœô¡¡œô¡¡í se (6.13) na
\begin{equation}
\frac{\partial \bar{V}}{\partial \bar{t}} = \frac{1}{2} \bar{S}^2 \frac{\partial^2 \bar{V}}{\partial \bar{S}^2}
\end{equation}
Tato rovnice neobsahuje œô¡¾ádné œô ­leny, které by byly funkcí œô ­asu a postrádá jakıkoliv odkaz na $r$ a $\sigma^2$. Jestliœô¡¾e je $\bar{V}(\bar{S}, \bar{t})$ je œô ùeœô¡¡ením (6.14), pak dopovídající œô ùeœô¡¡ení pœô¡¯vodní rovnice (6.12) má tvar
\begin{equation}
V = e^{-\beta(t)} \bar{V}(Se^{\alpha(t)}, \gamma{t})
\end{equation}
Oznaœô ­me libovolné œô ùeœô¡¡ení Black-Scholes diferenciální rovnice jako $V_{BS}$ pro konstantní $r$ a $\sigma^2$ a nulovı dividendovı vınos. S ohledem na vıœô¡¡e odvozené je zœô ùejmé, œô¡¾e toto œô ùeœô¡¡ení lze vyjádœô ùit jako
\begin{equation}
V_{BS} = e^{-r(T - t)}\bar{V}_{BS}(Se^{r(T - t)},\sigma^2(T-t))
\end{equation}
Je uœô¡¾iteœô ­né si uvœô »domit, œô¡¾e rovnici (6.15) lze z rovnice (6.16) získat pomocí substitucí
\begin{equation*}
r = \frac{1}{T - t} \int^T_t r(\tau) d \tau
\end{equation*}
\begin{equation*}
\sigma^2 = \frac{1}{T - t} \int^T_t \sigma(\tau)^2 d \tau
\end{equation*}
Z tœô »chto substitucí je vyplıvá, œô¡¾e v klasickém Black-Scholes modelu s konstantní bezrizikovou úrokovou sazbou a volatilitou mají tyto parametry charakter prœô¡¯mœô »rnıch hodnot po dobu zbytkové œô¡¾ivotnosti pœô ùísluœô¡¡né opce.

\chapter{Americké opce}

\section{Úvod}

Pœô ùipomeœô ème, œô¡¾e americké opce se od evropskıch liœô¡¡í tím, œô¡¾e mohou bıt uplatnœô »ny kdykoliv v prœô¡¯bœô »hu své œô¡¾ivotnosti. Protoœô¡¾e má její majitel v porovnání s evropskou opcí vœô »tœô¡¡í práva, mœô »la by bıt hodnota americké opce vyœô¡¡œô¡¡í.
\begin{center}
	\begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Vnitœô ùní a œô ­asová hodnota evropské prodejní opce}
        \rput(4.0,0.0){pœô ùed splatností jako funkce $S$}

		\psline[arrows=->](0.5,1.5)(7.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

        \psline(0.5,5.5)(4.5,1.5)
        \pscurve[linewidth=0.5mm](0.5,5.2)(4.0,1.9)(4.5,1.7)(5.5,1.6)(6.5,1.55)

        \rput(0.5,1.2){\small{0}}
        \rput(4.5,1.2){\small{E}}
        \rput(7.5,1.2){\small{S}}
        \rput(0.2,6.0){\small{P}}
	\end{pspicture}
\end{center}
Následující argument vycházející z neexistence arbitráœô¡¾e dokazuje, œô¡¾e hodnota americké prodejní opce musí bıt vyœô¡¡œô¡¡í neœô¡¾ hodnota odpovídající evropské opce. Jak je patrné z vıœô¡¡e uvedeného obrázku, pro dostateœô ­nœô » malá $S$ platí, œô¡¾e hodnota evropské opce je niœô¡¾œô¡¡í neœô¡¾ její vnitœô ùní hodnota. Pœô ùedpokládejme, œô¡¾e $S$ splœô èuje tuto podmínku, tj.
\begin{equation*}
P(S,t) < \max(E - S, 0)
\end{equation*}
a uvaœô¡¾ujme, co by stalo v pœô ùípadœô » pœô ùedœô ­asného uplatnœô »ní opce. Protoœô¡¾e $S < E$, lze vıœô¡¡e uvedenou nerovnost zjednoduœô¡¡it do podoby $P(S,t) < E - S$. Investor by mohl na trhu koupit prodejní opci za cenu $P$, podkladové aktivum za cenu $S$ a následnœô » opci uplatnit a podkladové aktivum prodat za cenu $E$. Jeho bezrizikovı vınos by tak byl roven $E - S - P$. Vzhledem k tomu, œô¡¾e tato situace mœô¡¯œô¡¾e existovat pouze po nekoneœô ­nœô » krátkı œô ­asovı okamœô¡¾ik, musí pro americkou prodejní opci platit nerovnost
\begin{equation*}
P(S,t) \ge \max(E - S, 0)
\end{equation*}
Americká a evropská prodejní opce tak musí bıt odliœô¡¡nou hodnotu.

Dalœô¡¡í agrument se zabıvá hodnotou americké kupní opce na podkladové aktivum, které generuje nenulovı dividendovı vınos $D_0$. Pœô ùipomeœô ème, œô¡¾e pro dostateœô ­nœô » velká $S$ hodnota evropské kupní opce pœô ùibliœô¡¾nœô » splœô èuje podmínku
\begin{equation*}
C(S,t) \sim Se^{-D_0(T - t)}
\end{equation*}
Pro dostateœô ­nœô » velká $S$ a nenulové $D_0$ tak platí
\begin{equation*}
C(S,t) < \max(S - E,0)
\end{equation*}
Protoœô¡¾e $S > E$, lze tuto nerovnost dále zjednoduœô¡¡it na tvar $C(S,t) < S - E$. Jestliœô¡¾e by mœô »l investor moœô¡¾nost pœô ùedœô ­asného uplatnœô »ní opce, mohl by nakoupit opci za cenu $C$, tuto opci uplatnit a za cenu $E$ koupit podkladové aktivum a následnœô » toto aktivum prodat za $S$. Bezrizikovı vınos, kterı tak investor získá je $S - E - C$. Vzhledem k tomu, œô¡¾e tato arbitráœô¡¾ nemœô¡¯œô¡¾e trvat po delœô¡¡í dobu, musí pro americkou kupní opci platit
\begin{equation*}
C(S,t) \ge \max(S - E, 0)
\end{equation*}

V obou vıœô¡¡e uvedenıch pœô ùíkladech musí existovat hodnoty $S$, pro které je z pohledu majitele optimální opci pœô ùedœô ­asnœô » uplatnit. V opaœô ­ném pœô ùípadœô » by nebyla americká opce nikdy pœô ùedœô ­asnœô » uplatnœô »na a její hodnota by byla shodná s evropskou opcí. Ocenœô »ní americké opce je tak v porovnání s evropskou opcí komplikovanœô »jœô¡¡í, protoœô¡¾e v kaœô¡¾dém œô ­asovém okamœô¡¾iku musíme nejen urœô ­it hodnotu opce, ale také rozhodnout, zda-li je optimální tuto opci pœô ùedœô ­asnœô » uplatit. V souvislosti s touto problematikou pak hovoœô ùíme o tzv. problému volné hraniœô ­ní podmínky. Pro kaœô¡¾dı œô ­asovı okamœô¡¾ik $t$ existuje urœô ­itá hodnota $S$, která pœô ùedstavuje hranici mezi dvœô »ma regiony - (a) pro ceny podkladového aktiva menœô¡¡í neœô¡¾ tato hraniœô ­ní cena je optimální opci pœô ùedœô ­asnœô » uplatnit a (b) pro ceny vœô »tœô¡¡í neœô¡¾ tato hraniœô ­ní cena je naopak racionální opci nadále drœô¡¾et\footnote{V praxi mœô¡¯œô¡¾e existovat vícero takovıchto hraniœô ­ních cen $S$. Prozatím vœô¡¡ak budeme pœô ùedpokládat, œô¡¾e existuje pouze jedna takováto cena.}. Tuto hraniœô ­ní cenu znaœô ­íme jako $S_f(t)$. Tuto cenu pœô ùedem neznáme, a proto v porovnání s evropskımi opcemi postrádáme jednu z informací.

Analızu problému volné hraniœô ­ní podmínky, kterı je klíœô ­em k oceœô èování americkıch opcí, zaœô ­neme pœô ùedstavením tzv. problému pœô ùekáœô¡¾ky. Dœô¡¯vodem je, œô¡¾e americké opce a problém pœô ùekáœô¡¾ky pojí œô ùada podobnıch vlastností.

\section{Problém pœô ùekáœô¡¾ky}

Ve své nejjednoduœô¡¡œô¡¡í verzi je problém pœô ùekáœô¡¾ky definován následovnœô ». Uvaœô¡¾ujme pruœô¡¾nou strunu nataœô¡¾enou mezi body $A$ a $B$ a spojitı objekt\footnote{Spojitost v tomto pœô ùípadœô » chápeme v matematickém slova smyslu.}, kterı pod danou strunou prochází a napíná ji tak.
 \begin{figure}
  \begin{center}
	\begin{pspicture}(0,0)(9.0,4.5)

		\psline(0.5,0.5)(8.5,0.5)

        \pscurve[linewidth=0.5mm](2.0,0.5)(3.5,3.5)(4.5,4.0)(5.5,3.5)(6.5,0.5)
        \psline(1.0,0.5)(3.5,3.5)
        \psline(5.5,3.5)(8.0,0.5)

        \rput(1.0,0.0){\small{$A$}}
        \rput(8.0,0.0){\small{$B$}}
        \rput(3.2,3.8){\small{$P$}}
        \rput(5.6,3.8){\small{$Q$}}
	\end{pspicture}
 \end{center}
 \begin{center}
  \caption{\label{obstacle} Ilustrace klasického problému pœô ùekáœô¡¾ky}
 \end{center}
\end{figure}
Vymezení œô ­ásti povrchu pœô ùekáœô¡¾ky, na které dochází ke kontaktu se strunou, pœô ùedem neznáme. Víme vœô¡¡ak, œô¡¾e struna se buœô ¯to dotıká pœô ùekáœô¡¾ky, œô ­ímœô¡¾ je její pozice dána, nebo pœô ùedstavuje teœô ­nu k pœô ùekáœô¡¾ce vedené z bodu $A$ popœô ù. $B$ a musí splœô èovat rovnici pohybu. Struna musí dále splœô èovat dvœô » podmínky. První podmínka œô ùíká, œô¡¾e struna leœô¡¾í na pœô ùekáœô¡¾ce\footnote{V tomto pœô ùípadœô » se tedy jedná o bod z oblasti dotyku mezi strunou a pœô ùekáœô¡¾kou.} nebo nad ní\footnote{V tomto pœô ùípadœô » se zase jedná o body, kdy struna plní funkci teœô ­ny k pœô ùekáœô¡¾ce.}. Z této podmínky v kombinaci s pohybovou rovnicí vyplıvá, œô¡¾e kœô ùivost struny musí bıt záporná nebo nulová. Druhou podmínkou je, œô¡¾e smœô »rnice struny musí bıt spojitá. To je zœô ùejmé s vyjímkou bodœô¡¯, kde struna prvnœô » ztrácí kontakt s pœô ùekáœô¡¾kou. Vzhledem k tomu, œô¡¾e pœô ùekáœô¡¾ka je spojitá, musí bıt spojitá také smœô »rnice struny. Struna tedy musí splœô èovat následující œô ­tveœô ùici podmínek
\begin{itemize}
\item struna musí bıt na nebo nad pœô ùekáœô¡¾kou
\item struna musí mít zápornou nebo nulovou kœô ùivost
\item struna musí bıt spojitá
\item smœô »rnice struny musí bıt spojitá
\end{itemize}
Jsou-li vıœô¡¡e uvedené podmínky splnœô »ny, lze dokázat, œô¡¾e problém pœô ùekáœô¡¾ky má právœô » jedno œô ùeœô¡¡ení. Aœô ­koliv je struna a její smœô »rnice spojitá, mœô¡¯œô¡¾e její kœô ùivost (a tím pádem také její druhá derivace) vykazovat nespojitosti.

\section{Americká opce jako problém obecné hraniœô ­ní podmínky}

Lze dokázat, œô¡¾e problém ocenœô »ní americké opce lze jednoznaœô ­nœô » formulovat sérií podmínek podobnıch tœô »m, které jsme uvádœô »li v pœô ùípadœô » problému pœô ùekáœô¡¾ky. Jedná se o následující podmínky
\begin{itemize}
\item hodnota opce musí bıt vœô »tœô¡¡í nebo rovna vnitœô ùní hodnotœô » opce
\item Black-Scholes rovnice je nahrazena nerovností (viz. dále)
\item hodnota opce musí bıt spojitou funkcí ceny podkladového aktiva $S$
\item delta opce, tj. její smœô »rnice, musí bıt spojitá
\end{itemize}
První z tœô »chto podmínek vyluœô ­uje moœô¡¾nost arbitráœô¡¾e. Bezrizikovı vınos z pœô ùípadného pœô ùedœô ­asného uplatnœô »ní opce musí bıt nulovı nebo zápornı\footnote{To ovœô¡¡em neznamená, œô¡¾e by americká opce nemœô »la bıt nikdy pœô ùedœô ­asnœô » uplatnœô »na.}. Jestliœô¡¾e je tedy hodnota opce rovna její vnitœô ùní hodnotœô », je optimální opci uplatnit; v pœô ùípadœô », œô¡¾e je hodnota opce vyœô¡¡œô¡¡í, splœô èuje Black-Scholes rovnici a je naopak optimální ji drœô¡¾et. První dvœô » podmínky tak lze spojit do jedné nerovnosti. Jedná se o Black-Scholes nerovnost a tato druhá podmínka tak v sobœô » zahrnuje také první z podmínek.

Tœô ùetí podmínka poœô¡¾adující spojitost hodnoty opce jako funkce $S$, opœô »t vychází z podmínky neexistence arbitráœô¡¾e. Jestliœô¡¾e by hodnota opce byla nespojitou funkcí $S$, pak by bylo moœô¡¾né sestavit takové portfolio, které by generovalo bezrizikovı vınos v bodœô » nespojitosti.

Stejnœô » jako v pœô ùípadœô » problému pœô ùekáœô¡¾ky ani v pœô ùípadœô » americké opce neznáme dopœô ùedu hodnotu $S_f$. Abychom mohli jednoznaœô ­nœô » urœô ­it hodnotu opce, je tak nutné pro $S_f$ stanovit dvœô » dodateœô ­né podmínky. První podmínkou je poœô¡¾adavek spojitosti hodnoty americké opce jako funkce $S$. Druhou podmínkou vıœô¡¡e definovaná œô ­tvrtá podmínka poœô¡¾adující, aby delta pœô ùísluœô¡¡né opce byla také spojitou funkcí $S$. Odvození této podmínky je vœô¡¡ak relativnœô » obtíœô¡¾né a pœô ùesnı postup pœô ùesahuje rozsah této knihy.

\subsection{Americká prodejní opce}

Uvaœô¡¾ujme americkou prodejní opci s hodnotou $P(S,t)$, vnitœô ùní hodnotu této opce definovanou jako $\max(E - S, 0)$ a hraniœô ­ní cenu $S_f$. Je-li cena podkladového aktiva niœô¡¾œô¡¡í neœô¡¾ $S_f$, je racionální opci uplatnit; v opaœô ­ném pœô ùípadœô » je naopak racionální opci drœô¡¾et. Vzhledem k nerovnosti $P(S,t) \ge \max(E - S, 0)$ je tedy bod $S_f$ bodem, kde se funkce $P(S,t)$ dokıká funkce $\max(E - S, 0)$. Protoœô¡¾e $S_f > E$, je smœô »rnice funkce $\max(E - S, 0)$ v tomto bodœô » rovna -1. Smœô »rnice hodnoty opce\footnote{Pœô ùipomeœô ème, œô¡¾e smœô »rnice hodnoty opce je její deltou.} definovaná jako $\partial P / \partial S$ mœô¡¯œô¡¾e mít v tomto bodœô » hodnotu\footnote{Od moœô¡¾nosti, œô¡¾e smœô »rnice hodnoty opce v tomto bodœô » není definovaná, prozatím odhlédnœô »me.}
\begin{itemize}
\item menœô¡¡í neœô¡¾ -1
\item vœô »tœô¡¡í neœô¡¾ -1
\item rovnu -1
\end{itemize}
Lze dokázat, œô¡¾e první dvœô » moœô¡¾nosti nejsou sluœô ­itelné s teorií oceœô èování americké opce.

Nejprve uvaœô¡¾ujme situaci $\partial P / \partial S < -1$, kterou ilustruje kœô ùivka (a) níœô¡¾e uvedeného obrázku. Hodnota opce $P(S,t)$ protíná vnitœô ùní hodnotu opce $\max(E - S, 0)$ v bodœô » $S = S_f^{(a)}$. Jestliœô¡¾e se $S$ infinitizimálnœô » zvıœô¡¡í, hodnota opce $P(S,t)$ klesne pod vnitœô ùní hodnotu opce, protoœô¡¾e smœô »rnice hodnoty opce je menœô¡¡í neœô¡¾ -1, kdeœô¡¾to smœô »rnice vnitœô ùní hodnoty opce je rovna -1. To vœô¡¡ak popírá podmínku $P(S,t) \ge \max(E - S, 0)$, a proto mœô¡¯œô¡¾eme tuto moœô¡¾nost vylouœô ­it.

Dále uvaœô¡¾ujme druhou variantu $\partial P / \partial S > -1$, kterou ilustruje kœô ùivka (b). V tomto pœô ùípadœô » lze dokázat, œô¡¾e hodnota opce není z pohledu jejího vlastníka optimální. Nepœô ùedstavuje totiœô¡¾ nejvyœô¡¡œô¡¡í moœô¡¾nou hodnotu, která je konzistentní s Black-Scholes koncepcí bezrizikového zajiœô¡¡tœô »ní a podmínkou $P(S,t) \ge \max(E - S, 0)$. Uvaœô¡¾ujme stratetii uplatnœô »nou majitelem opce. V rámci této strategie existují dva aspekty, které je tœô ùeba brát v potaz. Prvním je zajiœô¡¡tœô »ní portfolia provádœô »né na denní bázi vedoucí k Black-Scholes rovnici. Tento aspekt je obsahuje také evropská opce. Druhım aspektem je moœô¡¾nost pœô ùedœô ­asného uplatnœô »ní opce. Majitel opce se musí stanovit cenu podkladového aktiva, od které je optimální opci uplatnit. Hodnotícím kritériem je pœô ùitom maximalizace hodnoty opce z pohledu majitele. Protoœô¡¾e hodnota opce splœô èuje parciální diferenciální rovnici s hraniœô ­ní podmínkou $P(S_f(t),t) = E - S_f(t)$, ovlivní volba $S_f$ hodnotu opce $P(S,t)$ pro vœô¡¡echna $S > S_f$. Je zœô ùejmé, œô¡¾e kœô ùivka (a) pœô ùedstavuje pœô ùíliœô¡¡ malou hodnotu $S_f$, kdy bezrizikového vınosu je moœô¡¾né dosáhnout pro hodnoty $S$ je nepatrnœô » vœô »tœô¡¡í neœô¡¾ $S_f$. Naproti tomu kœô ùivka (b) ilustruje problém pœô ùíliœô¡¡ vysoké hodnoty $S_f$. Pro $\partial P / \partial S > -1$ mœô¡¯œô¡¾e bıt oproti bodu $S = S_f^{(b)}$ hodnota opce zvıœô¡¡ena pouhım sníœô¡¾ením hodnoty $S_f$. Zvıœô¡¡ení hodnoty opce se prostœô ùednictvím particiální diferenciální rovnice promítne do vœô¡¡ech hodnot $S$ vœô »tœô¡¡ích neœô¡¾ $S_f$. Funkce hodnoty americké opce tak mœô »ní tvar pœô ùi kaœô¡¾dé zmœô »nœô » $S_f$. Postupnım sniœô¡¾ováním $S_f$ bychom zkonvergovali k bodu $S_f$ mezi $S_f^{(a)}$ a $S_f^{(b)}$, pro kterı by platilo $\partial P / \partial S = -1$. Tento bod souœô ­asnœô » maximalizuje hodnotu opce z pohledu majitele a zároveœô è nevytváœô ùí prostor pro pœô ùípadnou arbitráœô¡¾. 

\begin{center}
	\begin{pspicture}(0,0)(9.0,6.5)
        \rput(4.5,0.2){Hraniœô ­ní cena (a) pœô ùíliœô¡¡ nízká (b) pœô ùíliœô¡¡ vysoká}

		\psline(0.5,1.0)(8.5,1.0)
        \psline(0.5,1.0)(0.5,6.0)

        \psline[linewidth=0.5mm](0.5,5.5)(5.0,1.0)(8.0,1.0)
        \pscurve(0.8,5.5)(2.2,2.5)(7.0,1.3)
        \psline[linestyle=dotted](0.9,5.1)(0.9,1.0)
        \pscurve(2.2,3.5)(4.0,2.8)(7.0,2.5)
        \psline[linestyle=dotted](2.75,3.2)(2.75,1.0)
        
        \rput(5.0,0.8){\small{$E$}}
        \rput(0.9,0.7){\small{$S_f^{(a)}$}}
        \rput(2.8,0.7){\small{$S_f^{(b)}$}}
        \rput(5.0,0.8){\small{$E$}}
        \rput(8.5,0.8){\small{$S$}}
        \rput(2.0,2.2){\small{$(a)$}}
        \rput(5.0,3.0){\small{$(b)$}}
        \rput(2.5,4.8){\small{$\max(E - S,0)$}}
	\end{pspicture}
\end{center}

Je tœô ùeba zdœô¡¯raznit, œô¡¾e vıœô¡¡e uvedenı argument není rigorózním odvozením druhé volné hraniœô ­ní podmínky. Pro úœô ­ely této knihy vœô¡¡ak bude staœô ­it pœô ùedpoklad, œô¡¾e racionální majitel americké opce sleduje strategii, která povede k tomu, œô¡¾e se hodnota opce, jako hladká funkce promœô »nné $S$, dotkne funkce vnitœô ùní hodnoty opce za pœô ùedpokladu, œô¡¾e tato je také hladká.

Nyní se opœô »t vraœô¡¥me ke druhému omezení zmiœô èovaném pœô ùi oceœô èování americké opce, totiœô¡¾ Black-Scholes nerovnici. Pœô ùipomeœô ème, œô¡¾e Black-Scholes rovnice je zaloœô¡¾ena na pœô ùedpokladu neexistence arbitráœô¡¾e, kdy je riziko portfolia skládajícího z opce a odpovídajícího podkladového aktiva zcela eliminováno kontinuálním zajiœô¡¡œô¡¥ováním. Pœô ùedpoklad neexistence arbitráœô¡¾e platí v pœô ùípadœô » Black-Scholes nerovnice pouze œô ­ásteœô ­nœô », aœô ­koliv tœô »sná vazba mezi pœô ùedpokladem neexistence arbitráœô¡¾e a touto nerovnicí stále existuje.

Stejnœô » jako v pœô ùípadœô » odvození Black-Scholes rovnice pro evropskou opci uvaœô¡¾ujme delta neutrální portfolio
\begin{equation*}
\Pi = V - \Delta S
\end{equation*}
V pœô ùípadœô » americké opce nemusí bıt vœô¡¾dy moœô¡¾né souœô ­asnœô » drœô¡¾et dlouhou a krátkou pozici v dané opci. V nœô »kterıch situacích je totiœô¡¾ optimální opci pœô ùedœô ­asnœô » uplatnit. Vypisovatel opce tak mœô¡¯œô¡¾e bıt vyzván k plnœô »ní z opce pœô ùed její splatností. Jednoduchı argument o neexistenci arbitráœô¡¾e pouœô¡¾itı pro evropskou opci tak nevede k jednoznaœô ­né hodnotœô » vınosu portfolia. Jediné, co jsme schopni œô ùíci, je, œô¡¾e tento vınos nemœô¡¯œô¡¾e bıt vœô »tœô¡¡í neœô¡¾ bezriziková vınosová míra. Pro americkou prodejní opci tak platí
\begin{equation*}
\frac{\partial P}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 P}{\partial S^2} + rS \frac{\partial P}{\partial S} - rP \le 0
\end{equation*}
Hodnotu americké prodejní opce lze popsat pomocí problému volné hraniœô ­ní podmínky. Pro kaœô¡¾dé $t$ musíme rozdœô »lit hodnoty $S$ na dvœô » disjunktní mnoœô¡¾iny. První mnoœô¡¾ina je definovaná jako $0 \le S \le S_f(t)$ a je pro ní optimální opci pœô ùedœô ­asnœô » uplatnit. Pro americkou projední opci na této mnoœô¡¾inœô » platí
\begin{equation*}
P = E - S,~~~\frac{\partial P}{\partial t}+\frac{1}{2}\sigma^2S^2\frac{\partial^2 P}{\partial S^2} + rS\frac{\partial P}{\partial S} - rP < 0
\end{equation*}
V rámci druhé mnoœô¡¾iny $S_f(t) < S < \infty$ není pœô ùedœô ­asné uplatnœô »ní opce optimální a
\begin{equation*}
P > E - S,~~~\frac{\partial P}{\partial t}+\frac{1}{2}\sigma^2S^2\frac{\partial^2 P}{\partial S^2} + rS\frac{\partial P}{\partial S} - rP = 0
\end{equation*}
Hraniœô ­ní podmínka v bodœô » $S = S_f(t)$ œô ùíká, œô¡¾e hodnota opce $P$ a její delta jsou spojité.
\begin{equation*}
P(S_f(t),t) = \max(E - S_f(t),0),~~~ \frac{\partial P}{\partial S}(S_f(t),t) = -1
\end{equation*}
Tyto podmínky lze povaœô¡¾ovat za jednu hraniœô ­ní podmínku, pœô ùiœô ­emœô¡¾ druhá podmínka urœô ­uje umístœô »ní volné hranice. Je dœô¡¯leœô¡¾ité si uvœô »domit, œô¡¾e podmínka
\begin{equation*}
\frac{\partial P}{\partial S}(S_f(t),t) = -1
\end{equation*}
není implikovaná skuteœô ­ností $P(S_f(t),t) = E - S_f(t)$. Protoœô¡¾e dopœô ùedu neznáme umístœô »ní bodu $S_f(t)$, potœô ùebujeme dalœô¡¡í podmínku, která by specifikovala jeho umístœô »ní. Touto podmínkou je právœô » poœô¡¾adavek spojité delty pœô ùísluœô¡¡né opce.

V následujícím obrázku porovnáváme hodnoty evropské a americké prodejní opce se zbytkovou splatností $T = 0.5$, smœô »rodatnou odchylkou $\sigma = 0.4$ a bezrizikovou úrokovou mírou $r = 0.1$.
\begin{center}
  \begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Porovnání hodnoty evropské (dolní kœô ùivka) a americké opce}
        \rput(4.0,0.0){(horní kœô ùivka) jako funkce $S$: $T$ = 0.5, $\sigma$ = 0.4, $r$ = 0.1}

		\psline[arrows=->](0.5,1.5)(7.5,1.5)
		\psline[arrows=->](0.5,1.5)(0.5,6.0)

        \psline(0.5,5.5)(4.5,1.5)
        \pscurve[linewidth=0.5mm](0.5,5.2)(4.0,1.9)(4.5,1.7)(5.5,1.6)(6.5,1.55)
        \psline[linewidth=0.5mm](0.5,5.5)(3.8,2.2)
        \pscurve[linewidth=0.5mm](3.8,2.2)(4.5,1.7)(5.5,1.6)(6.5,1.55)

        \rput(0.5,1.2){\small{0}}
        \rput(4.5,1.2){\small{E}}
        \rput(7.5,1.2){\small{S}}
        \rput(0.2,6.0){\small{P}}
	\end{pspicture}
\end{center}

\section{Technická poznámka: Volná hraniœô ­ní podmínka}

Je tœô ùeba zdœô¡¯raznit, œô¡¾e obœô » hraniœô ­ní podmínky nutné pro stanovení hodnoty americké prodejní opce jsou zaloœô¡¾eny na neexistenci arbitráœô¡¾e. Existuje vœô¡¡ak nespoœô ­et dalœô¡¡ích kandidátœô¡¯ na volné hraniœô ­ní podmínky, které je moœô¡¾né z œô ­istœô » matematického pohledu pouœô¡¾ít. Aœô ­koliv nevedou k œô ùeœô¡¡ení hodnoty americké opce, pœô ùedstavují z matematického hlediska správnœô » definovanı problém. Jako pœô ùíklady uveœô ¯me
\begin{equation*}
\frac{\partial P}{\partial S}(S_f(t),t) = 0
\end{equation*}
je-li
\begin{equation*}
P(S_f(t),t) = E - S_f(t)
\end{equation*}
popœô ù. podmínku
\begin{equation*}
\frac{\partial P}{\partial S}(S_f(t),t) = - \frac{d S_f}{d t}
\end{equation*}
Druhá z uvedenıch podmínek pœô ùedstavuje hraniœô ­ní podmínku Stefanova modelu pro tání ledu. Z pohledu americké opce je vœô¡¡ak tato podmínka zavádœô »jící.

\section{Ostatní americké opce}

Argumenty, které jsem pouœô¡¾ili pro americkou prodejní opci, lze s pœô ùíluœô¡¡nımi úpravami pouœô¡¾ít také pro ostatní typy plain-vanilla opcí (vœô ­etnœô » jejich lineárních kombinací) s vıplatnou definovanou jako $\Lambda(S)$ nebo dokonce $\Lambda(S,t)$. Hodnota opce musí splœô èovat Black-Scholes nerovnost
\begin{equation*}
\frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + (r - D_0) S \frac{\partial V}{\partial S} - rV \le 0
\end{equation*}
Je-li pœô ùedœô ­asné uplatnœô »ní opce optimální, platí $V(S,t) = \Lambda(S)$ a nerovnost se stane ostrou.
\begin{equation*}
\frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + (r - D_0) S \frac{\partial V}{\partial S} - rV < 0
\end{equation*}
Není-li pœô ùedœô ­asné uplatnœô »ní opce optimální, platí $V(S,t) > \Lambda(S)$ a nerovnost se zmœô »ní v rovnost.
\begin{equation*}
\frac{\partial V}{\partial t} + \frac{1}{2} \sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + (r - D_0) S \frac{\partial V}{\partial S} - rV = 0
\end{equation*}
 V bodœô » hraniœô ­ní podmínky (popœô ù. podmínek, je-li vıplatní profil opce dostateœô ­nœô » sloœô¡¾itı) musí bıt funkce $V$ a $\partial V / \partial S$ spojité. Specifikace problému je zkompletována stanovením koneœô ­né podmínky
\begin{equation*}
V(S,T) = \Lambda(S)
\end{equation*}
a stanovením vhodnıch podmínek v nekoneœô ­nu. Pœô ùíklady tœô »chto diferenciálních nerovnic uvedeme v následujících kapitolách zabıvajících se exotickımi opcemi.

\section{Technická poznámka: Opce s nespojitou vıplatní funkcí}

Vnitœô ùní hodnota opce mœô¡¯œô¡¾e bıt teœô ­nou k funkci hodnoty opce pouze, je-li v bodœô » dotyku definována. Jako pœô ùíklad uvaœô¡¾ujme americkou cash-or-nothing kupní opci s vıplatou definovanou jako
\begin{equation*}
V(S,T) = 0,~~~S < E
\end{equation*}
\begin{equation*}
V(S,T) = B,~~~S \ge E
\end{equation*}
Vnitœô ùní hodnota tedy není spojitou funkcí. Hodnota opce je vœô¡¡ak s vyjímkou splatnosti spojitá a její delta je nespojitá v bodœô » $S = E$. Je zœô ùejmé, œô¡¾e hraniœô ­ní cena, od které je opci vœô¡¾dy optimální pœô ùedœô ­asnœô » uplatnit, je $S_f = E$. Majitel opce totiœô¡¾ nezíská œô¡¾ádnı dodateœô ­nı prospœô »ch z drœô¡¾ení opce po té, co cena podkladového aktiva dosáhne realizaœô ­ní ceny. Naopak ztrácí pœô ùípadnı úrok získanı z pœô ùedœô ­asné vıplaty ve vıœô¡¡i $B$. Není tedy dœô¡¯vod zajiœô¡¡œô¡¥ovat se proti situaci $S > E$. Je zœô ùejmé, œô¡¾e $\Delta = 0$ pro $S > E$ a $\Delta > 0$ pro $S < E$. 

Z analızy tohoto typu americké opce vyplıvá existence vıplatní podmínky $V(S,T) = 0$ pro $0 \le S \le E$ a dvou hraniœô ­ních podmínek $V(0,t) = 0$ a $V(E,t) = B$. Situací $S > E$ se není tœô ùeba zaobírat, protoœô¡¾e opce je pœô ùedœô ­asnœô » uplatnœô »na. Narozdíl od obvyklıch americkıch opcí, kde jsou hraniœô ­ní podmínky aplikované na neznámou hodnotu $S$, coœô¡¾ vede k nutnosti dodateœô ­né podmínky, jsou v pœô ùípadœô » americké cash-or-nothing opce hraniœô ­ní podmínky specifikovány pro známou hodnotu $S$. Tyto tœô ùi podmínky tak vedou k jednoznaœô ­nému œô ùeœô¡¡ení Black-Scholes rovnice.

Americká cash-or-nothing opce dobœô ùe ilustruje myœô¡¡lenku, œô¡¾e realizaœô ­ní strategie by mœô »la maximalizovat její hodnotu pro majitele opce. Je zœô ùejmé, œô¡¾e volba $S_f(t) = E$ dává nejvœô »tœô¡¡í hodnoty pro $V(S,t)$ pro $S < E$, jak ilustruje následující obrázek.
\begin{center}
  \begin{pspicture}(0,0)(8.0,7.0)
		\rput(4.0,1.0){Porovnání hodnoty evropské (dolní kœô ùivka) a americké}
        \rput(4.0,0.5){(horní kœô ùivka) cash-or-nothing opce jako funkce $S$}
        \rput(4.0,0.0){$T$ = 1.0, $\sigma$ = 0.4, $r$ = 0.1, $E$ = 10, $B$ = 5, $D$ = 0.02}

		\psline[arrows=->](0.5,2.0)(7.5,2.0)
		\psline[arrows=->](0.5,2.0)(0.5,6.7)

        \pscurve[linewidth=0.5mm](0.5,2.0)(1.5,2.2)(3.9,5.7)(7.0,6.1)

        \pscurve[curvature=2 0.1 0, linewidth=0.5mm](0.5,2.0)(1.18,2.17)(1.5,2.52)
        \psline[linewidth=0.5mm](1.5,2.52)(3.25,6.5)(7.0,6.5)

        \psline[linestyle=dotted](3.25,1.9)(3.25,6.5)

        \rput(0.5,1.7){\small{0}}
        \rput(3.3,1.7){\small{E}}
        \rput(7.5,1.7){\small{S}}
        \rput(0.2,6.5){\small{P}}
	\end{pspicture}
\end{center}

\section{Lineární komplementarita}

Z vıœô¡¡e œô ùeœô ­eného je patrné, œô¡¾e matematická analıza americké opce je komplikovanœô »jœô¡¡í neœô¡¾ analıza evropské opce. Aœô¡¾ na vyjímky je pomœô »rnœô » sloœô¡¾ité najít explicitní œô ùeœô¡¡ení problému volné hraniœô ­ní podmínky. Primární snahou je tak nalézt efektivní a robustní numerické metody pro stanovení tœô »chto œô ùeœô¡¡ení. To s sebou pœô ùináœô¡¡í potœô ùebu teoretického rámce, kterı umoœô¡¾ní analyzovat problematiku volné hraniœô ­ní podmínky v obecné rovinœô ».

Prvním krokem bude snaha o pœô ùeformulování problému s cílem zbavit se explicitní závislosti na volnıch hranicích. Volná hranice tak pœô ùímo nevstupuje do procesu hledání œô ùeœô¡¡ení a mœô¡¯œô¡¾e z nœô »j bıt po jeho nalezení zpœô »tnœô » získána. V naœô¡¡ich úvahách zaœô ­neme zabıvat vıœô¡¡e diskutovanım problémem pœô ùekáœô¡¾ky s jednoduchım pœô ùípadem takovéto reformulace, tzv. lineární komplementaritou. Následnœô » pouœô¡¾ijeme takto získané poznatky pœô ùi oceœô èování americkıch opcí.

\subsection{Problém pœô ùekáœô¡¾ky - lineární komplementarita}

Vraœô¡¥me se k problému pœô ùekáœô¡¾ky diskutovanému v pœô ùedchozí kapitole. Pœô ùedpokládejme, œô¡¾e konce struny se nachází v bodech $x = \pm 1$. Nechœô¡¥ funkce $u(x)$ popisuje pozici struny a funce $f(x)$ vıœô¡¡ku pœô ùekáœô¡¾ky, obœô » na definiœô ­ním oboru $x = \pm 1$.
Pœô ùedpokládejme, œô¡¾e $f(\pm1) < 0$ a œô¡¾e existuje alespoœô è jedno $-1 \le x \le 1$, pro které platí $f(x) > 0$. To znamená, œô¡¾e existuje neprázdná mnoœô¡¾ina bodœô¡¯, ve kterıch se struna dotıká pœô ùekáœô¡¾ky. Dále pœô ùedpokládejme, œô¡¾e $f'' < 0$, kde $' = d/dx$, coœô¡¾ implikuje existenci pouze jedné takovéto mnoœô¡¾iny. Volná hranice je pak mnoœô¡¾inou bodœô¡¯ oznaœô ­ovanıch jako $P(x = x_p)$ a $Q(x = x_q)$ v obrázku (7.1). Jedná se o body, ve kterıch se struna prvnœô » dotıká pœô ùekáœô¡¾ky. Body $P$ a $Q$ tak vymezují oblast dotyku. Pozice tœô »chto bodœô¡¯ není dopœô ùedu známá a její urœô ­ení je pœô ùedmœô »tem œô ùeœô¡¡ení.

V oblasti dotyku platí $u(x) = f(x)$. Pro vœô¡¡echna $x$, ve kterıch se struna pœô ùekáœô¡¾ky nedotıká, platí $u'' = 0$. Tato podmínka znamená, œô¡¾e struna je pro tyto hodnoty $x$ napnutá. Standardnœô » jsou pro urœô ­ení napnuté œô ­ásti struny zapotœô ùebí pouze dvœô » hraniœô ­ní podmínky a hodnoty $u(x)$ na jejích obou koncích. Tyto podmínky jsou souœô ­ástí vychozích pœô ùedpokladœô¡¯, kde $u(-1) = 0$, $u(x_P) = f(x_p)$ a $u(1) = 0$, $u(x_Q) = f(x_Q)$. Nicménœô » protoœô¡¾e body $P$ a $Q$ nejsou známy, je zapotœô ùebí dalœô¡¡ích dvou podmínek. Agrumentace zaloœô¡¾ená na fyzikální rovnováze sil definuje tyto podmínky jako nutnost spojitosti funkcí $u(x)$ a $u'(x)$ v bodech $P$ a $Q$. Problém pœô ùekáœô¡¾ky tak lze zformulovat jako problém nalezení funkce $u(x)$ a bodœô¡¯ $P$ a $Q$ pœô ùi splnœô »ní následujících podmínek
\begin{equation}
u(-1) = 0
\end{equation}
\begin{equation}
u''(x) = 0,~~~ -1 < x < x_P
\end{equation}
\begin{equation}
u(x_P) = f(x_P),~~~u'(x_P) = f'(x_P)
\end{equation}
\begin{equation}
u(x) = f(x),~~~x_P < x < x_Q
\end{equation}
\begin{equation}
u(x_Q) = f(x_Q),~~~u'(x_Q) = f'(x_Q)
\end{equation}
\begin{equation}
u''(x) = 0,~~~ x_Q < x < 1
\end{equation}
\begin{equation}
u(1) = 0
\end{equation}
Jestliœô¡¾e máme funkci $f(x)$, která má stejnı obecnı tvar jako na obrázku (7.1), lze dokázat, œô¡¾e $u(x)$, $P$ a $Q$ jsou jednoznaœô ­nœô » urœô ­ené vıœô¡¡e uvedenımi podmínkami a nalézt je. Nicménœô » œô ùeœô¡¡ení je pomœô »rnœô » pracné a body $P$ a $Q$ musí bıt, aœô¡¾ na pœô ùípady triviální funkce $f(x)$, vypoœô ­teny numericky jako œô ùeœô¡¡ení algeraické popœô ù. transcedentální rovnice. œô øeœô¡¡ení se jeœô¡¡tœô » více zkomplikuje v pœô ùípadœô », kdy $f''(x)$ není vœô¡¾dy menœô¡¡í nebo rovno nule a to z dœô¡¯vodu moœô¡¾né existence víreca oblastí kontaktu. Nicménœô » v i tœô »chto pœô ùípadech je principiálnœô » moœô¡¾né œô ùeœô¡¡ení nalézt.

Alternativním pœô ùístupem je uvœô »domit si, œô¡¾e struna se nachází buœô ¯to nad pœô ùekáœô¡¾kou ($u(x) > f(x)$) a v tomto pœô ùípadœô » je napnutá ($u''(x) = 0$) nebo se pœô ùekáœô¡¾ky dotıká ($u(x) = f(x)$) a v tomto pœô ùípadœô » pœô ùekáœô¡¾ku kopíruje ($u''(x) = f''(x) < 0$). To znamená, œô¡¾e jsem schopni tento problém pœô ùeformulovat do podoby problému lineární komplementarity\footnote{Obecnı problém
\begin{equation*}
\mathcal{AB} = 0,~~~\mathcal{A} \ge 0, \mathcal{B} \ge 0 
\end{equation*}
nazıváme komplementárním problémem a v naœô¡¡em konkrétním pœô ùípadœô » platí $\mathcal{A} = u''$ a $\mathcal{B} = u - f$, pœô ùiœô ­emœô¡¾ jak $\mathcal{A}$ tak $\mathcal{B}$ jsou lineární v $u$ a $f$.
}
\begin{equation*}
u'' (u - f) = 0,~~~-u'' \ge 0,~(u - f) \ge 0
\end{equation*}
za pœô ùedpokladu $u(\pm 1) = 0$ a spojitosti funkcí $u$ a $u'$.

Takto pœô ùeformulovanı problém má v porovnání s pœô¡¯vodním problémem definovanım sérií podmínek (7.1) - (7.7) jednu znaœô ­nou vıhodu - explicitnœô » neobsahuje volné body $P$ a $Q$. Volné body jsou v definici problému stále pœô ùítomné, avœô¡¡ak pouze implicitnœô » skrze podmínku $u \ge f$. Jestliœô¡¾e budeme schopni vyvinout algoritmus, kterı by umoœô¡¾nil œô ùeœô¡¡ení problému lineární komplementarity, staœô ­í následnœô » pouze analyzovat hodnoty $u - f$. Volné hraniœô ­ní body jsou tam, kde se hodnota této funkce mœô »ní z nulové na nenulovou. Jedním z takovıchto alogoritmœô¡¯ je napœô ù. SOR algoritmus, kterı je popsán v kapitole 9. V rámci této metody se nejprve stanoví poœô ­áteœô ­ní odhad funkce $u$ takovı, œô¡¾e zcela jistœô » platí $u > f$, a postupnœô » se iteruje ke správnému œô ùeœô¡¡ení. Omezení je implementováno tak, œô¡¾e pœô ùi vygenerování hodnoty $u$ vœô »tœô¡¡í neœô¡¾ $f$ je hodnota $u$ nastavena na hodnotu $f$.

Dœô¡¯kaz, œô¡¾e lineární komplementarita je ekvivalentní problému volné hraniœô ­ní podmínky, pœô ùesahuje rámec této knihy. Pœô ùípadnı dœô¡¯kaz by vycházel z technik funkcionální analızy a œô ­ásteœô ­nœô » také z teorie variaœô ­ních nerovností. Nicménœô » nosnou myœô¡¡lenkou dœô¡¯kazu je minimalizace vhodného energetického funkcionálu nad konvexní mnoœô¡¾inou vœô¡¡ech pœô ùijetelnœô » hladkıch funkcí $v(x)$, které splœô èují podmínku $v \ge f$.

\subsection{Americká prodejní opce - lineární komplementarita}

V této kapitole se budeme zabıvat americkou prodejní opcí, kterou pœô ùeformulujeme do podoby problému lineární komplementarity. V zásadœô » jedinım vıraznœô »jœô¡¡ím rozdílem mezi problémem pœô ùekáœô¡¾ky a americkou prodejní opcí je skuteœô ­nost, œô¡¾e americká opce má navíc œô ­asovı rozmœô »r\footnote{Pojmem ``œô ­asovı rozmœô »r'' máme na mysli, œô¡¾e se poloha hraniœô ­ních bodœô¡¯ mœô »ní v œô ­ase.}. Problém americké opce tak lze rozdœô »lit na dvœô » œô ­ásti - na prostorovou a œô ­asovou, kde se prostorová œô ­ást zabıvá hraniœô ­ními body v urœô ­itı fixní œô ­asovı okamœô¡¾ik, kdeœô¡¾to œô ­asová œô ­ást se zabıvá jejich vıvojem v œô ­ase. To se pochopitelnœô » musí promítnou také do postupu œô ùeœô¡¡ení. Prostorovou œô ­ást œô ùeœô¡¡íme stejnœô » jako u klasického problému pœô ùekáœô¡¾ky pomocí SOR algoritmu; œô ­asová œô ­ást slouœô¡¾í k nalezení œô ùeœô¡¡ení v dílœô ­ích œô ­asovıch okamœô¡¾icích.

Nejprve stejnœô » jako v pœô ùípadœô » evropské opce pœô ùevedeme problém americké prodejní opce z pœô¡¯vodních promœô »nnıch $(S,t)$ na promœô »nné $(x, \tau)$. Jedinım rozdílem je, œô¡¾e v pœô ùípadœô » americké opce figuruje navíc tzv. hranice optimální realizace. Ta byla v pœô¡¯vodním vyjádœô ùení tvoœô ùena body $S = S_f(t)$. Po transformaci promœô »nnıch budeme tuto hranici znaœô ­it jako $x = x_f(\tau)$. Vzhledem k $S_f(x) < E$ a transformaci $S_f(t) = E e^{x_f(\tau)}$, platí $x_f(\tau) < 0$. Funkce vnitœô ùní hodnoty opce $\max(E - S, 0)$ pœô ùejde do tvaru
\begin{equation*}
g(x, \tau) = e^{\frac{1}{2}(k + 1)^2 \tau}\max(e^{\frac{1}{2}(k - 1)x} - e^{\frac{1}{2}(k + 1)x}, 0)
\end{equation*}
Získáváme tak
\begin{equation}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2},~~~x > x_f(\tau)
\end{equation}
\begin{equation}
u(x, \tau) = g(x, \tau),~~~x \le x_f(\tau)
\end{equation}
poœô ­áteœô ­ní podmínku
\begin{equation}
u(x, 0) = g(x, 0) = \max(e^{\frac{1}{2}(k + 1)x} - e^{\frac{1}{2}(k + 1)x},0)
\end{equation}
a hraniœô ­ní podmínku\footnote{Pro $x \rightarrow -\infty$ se nacházíme v oblasti cen podkladového aktiva, kde je optimální opci pœô ùedœô ­asnœô » uplatnit. Hraniœô ­ní podmínku proto nepotœô ùebujeme.}
\begin{equation}
\underset{x \rightarrow 0}{\lim} u(x, \tau) = 0
\end{equation}
Dále existuje omezení
\begin{equation}
u(x, \tau) \ge e^{\frac{1}{2}(k + 1)^2 \tau} \max(e^{\frac{1}{2}(k - 1)x} - e^{\frac{1}{2}(k + 1)x}, 0)
\end{equation}
a poœô¡¾adavek na spojitost funkcí $u$ a $\partial u / \partial x$ v bodœô » $x = x_f(t)$, kterı vychází z odpovídajících podmínek pœô¡¯vodní formulace problému.

Abychom se vyhnuli technickım komplikacím, omezme problém na koneœô ­nı interval. Tento pœô ùedpoklad je pœô ùijatelnı, protoœô¡¾e kaœô¡¾dé numerické œô ùeœô¡¡ení omezíme na koneœô ­nou síœô¡¥. To znamená, œô¡¾e problém (7.8) - (7.12) budeme aplikovat pouze na interval $-x^{-} < x < x^{+}$. To implikuje hraniœô ­ní podmínky
\begin{equation*}
u(x^{+}, \tau) = 0,~~~u(-x^{-}, \tau) = g(-x^{-}, \tau)
\end{equation*}
Pœô ùepokládáme tedy, œô¡¾e je moœô¡¾né nahradit hraniœô ­ní podmínky aproximací, podle které pro malá $S$ platí $P = E - S$, zatímco pro velká $S$ je $P = 0$.

Skuteœô ­nost, œô¡¾e jak problém pœô ùekáœô¡¾ky tak americká prodejní opce splœô èují obdobné omezující podmínky, naznaœô ­uje moœô¡¾nost pœô ùeformulovat americkou prodejní opci do podoby lineární komplementarity. Americké prodejní opce je velmi podobná problému pœô ùekáœô¡¾ky, s tím rozdílem, œô¡¾e se tvar pœô ùekáœô¡¾ky mœô »ní v prœô¡¯bœô »hu œô ­asu. Pœô ùipomeœô ème, œô¡¾e roli pœô ùekáœô¡¾ky zde plní vıplatní funkce $g(x, \tau)$. Problém (7.8) - (7.12) tak lze ve formœô » lineární komplementarity vyjádœô ùit jako
\begin{equation}
\Bigg( \frac{\partial u}{\partial r} - \frac{\partial^2 u}{\partial x^2}\Bigg) \cdot (u(x, \tau) - g(x, \tau)) = 0
\end{equation}
kde
\begin{equation*}
\Bigg( \frac{\partial u}{\partial r} - \frac{\partial^2 u}{\partial x^2}\Bigg) \ge 0,~~~(u(x, \tau) - g(x, \tau)) \ge 0
\end{equation*}
za pœô ùedpokladu splnœô »ní poœô ­áteœô ­ních hraniœô ­ních podmínek (7.10) a (7.13)
\begin{equation*}
u(x, 0) = g(x, \tau)
\end{equation*}
\begin{equation*}
u(-x^{-}, \tau) = g(-x^{-}, \tau),~~~u(x^{+}, \tau) = g(x^{+}, \tau) = 0
\end{equation*}
a poœô¡¾adavku na spojitost funkcí $u(x, \tau)$ a $\frac{\partial u}{\partial x}(x, \tau)$.

Dvœô » moœô¡¾ná œô ùeœô¡¡ení rovnice (7.13) odpovídají situaci, kdy je optimální opci uplatnit ($u = g$), a situaci, kdy naopak není optimální opci uplatnit ($u > g$). Na závœô »r pouze zopakujme, œô¡¾e velkou vıhodou reformulace problému je, œô¡¾e není zapotœô ùebí se explicitnœô » zabıvat volnou hraniœô ­ní podmínkou resp. podmínkami.

Stejnœô » jako v pœô ùípadœô » problému pœô ùekáœô¡¾ky, i v pœô ùípadœô » americké prodejní opce je pomœô »rnœô » sloœô¡¾ité dokázat, œô¡¾e reformulace do podoby lineární komplementarity je konzistentní s pœô¡¯vodním zadáním problému a œô¡¾e existuje pouze jedno jedineœô ­né œô ùeœô¡¡ení, které je spoleœô ­né obœô »ma problémœô¡¯m. Pro pœô ùípadnı dœô¡¯kaz bychom opœô »t pouœô¡¾ili funkœô ­ní analızu a parabolické variaœô ­ní nerovnosti.

\section{Americká kupní opce s dividendou}

Uvaœô¡¾ujme americkou kupní opci s podkladovım aktivem, které vyplácí dividendu. Pœô ùipomeœô ème, œô¡¾e hodnota $C(S,t)$ kupní opce splœô èuje rovnici
\begin{equation}
\frac{\partial C}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 C}{\partial S^2} + (r - D_0)S\frac{\partial C}{\partial S} - rC = 0
\end{equation}
pokud není optimální opci pœô ùedœô ­asnœô » uplatnit. Vıplata generovaná opcí na konci œô¡¾ivotnosti je pak
\begin{equation}
C(S,T) = \max(S - E, 0)
\end{equation}
a protoœô¡¾e opce mœô¡¯œô¡¾e bıt uplatnœô »na kdykoliv bœô »hem své œô¡¾ivotnosti musí také platit
\begin{equation}
C(S,t) \ge \max(S - E, 0)
\end{equation}
Jestliœô¡¾e existuje hraniœô ­ní cena $S = S_f(t)$, v tomto bodœô » platí
\begin{equation}
C(S_f(t),t) = S_f(t) - E
\end{equation}
\begin{equation}
\frac{\partial C}{\partial S}(S_f(t),t) = 1
\end{equation}
Navíc existuje-li hraniœô ­ní cena, pak je (7.14) platná pouze pro $C(S, t) > \max(S - E, 0)$. Pœô ùímım vıpoœô ­tem lze dokázat, œô¡¾e $\max(S - E, 0)$ není œô ùeœô¡¡ením Black-Scholes rovnice (7.14). Rovnici (7.14) lze stejnœô » jako v pœô ùípadœô » americké prodejní opce nahradit nerovností
\begin{equation*}
\frac{\partial C}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 C}{\partial S^2} + (r - D_0)S\frac{\partial C}{\partial S} - rC \le 0
\end{equation*}
kdy rovnost platí pouze pro $C(S,t) > \max(S - E, 0)$. Finanœô ­ním dœô¡¯vodem pœô ùedœô ­asného uplatnœô »ní opce je opœô »t maximalizace její hodnoty. Pokud by tak opce byla drœô¡¾ena do splatnosti, je její oœô ­ekávaná souœô ­asná hodnota niœô¡¾œô¡¡í neœô¡¾ v pœô ùípadœô » pœô ùedœô ­asného uplatnœô »ní a investování vıplaty z opce za bezrizikovou úrokovou míru po zbytkovou dobu splatnosti.

\subsection{Obecné vısledky}

V následujícím textu budeme pœô ùedpokládát, œô¡¾e bezriziková úroková míra $r$ a dividendovı vınos $D_0$ splœô èují podmínku $r > D_0 > 0$. Stejnœô » jako v pœô ùípadœô » evropské kupní opce je vhodné pœô ùetrasformovat (7.14) - (7.18) do bezrozmœô »rné podoby a zredukovat (7.14) na dopœô ùednou diferenciální rovnici s konstantními koeficienty. S ohledem na navazující úpravy je také vhodné o ceny opce $C(S,t)$ odeœô ­íst vıplatu $S - E$. Pœô ùi pouœô¡¾ití substitucí
\begin{equation*}
S = Ee^x,~~~t = T - \tau / \frac{1}{2}\sigma^2,~~~C(S,t) = S - E + Ec(x,\tau)
\end{equation*}
tak získáváme
\begin{equation}
\frac{\partial c}{\partial \tau} = \frac{\partial^2 c}{\partial x^2} + (k' - 1)\frac{\partial c}{\partial x} - kc + f(x)
\end{equation}
pro $- \infty < x < \infty$ a $\tau > 0$, kde
\begin{equation*}
c(x, 0) = \max(1 - e^x, 0)
\end{equation*}
\begin{equation}
f(x) = (k' - k)e^x + k
\end{equation}
\begin{equation*}
k = \frac{r}{\frac{1}{2}\sigma^2},~~~k' = \frac{r - D_0}{\frac{1}{2}\sigma^2}
\end{equation*}
Protoœô¡¾e $r > D_0 > 0$, je $k > k' > 0$.
\begin{center}
  \begin{pspicture}(0,0)(8.0,4.5)
		\rput(4.0,0.0){Prœô¡¯bœô »h funkce $c(x,0)$}
       
		\psline(0.5,1.0)(7.5,1.0)

        \pscurve[linewidth=0.5mm](0.5,3.5)(2.6,2.5)(4.0,1.0)
        \psline[linewidth=0.5mm](4.0,1.0)(7.5,1.0)

        \rput(7.5,1.2){\small{$x$}}
        \rput(1.0,3.9){\small{$c(x,0)$}}
        \rput(4.0,0.8){\small{0}}
	\end{pspicture}
\end{center}
Pro tento okamœô¡¾ik pœô ùedpokládejme, œô¡¾e existuje volná hranice $x = x_f(\tau)$ ($S = S_f(t)$ dle pœô¡¯vodního znaœô ­ení). Vzhledem k $C(S,t) = S - E + Ec(x, \tau)$ pro tuto hranici platí
\begin{equation*}
c(x_f(t), \tau) = \frac{\partial c}{\partial x}(x_f(\tau), \tau) = 0
\end{equation*}
Vzhledem k této substituci dále pœô ùejde podmínka $C(S,t) \ge \max(S - E,0)$ do tvaru
\begin{equation*}
c \ge \max(1 - e^x, 0)
\end{equation*}
Tvar funkce $f(x)$ má klíœô ­ovı vliv na chování volné hranice. Je-li funkce $f(x)$ definovaná dle (7.20), pak existence tohoto œô ­lenu implikuje existenci volné hranice. Následující obrázek zachycuje prœô¡¯bœô »h této funkce.
\begin{center}
  \begin{pspicture}(0,0)(8.0,7.5)
		\rput(4.0,0.0){Typickı prœô¡¯bœô »h funkce $f(x)$ definované dle (7.20)}
       
		\psline(0.5,4.0)(7.5,4.0)
		\psline(4.0,1.0)(4.0,7.0)

        \pscurve[linewidth=0.5mm](0.5,6.5)(4.0,5.0)(6.5,2.0)

        \rput(7.5,4.2){\small{$x$}}
        \rput(4.5,7.0){\small{$f(x)$}}
        \rput(5.3,4.2){\small{$x_0$}}
	\end{pspicture}
\end{center}
Je zœô ùejmé, œô¡¾e funkce $f(x)$ je kladná pro $x < x_0$ a záporná pro $x \ge x_0$ kde
\begin{equation*}
x_0 = \ln \Bigg(\frac{k}{k -k'} \Bigg) = \ln \Bigg( \frac{r}{D_0} \Bigg) > 0
\end{equation*}
Nyní se zamœô »œô ùme na to, co se stane, nexistují-li œô¡¾ádná omezení a tím pádem ani volná hranice. Uvaœô¡¾ujme poœô ­áteœô ­ní data $c(x, 0)$ pro kladná $x$. Dle definice $c(x, 0)$ je hodnota této funkce nulová. Pro $x > 0$ tak platí $c(x, 0) = \partial c(x, 0)/ \partial x = \partial^2 c(x, 0)/\partial x^2 = 0$. Z (7.19) vyplıvá, œô¡¾e dobœô » splatnosti\footnote{Pœô ùipomeœô ème, œô¡¾e pro $\tau = 0$ je $t = T$.} platí
\begin{equation*}
\frac{\partial c}{\partial \tau} = f(x)
\end{equation*}
Pro $0 < x < x_0$, $f(x) > 0$ a hodnota opce $c$ se po uplynutí infinityzimálního œô ­asového okamœô¡¾iku stane kladnou. Naopak pro $x > x_0$, $f(x) < 0$ se hodnota opce $c$ ihned stane zápornou. Druhı pœô ùípad vœô¡¡ak nesplœô èuje podmínku vyœô¡¾adující $c > 0$ pro vœô¡¡echna $x > 0$. Jestliœô¡¾e bychom opci drœô¡¾eli v bodœô » $x > x_0$, je tato podmínka poruœô¡¡ena a hodnota opce klesne pod její vnitœô ùní hodnotu. To v pœô ùípadœô » americké opce není moœô¡¾né, a proto musí existovat hraniœô ­ní cena.

Z vıœô¡¡e uvedeného argumentu je také zœô ùejmé, od kterého bodu musí hraniœô ­ní cena $x_f(t)$ zaœô ­ínat. Tímto bodem je $x_f(0^{+}) = x_0$, protoœô¡¾e je to jedinı bod, kterı splœô èuje podmínku $c(x_f(0^{+}), 0^{+})$. Ve finanœô ­ním vyjádœô ùení odpovídá tento bod cenœô » podkladového aktiva
\begin{equation*}
S_f(T) = \frac{rE}{D_0}
\end{equation*}
a je nezávislı na $\sigma$. Proto tœô »snœô » pœô ùed splatností by mœô »la bıt americká kupní opce uplatnœô »na pro takové hodnoty pokladového aktiva, kdy $D_0 S > rE$. V dobœô » splatnosti bude opce pochopitelnœô » uplatnœô »na pro $S > E$. Hraniœô ­ní cena $S_f(T)$ je tak v bodœô » $t = T$ nespojitá. Je-li $D_0 = 0$, pak $x_f(0) = \infty$ (a $S_f(T) = \infty$) a proto neexistuje volná hranice. V pœô ùípadœô » neexistence dividendového vınosu je tak vœô¡¾dy optimální drœô¡¾et americkou kupní opci do splatnosti.

Dále je tœô ùeba zdœô¡¯raznit, œô¡¾e $S = rE/D$ je hodnotou $S$, pro kterou platí
\begin{equation*}
\mathcal{L}_{BS}(\max(S - E,0)) = 0
\end{equation*}

\subsubsection{Technická poznámka: Fyzikální interpretace}

Rovnice (7.19) obsahuje v porovnání s obyœô ­ejnou difúzní rovnicí dalœô¡¡í tœô ùi œô ­leny: $(k' - 1) \frac{\partial c}{\partial x}$, $-kc$ a $f(x)$. První z tœô »chto œô ­lenœô¡¯ mœô¡¯œô¡¾e bıt interpretován jako konvekœô ­ní, druhı jako reakœô ­ní a tœô ùetí, funkce $f(x)$, jako spotœô ùební parametr pro $f(x) < 0$ resp. jako doplœô èovací parametr pro $f(x) > 0$. Abychom ilustrovali dopad tœô »chto œô ­lenœô¡¯ na $c(x,t)$, uvaœô¡¾ujme jejich kombinace s ostatními œô ­leny rovnice (7.19).

Nejprve uvaœô¡¾ujme œô ­len $(k' - 1) \frac{\partial c}{\partial x}$. Jak jiœô¡¾ bylo zmínœô »no, tento œô ­len pœô ùedstavuje konvekci, neboli tzv. drift ve finanœô ­ním pojmosloví. To je patrné, vypustíme-li pro okamœô¡¾ik z rovnice (7.19) zbıvající œô ­leny. Vısledkem je hyperbolická rovnice prvního œô ùádu
\begin{equation*}
\frac{\partial c}{\partial \tau} = (k' - 1)\frac{\partial c}{\partial x}
\end{equation*}
Na tuto rovnici lze aplikovat metodu charakteristik s œô ùeœô¡¡ením $c(x, /tau) = F(x + (k' - 1)\tau)$ a obecnou funkcí $F$. ProtFunkce $c(x, \tau)$ je konstantní podél charakteristik $x + (k' - 1)\tau = \mathcal{K}$, kde $\mathcal{K}$ pœô ùedstavuje konstantu, a pœô ùedstavuje tak ``vlnu'', která se pohybuje konstantní rychlostí $1 - k'$. Je zœô ùejmé, œô¡¾e se zmœô »nou reference na $\xi = x + (k' - 1)\tau$ lze œô ­len $(k' - 1) \frac{\partial c}{\partial x}$ vypustit. Rovnice (7.19) se tak zmœô »ní do podoby
\begin{equation*}
\frac{\partial c}{\partial \tau} = \frac{\partial^2 c}{\partial \xi^2} - kc -f(\xi - (k' - 1)\tau)
\end{equation*}

Druhı œô ­len rovnice (7.19) $-kc$ pœô ùedstavuje reakci (diskontování ve finanœô ­ní terminologii), která je proporcionální k $c(x, \tau)$. Jestliœô¡¾e opœô »t zredukujeme rovnici (7.19) na tvar
\begin{equation*}
\frac{\partial c}{\partial \tau} = -kc
\end{equation*}
lze œô ùeœô¡¡ení této rovnice získat pomocí metody separovanıch promœô »nnıch. œô øeœô¡¡ení má tvar $c = c_0 e^{-kt}$. Tento œô ­len lze tedy eliminovat, vyjádœô ùíme-li œô ùeœô¡¡ení ve tvaru $c(x, \tau) = e^{-kr}w(x, \tau)$, œô ­ímœô¡¾ zhodledœô èujeme exponenciální pokles v œô ­ase zpœô¡¯sobenı tímto œô ­lenem. Po této úpravœô » se rovnice dále zjednoduœô¡¡œô¡¡í na tvar
\begin{equation*}
\frac{\partial w}{\partial \tau} = \frac{\partial^2 w}{\partial \xi^2} - e^{kr}f(\xi - (k' - 1)\tau)
\end{equation*}

Koneœô ­nœô » poslední œô ­len $f(x)$, pœô ùedstavuje spotœô ùební parametr pro $f(x) < 0$ resp. doplœô èovací parametr pro $f(x) > 0$. O tom se lze opœô »t pœô ùesvœô »dœô ­it, pokud z rovnice (7.19) vypustíme vœô¡¡echny ostatní œô ­leny.
\begin{equation*}
\frac{\partial c}{\partial \tau} = f(x)
\end{equation*}
Jestliœô¡¾e $f(x) < 0$, pak $\frac{\partial c}{\partial \tau} < 0$ a $c$ je klesající funkcí $\tau$. Naopak, je-li $f(x) > 0$, je $c$ rostoucí funkcí $\tau$.

\subsection{Lokální analıza volné hranice}

Nyní se zamœô »œô ùme na to, jak se volná hranice $x = x_f(\tau)$ chová v okolí bodu $x_f(0) = x_0$. Nalezení explicitního œô ùeœô¡¡ení problému volné hranice není moœô¡¾né, je vœô¡¡ak moœô¡¾né nalézt asymptotické œô ùeœô¡¡ení, které je platné v blízkosti expirace opce, tj. pro $\tau \rightarrow 0$.

Abychom mohli provést tuto analızu, která je lokální v œô ­ase i cenœô » podkladového aktiva, zamœô »œô ùme se rovnici (7.19) v okolí bodu $x = x_0$ a pro $\tau$ blíœô¡¾ící se nule. Funkci $f(x)$ aproximujeme Taylorovou œô ùadou v bodœô » $x_0$\footnote{Pœô ùipomeœô ème, œô¡¾e bod $x_0$ odpovídá koneœô ­né hraniœô ­ní cenœô ».}.
\begin{equation*}
f(x) = f(x_0) + f'(x_0)(x - x_0) + \mathcal{O}((x - x_0)^2) \sim (x - x_0)f'(x_0) = -k(x - x_0)
\end{equation*}
Na pravé stranœô » rovnice (7.19) pak kromœô » $f(x)$ staœô ­í ponechat pouze œô ­len $\frac{\partial^2 c}{\partial x^2}$. Tento œô ­len totiœô¡¾ v oblastech, kde se hodnota funkce $c$ rychle mœô »ní, dominuje nad $c$ a $\frac{\partial c}{\partial x}$, a je tak hlavní ``hybnou'' silou rovnice (7.19). Uvaœô¡¾ované zjednoduœô¡¡ení je lokálním problémem funkce $c$. œô øeœô¡¡ení $\hat{c}(x, \tau)$ tohoto problému splœô èuje rovnici
\begin{equation*}
\frac{\partial \hat{c}}{\partial \tau} = \frac{\partial^2 \hat{c}}{\partial x^2} - k(x - x_0)
\end{equation*}
a hraniœô ­ní podmínku
\begin{equation*}
\hat{c} = \frac{\partial \hat{c}}{\partial x} = 0
\end{equation*}
pro
\begin{equation*}
x = x_f(\tau),~x_f(0) = x_0
\end{equation*}
Pro takto zformulovanı problém lze pomocí metody podobnostního œô ùeœô¡¡ení nalézt explicitní œô ùeœô¡¡ení zaloœô¡¾eného na promœô »nné
\begin{equation*}
\xi = \frac{x - x_0}{\sqrt{\tau}}
\end{equation*}
Toto œô ùeœô¡¡ení má tvar
\begin{equation*}
\hat{c} = \tau^{\frac{3}{2}}c^*(\xi)
\end{equation*}
kde funkce $c^*$ splœô èuje momentálnœô » blíœô¡¾e nespecifikovanou diferenciální rovnici. Souœô ­asnœô » hledáme hraniœô ­ní cenu ve tvaru
\begin{equation*}
x_f(\tau) = x_0 + \xi_0 \sqrt{\tau}
\end{equation*}
Aœô ­koliv hraniœô ­ní cena stále není známa, je nyní tœô ùeba nalézt pouze konstatnu $\xi_0$. Tím se pœô¡¯vodní problém nalezení $x_f(\tau)$ jako obecné funkce promœô »nné $\tau$ znaœô ­nœô » zjednoduœô¡¡il. 

Dosazením vırazu $\hat{c} = \tau^{\frac{3}{2}}c^*(\xi)$ do diferenciální rovnice pro $\hat{c}$ a následnımi úpravami získáváme
\begin{equation*}
\sqrt{\tau}\Bigg( \frac{3}{2}c^* - \frac{1}{2} \xi \frac{d c^*}{d \xi} \Bigg) = \sqrt{\tau} \frac{d^2 c^*}{d \xi^2} - k(x - x_0)
\end{equation*}
Jestliœô¡¾e obœô » strany rovnice vydœô »líme $\sqrt{\tau}$, dostáváme obyœô ­ejnou diferenciální rovnici
\begin{equation}
\frac{d^2 c^*}{d \xi^2} + \frac{1}{2}\xi\frac{d c^*}{d \xi} - \frac{3}{2}c^* = k \xi
\end{equation}
Hraniœô ­ní podmínka
\begin{equation*}
\hat{c} = \frac{\partial \hat{c}}{\partial x} = 0,~~~x = x_f(\tau)
\end{equation*}
se zredukuje do podoby
\begin{equation*}
c^*(\xi_0) = \frac{d c^*}{d \xi}(\xi_0) = 0
\end{equation*}

Dále je tœô ùeba urœô ­it, jak se funkce $\hat{c}(x, \tau)$ chová pro $\xi \rightarrow -\infty$. Z definice $\xi$ vyplıvá, œô¡¾e $\xi \rightarrow -\infty$ odpovídá $x \rightarrow -\infty$. Vzhledem k tomu, œô¡¾e $\frac{\partial^2 \hat{c}}{\partial x^2} \rightarrow 0$ pro $x \rightarrow -\infty$, pœô ùibliœô¡¾nœô » platí
\begin{equation*}
\frac{\partial \hat{c}}{\partial \tau} \sim -k(x - x_0)
\end{equation*}
\begin{equation*}
\frac{\partial \hat{c}}{\partial \tau} \sim -kx
\end{equation*}
 a funkci $\hat{c}(x, \tau)$ tak lze aproximovat vırazem $-kx\tau$. Protoœô¡¾e
\begin{equation*}
\hat{c}(x, \tau) = \tau^{\frac{3}{2}}c^*(x, \tau)
\end{equation*}
také pœô ùibliœô¡¾nœô » platí
\begin{equation*}
c^*(\xi) \sim -k \xi,~\xi \rightarrow -\infty
\end{equation*}
coœô¡¾ mimojiné implikuje $\hat{c} = \tau^{\frac{3}{2}}c^* \sim \tau^{\frac{3}{2}} \frac{x - x_0}{\sqrt{\tau}} \sim x \tau + \mathcal{O}$, kde $\mathcal{O}$ pœô ùedstavuje ostatní zanedbatelné œô ­leny aproximace.

Prvním krokem k vyœô ùeœô¡¡ení problému $c^*(\xi)$ je nalezení obecného œô ùeœô¡¡ení homogenní diferenciální rovnice
\begin{equation*}
\frac{d^2 c^*}{d \xi^2} + \frac{1}{2}\xi\frac{d c^*}{d \xi} - \frac{3}{2}c^* = 0
\end{equation*}
První koœô ùen této rovnice, funkci $c_1^*(\xi)$, lze snadno vypoœô ­íst pomocí metody polynomickıch œô ùeœô¡¡ení jako
\begin{equation*}
c_1^*(\xi) = \xi^3 + 6 \xi
\end{equation*} 
Druhı koœô ùen $c_2^*(\xi)$ je pak moœô¡¾né nalézt pomocí metody redukce œô ùádu a to tak, œô¡¾e nejprve definujeme $c_2^*(\xi)$ jako $c_2^*(\xi) = c_1^*(\xi)a(\xi)$ a následnœô » nalezneme diferenciální rovnici prvního œô ùádu pro $a(\xi)$. Vıpoœô ­et je pœô ùímoœô ­arı avœô¡¡ak pracnı s vısledkem
\begin{equation*}
c_2^*(\xi) = (\xi^2 + 4)e^{-\frac{1}{4}\xi^2} + \frac{1}{2}(\xi^2 + 6 \xi) \int_{-\infty}^{\xi}e^{-\frac{1}{4}s^2}ds
\end{equation*}
Obecné œô ùeœô¡¡ení uvaœô¡¾ované homogenní diferenciální rovnice je tedy
\begin{equation*}
c^*(\xi) = Ac_1^*(\xi) + Bc_2^*(\xi)
\end{equation*}

Druhım krokem v œô ùeœô¡¡ení problému (7.21) a navazujících podmínek je zjiœô¡¡tœô »ní, œô¡¾e $c_p^*(\xi) = - k \xi$ je explicitním œô ùeœô¡¡ením diferenciální rovnice (7.21). Obecné œô ùeœô¡¡ení je tak dáno souœô ­tem $c_p^*$ a obecného œô ùeœô¡¡ení homogenní diferenciální rovnice.
\begin{equation*}
c^*(\xi) = - k \xi + A c_1^*(\xi) + B c_2^*(\xi)
\end{equation*}
Pro $\xi$ limitnœô » se blíœô¡¾ící $-\infty$ platí $c_2^*(\xi) \rightarrow 0$ a $c_1^*(\xi) \rightarrow \infty$. Jednou z podmínek, které se váœô¡¾í k diferenciální rovnici (7.21), je také $c^*(\xi) \sim -k \xi$ pro $\xi \rightarrow -\infty$. Parametr $A$ je tedy roven nule.
\begin{equation}
c^*(\xi) = - k \xi + B c_2^*(\xi)
\end{equation}
Hraniœô ­ní podmínky $c^*(\xi_0) = 0$ a $\frac{d c^*}{d \xi}(\xi_0) = 0$ umoœô¡¾œô èují vıpoœô ­et zbıvajících parametrœô¡¯ $B$ a $\xi_0$. Jejich kombinací s (7.22) získáváme
\begin{equation*}
B c_2^*(\xi) = k \xi 
\end{equation*}
a
\begin{equation*}
B \frac{d c_2^*}{d \xi}(\xi_0) = k
\end{equation*}
Spojením tœô »chto dvou rovnic lze odvodit rovnici
\begin{equation*}
\xi_0 \frac{d c_2^*}{d \xi}(\xi_0) = c_2^*(\xi_0)
\end{equation*}
která po sérii úprav vede k transcedentální rovnici
\begin{equation}
\xi_0^3e^{\frac{1}{4}\xi_0^2} \int_{-\infty}^{\xi_0} e^{-\frac{s^2}{4}}ds = 2(2 - \xi_0^2)
\end{equation}
Konstanta $B$ je pak definována jako $B = \frac{\xi_0}{c_2^*(\xi_0)}$.

Transcedentální rovnice ve tvaru (7.22) jsou charakteristické pro podobnostní œô ùeœô¡¡ení problému volné hraniœô ­ní ceny. Lze dokázat (napœô ù. pomocí grafické metody), œô¡¾e œô ùeœô¡¡ení této rovnice má pouze jeden koœô ùen, kterı mœô¡¯œô¡¾e bıt nalezen pomocí numerickıch metod. Tento koœô ùen je roven
\begin{equation*}
\xi_0 = 0.9034...
\end{equation*}
Tímto jsme tedy nalezli œô ùeœô¡¡ení $\hat{c}(x, \tau)$, které je aproximací problému americké kupní opce pro $\tau$ blíœô¡¾ící se nule a $x$ v okolí $x_0$. Jiœô¡¾ dœô ùíve jsme prokázali, œô¡¾e v dobœô » splatnosti je optimální hraniœô ­ní cena americké kupní opce na podkladové aktivum s dividendovım vınosem $D_0$, rovna $\frac{rE}{D_0}$. Dále z vıœô¡¡e provedené lokální analızy víme, œô¡¾e pro $t \rightarrow T$ platí
\begin{equation*}
S_f(t) \sim \frac{rE}{D_0}\Bigg( 1 + \xi_0 \sqrt{\frac{1}{2}\sigma^2(T - t)} + ... \Bigg)
\end{equation*}
kde $\xi_0$ je univerzální konstanta platná pro vœô¡¡echny americké kupní opce. Kromœô » tohoto zajímavého zjiœô¡¡tœô »ní je lokální analıza dœô¡¯leœô¡¾itá také pro ranná stádia numerickıch vıpoœô ­tœô¡¯ hodnoty americké opce, která jsou charakteristická rychlou zmœô »nou optimální realizaœô ­ní ceny $S_f(t)$. Efekt této zmœô »ny se pak promítne do celého oboru œô ùeœô¡¡ení a nikoliv pouze pro okolí bodu $S = S_f(T)$.
\begin{center}
  \begin{pspicture}(0,0)(8.0,5.5)
		\rput(4.0,0.0){Funkce $c(x, \tau)$ pro œô ­tyœô ùi rozdílné hodnoty $\tau$ vœô ­etnœô » $\tau = 0$}

		\psline(0.5,1.0)(7.5,1.0)
		\psline(4.5,1.0)(4.5,5.0)

        \pscurve(0.5,4.5)(3.0,3.70)(4.5,1.0)
        \pscurve(0.5,4.5)(3.5,3.60)(6.2,1.10)(7.0,1.0)
		\pscurve(0.5,4.5)(3.5,3.65)(6.2,1.27)(7.0,1.0)
		\pscurve(0.5,4.5)(3.5,3.70)(6.2,1.45)(7.1,1.0)

        \rput(4.5,0.8){\small{0}}
        \rput(7.5,0.8){\small{$x$}}
		\rput(5.2,4.8){\small{$c(x, \tau)$}}

	\end{pspicture}
\end{center}
\begin{center}
	\begin{pspicture}(0,0)(8.0,6.5)
		\rput(4.0,0.5){Hodnota opce $C(S,t)$ pro shodné hodnoty $\tau$ jako}
                \rput(4.0,0.0){v pœô ùedchozím obrázku}

		\psline(0.5,1.5)(7.5,1.5)
		\psline(0.5,1.5)(0.5,6.0)

        \psline(3.0,1.5)(7.5,6.0)
        \pscurve(1.5,1.5)(2.5,1.60)(5.0,3.60)(7.3,5.80)
        \pscurve(1.2,1.5)(2.5,1.75)(5.0,3.70)(7.3,5.80)
        \pscurve(1.0,1.5)(2.5,1.90)(5.0,3.80)(7.3,5.80)


        \rput(0.5,1.2){\small{0}}
        \rput(3.0,1.2){\small{$E$}}
        \rput(7.5,1.2){\small{$S$}}
        \rput(1.2,5.8){\small{$C(S,t)$}}

	\end{pspicture}
\end{center}

\part{Numerické metody}

\chapter{Diferenœô ­ní metoda}

Diferenœô ­ní metoda umoœô¡¾œô èuje získat numerické œô ùeœô¡¡ení parciálních diferenœô ­ních rovnic a problému lineární komplementarity. Tato metoda pœô ùedstavuje úœô ­innou a flexibilní techniku, která je schopná generovat pœô ùesná œô ùeœô¡¡ení pro vœô¡¡echny modely odvozené v této knize.

V páté kapitole jsme ukázali, œô¡¾e po zredukování Black-Scholes rovnice na difúzní rovnici je relativnœô » snadné nalézt pœô ùesné œô ùeœô¡¡ení. Difúzní rovnice je totiœô¡¾ v porovnání s pœô¡¯vodní Black-Scholes rovnicí mnohem jednoduœô¡¡œô¡¡í. Proto je také jednoduœô¡¡œô¡¡í nalézt numerické œô ùeœô¡¡ení pro difúzní rovnici a toto œô ùeœô¡¡ení následnœô » pœô ùevést na pœô¡¯vodní finanœô ­ní veliœô ­iny neœô¡¾ œô ùeœô¡¡it pœô ùímo Black-Scholes rovnici. V této kapitole se tak zamœô »œô ùíme na œô ùeœô¡¡ení difúzní rovnice pomocí diferenœô ­ní metody.

Vıœô¡¡e œô ùeœô ­ené vœô¡¡ak neznamená, œô¡¾e by nebylo moœô¡¾né pomocí diferenœô ­ní metody pœô ùímo œô ùeœô¡¡it Black-Scholes rovnici. Existuje mnoho pœô ùíkladœô¡¯, kdy není moœô¡¾né zredukovat problém do tvaru difúzní rovnice s konstatními koeficienty. œô ¬tenáœô ù, kterı pochopí základní principy diferenœô ­ní metody by s její aplikací na Black-Scholes model nemœô »l mít problém.

V páté kapitole jsme ukázali, œô¡¾e vhodnou transformací promœô »nnıch lze zredukovat Black-Scholes rovnici (3.5) pro evropskou opci na difúzní rovnici
\begin{equation*}
\frac{\partial u}{\partial \tau} = \frac{\partial^2 u}{\partial x^2}
\end{equation*}
Vıplatní funkce opce pœô ùedstavuje poœô ­áteœô ­ní podmínku pro $u(x, \tau)$ a hraniœô ­ní podmínky jsou dány podmínkami pro $u(x, \tau)$ v nekoneœô ­nu (tj. pro $x \rightarrow \pm \infty$). V pœô ùípadœô » evropské kupní opce se jedná o rovnice (3.6), (3.7) a (3.8), v pœô ùípadœô » evropské prodejní opce o rovnice (3.9), (3.10) a (3.11). Hodnotu opce $V(S,t)$ lze z bezrozmœô »rné veliœô ­iny $u(x, \tau)$ vyjádœô ùit jako
\begin{equation*}
V = E^{\frac{1}{2}(1 + k)}S^{\frac{1}{2}(1 - k)}e^{\frac{1}{2}(k + 1)^2 \sigma^2(T - t)}u \Big( \ln \frac{S}{E}, \frac{1}{2} \sigma^2 (T - t) \Big)
\end{equation*}

\section{Diferenœô ­ní aproximace}

Nosnou myœô¡¡lenkou diferenœô ­ní metody je nahrazení parciální derivace aproximací zaloœô¡¾ené na Taylorovém rozvoji funkce v okolí bodu popœô ù. bodœô¡¯ aproximace. 

Parciální derivaci $\frac{\partial u}{\partial \tau}$ lze definovat pomocí limitního rozdílu
\begin{equation*}
\frac{\partial u}{\partial \tau}(x, \tau) = \underset{\delta \tau \rightarrow 0}{\lim} \frac{u(x, \tau + \delta \tau) - u(x, \tau)}{\delta \tau}
\end{equation*}
Jestliœô¡¾e namísto $\delta \tau \rightarrow 0$ budeme uvaœô¡¾ovat $\delta \tau$ jako malé (nicménœô » nenulové), získáme aproximaci
\begin{equation*}
\frac{\partial u}{\partial \tau}(x, \tau) \approx \frac{u(x, \tau + \delta \tau) - u(x, \tau)}{\delta \tau} + \mathcal{O}(\delta \tau)
\end{equation*}
Tato aproximace je tzv. diferenœô ­ní aproximací $\frac{\partial u}{\partial \tau}$, protoœô¡¾e zahrnuje malé (ne vœô¡¡ak infinityzimální) diference závislé veliœô ­iny $u$. Vıœô¡¡e uvedenı pœô ùíklad je konkrétnœô » tzv. dopœô ùednou diferenœô ­ní aproximací, protoœô¡¾e posun veliœô ­iny $\tau$ je definován v dopœô ùedném smœô »ru a jsou tak pouœô¡¾ity hodnoty $u$ pro $\tau$ a $\tau + \delta \tau$. Jak naznaœô ­uje œô ­len $\mathcal{O}(\delta \tau)$, je aproximace tím pœô ùesnœô »jœô¡¡í, œô ­ím menœô¡¡í je $\delta \tau$.

Pariciální derivaci $\frac{\partial u}{\partial \tau}$ lze vœô¡¡ak také definovat jako
\begin{equation*}
\frac{\partial u}{\partial \tau} = \underset{\delta \tau \rightarrow 0}{\lim}\frac{u(x, \tau) - u(x, \tau - \delta \tau)}{\delta \tau}
\end{equation*}
Tímto se dostáváme k tzv. zpœô »tné diferenœô ­ní aproximaci, která je definována jako 
\begin{equation*}
\frac{\partial u}{\partial \tau} \approx \frac{u(x, \tau) - u(x, \tau - \delta \tau)}{\delta \tau} + \mathcal{O}(\delta \tau)
\end{equation*}

Vedle dopœô ùedné a zpœô »tné diferenœô ­ní aproximace existuje také tzv. centrální diferenœô ­ní aproximace. Derivaci $\frac{\partial u}{\partial \tau}$ v tomto pœô ùípadœô » definujeme jako
\begin{equation*}
\frac{\partial u}{\partial \tau} = \underset{\delta \tau \rightarrow 0}{\lim}\frac{u(x, \tau + \delta \tau) - u(x, \tau - \delta \tau)}{2 \delta \tau}
\end{equation*}
Pœô ùísluœô¡¡ná aproximace má pak tvar
\begin{equation*}
\frac{\partial u}{\partial \tau} \approx \frac{u(x, \tau + \delta \tau) - u(x, \tau - \delta \tau)}{2 \delta \tau} + \mathcal{O}\Big( (\delta \tau)^2 \Big)
\end{equation*}
\begin{center}
  \begin{pspicture}(0,0)(8.0,8.0)
	\rput(4.0,0.5){Dopœô ùedná, zpœô »tná a centrální diferenœô ­ní aproximace - smœô »rnice}
        \rput(4.0,0.0){úseœô ­ek pœô ùedstavují aproximaci tangenty v bodœô » ($x$, $\tau$)}

	\psline[arrows=->](0.5,2.0)(7.5,2.0)
	\psline[arrows=->](0.5,2.0)(0.5,7.5)

        \pscurve[linewidth=0.5mm](0.5,4.0)(3.5,3.0)(7.0,7.0)
        \psdots[dotstyle=*,dotscale=2](1.5,3.45)
        \psdots[dotstyle=*,dotscale=2](4.0,3.22)
        \psdots[dotstyle=*,dotscale=2](6.5,6.1)
        
        \psline(1.5,3.45)(4.0,3.22)(6.5,6.1)(1.5,3.45)

        \psline[linestyle=dotted](1.5,3.45)(1.5,1.8)
        \psline[linestyle=dotted]](4.0,3.22)(4.0,1.8)
        \psline[linestyle=dotted](6.5,6.1)(6.5,1.8)

        \rput(1.5,1.3){\tiny{}}

	\end{pspicture}
\end{center}


\end{document}
